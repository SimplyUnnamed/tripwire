{"version":3,"sources":["helpers.js","init.js","options.js","layout.js","tripwire.js","global-hooks.js","systemAnalysis.js","guidance.js","thera.js","chain-map-renderer-orgchart.js","chain-map-renderer-radial.js","chain-map.js","active.js","addSignature.js","api.js","automapper.js","comments.js","deleteSignature.js","editSignature.js","esi.js","eve.js","parse.js","paste.js","redo.js","serverStatus.js","sync.js","systemChange.js","tutorials.js","undo.js","activity-graph.js","ckeditor.js","dialogs/admin-dialog.js","dialogs/base-dialog.js","dialogs/options-dialog.js","dialogs/ping-dialog.js","dialogs/signature-delete-dialog.js","dialogs/signature-dialog.js","system-mutators/invasions.js"],"names":["Object","sort","obj","prop","swapped","prev","i","Number","tmp","index","val","cs","key","toLowerCase","find","maxTime","maxTimeString","Date","size","hasOwnProperty","time","dates","push","length","getTime","$","fn","serializeObject","self","this","json","push_counters","patterns","validate","fixed","named","build","base","value","push_counter","undefined","each","serializeArray","test","name","k","keys","match","merge","reverse_key","pop","replace","RegExp","extend","jQuery","numFormat","num","n","toString","split","join","letterToNumbers","string","toUpperCase","letters","sum","Math","pow","indexOf","substr","sigFormat","input","type","alpha","numeric","format","options","chain","typeFormat","classFormat","x","l","isEmpty","positionRelativeTo","elem","ancestor","elemPos","getBoundingClientRect","ancestorPos","left","scrollLeft","top","scrollTop","lookupMultiple","map","propertyName","lookupString","suppress","values","results","v","r","lookupByPropertyMultiple","getCookie","c_name","c_value","document","cookie","c_start","c_end","unescape","substring","setCookie","exdays","exdate","setDate","getDate","escape","toUTCString","location","protocol","originalAddClassMethod","addClass","originalRemoveClassMethod","removeClass","className","result","apply","arguments","trigger","parseHeaders","headers","arr","trim","headerMap","forEach","line","parts","header","shift","viewingSystem","attr","viewingSystemID","server","app_name","version","html","saveTimer","localOverrides","localOptions","JSON","parse","localStorage","getItem","userID","init","character","id","characterID","characterName","background","uiscale","favorites","grid","tracking","active","masks","corporationID","gridlines","tabs","node-reference","zoom","sigNameLocation","routingLimit","routeSecurity","routeIgnore","enabled","systems","renderer","signatures","editType","copySeparator","pasteLife","alignment","sigID","sigType","sigAge","leadsTo","sigLife","sigMass","buttons","follow","chainWidget","viewing","signaturesWidget","autoMapper","saveDelay","delay","clearTimeout","setTimeout","save","stringify","window","get","setItem","ajax","url","data","mode","dataType","load","set","local","constructor","reset","defaults","oog","data-col","col","data-row","row","data-sizex","size_x","data-sizey","size_y","css","width","height","favorite","parseInt","home","kspace","evescout","inArray","a","href","hostname","pathname","search","filter","$tab","clone","systemID","append","redraw","gridster","widget_selector","avoid_overlapped_widgets","widget_base_dimensions","widget_margins","autogrow_cols","helper","draggable","start","e","ui","resize","handle_class","max_size","min_size","stop","$widget","serialize_params","$w","wgd","disable","disable_resize","visibility","click","hasClass","serialize","enable","enable_resize","tripwire","timer","xhr","client","wormholes","list","undo","sessionStorage","redo","serverSignatureCount","activity","esi","refreshRate","connected","ageFormat","instance","sync","setAgeFormat","countdown","serverTime","chainMap","draw","pastEOL","since","layout","whTooltip","sig","item","tooltip","sig2Type","whType","life","mass","jump","ageTooltip","date","lifeTime","getMonth","getHours","getMinutes","createdByName","modifiedTime","modifiedByName","refresh","successCallback","alwaysCallback","on","preventDefault","system","systemChange","parseFloat","originalEvent","wheelDelta","fadeIn","timeout","keydown","activeElement","is","metaKey","ctrlKey","keyCode","getSelection","output","signature","signatureID","wormhole","initialID","secondaryID","otherSignature","aSigSystems","lifeLength","lifeLeft","text","focus","select","Notify","splice","toggle","EVE","systemName","show","hide","characters","removeAttr","remove","isArray","delete","esiDelete","display","stopPropagation","content","color","stick","jBox","offset","y","animation","autoClose","ValidationTooltips","fade","Tooltips","attach","getContent","position","outside","SystemActivityToolTips","appendTo","reposition","repositionOnOpen","createOnInit","onOpen","targetPos","target","getElementById","tooltipWidth","source","closest","container","parent","offsetHeight","WormholeRouteToolTips","WormholeTypeToolTips","adjustDistance","responsiveWidth","OccupiedToolTips","pointer","minWidth","repositionOnContent","offsetWidth","setContent","cache","done","occupants","chars","b","shipTypeName","linkSig","sigName","sortable","items","axis","tolerance","containment","update","newTabs","setActiveTab","dialog","Remove Tab","Cancel","resizable","minHeight","dialogClass","OK","submit","open","close","create","inlinecomplete","maxSize","thera","checked","eq","contextmenu","delegate","menu","event","my","at","of","children","colName","cmd","beforeOpen","effect","duration","nodeElem","showInfo","setDestination","collapsed","collapse","existingTabIndex","newTab","wormholeID","class","existingTab","autoOpen","Close","payload","totalMass","toID","shipType","moogle","prototype","setFlare","flare","flares","removeFlare","widget","autocomplete","_create","element","_selectInit","_super","_value","originalReturn","_superApply","change","_suggest","_initSource","request","response","matcher","escapeRegex","term","Array","_close","input_source","addToSelect","select_added_value","select_source","unshift","removeFromSelect","wrapper","toArray","_createShowAllButton","that","wasOpen","button","icons","primary","_search","tablesorter","sortReset","widgets","textExtraction","2","node","toggleClass","shiftKey","nextUntil","addBack","add","Ok","easing","systemAnalysis","mutators","addMutator","m","analyse","assign","baseSecurity","security","pathSymbol","systemTypeModifiers","mutate","systemTypeClass","factionID","systemTypeName","guidance","extractKeys","call","sorter","adjustCostForOptions","mapCost","findPaths","end","infinity","Infinity","costs","0","predecessors","addToOpen","cost","vertex","bucket","currentCost","adjacentNodes","totalCost","vertexCost","extractShortest","nodes","u","predecessor","reverse","findShortestPath","shortest","path","concat","slice","Guidance","_TheraConnection","_this","links","nodeNameSuffix","findLinks","ids","ti","theraLink","theraID","nodeDefaults","wormholeEol","wormholeMass","solarSystemId","parentID","wormholeDestinationSignatureId","sourceWormholeType","child","nextChildID","wormholeDestinationSolarSystemId","signatureId","destinationWormholeType","encodeURIComponent","status","contents","_","isEqual","console","info","fail","error","warn","setInterval","ChainMapRendererOrgchart","owner","google","visualization","OrgChart","allowHtml","allowCollapse","nodeClass","events","addListener","collapseHandler","DataView","DataTable","cols","label","ready","drawing","switchTo","style","charts","setOnLoadCallback","switchFrom","lines","newView","s","nodeId","nodeVal","updateLines","drawNodeLine","addModes","jquerySelector","prefixes","doModeClasses","c","removeModes","classFunc","prefix","$node","nodeIndex","ceil","cellIndex","$connector","$parent","nodeCol","connectorCell","colSpan","parentIndex","newparentIndex","checkSystem","rows","$connecte","me","tempCol","breaker","skip","lastLineData","getCollapsedNodes","collapsedSystems","updateCollapsed","ChainMapRendererRadial","newDiv","createElement","appendChild","div","parentNode","removeChild","mapData","drawInner","CIRCLE_SIZE","first_ring_delta","ringX","ci","ringY","maps","nodesById","ri","inNode","mapNode","minArc","newMap","circles","arc","circle","connection","markup","f","mi","ni","mapDiv","innerHTML","innerContainer","firstChild","bounds","makeDivsForRing","PI","domNode","finalPositions","w","h","cx","cy","parentWidth","parentHeight","outerContainer","canvas","getElementsByTagName","ctx","getContext","scale","translate","maxCi","beginPath","ellipse","lineWidth","setLineDash","strokeStyle","propertyFromCssClass","stroke","reduce","moveTo","cp1","radToCartesian","radPosition","theta","cp2","bezierCurveTo","lineTo","dashed","minRad","maxRad","parentCollapsed","skipped","rads_per_arc","acc","rad_offset","alignment_delta","frag","createRange","createContextualFragment","dblclick","dr","rad_centre","excess","nextBounds","rad","sin","cos","property","cssText","body","getComputedStyle","getPropertyValue","view","thirdPartySuppliers","renderers","orgChart","radial","useRenderer","elements","querySelectorAll","getAttribute","shipJumps","podKills","shipKills","npcKills","getElementsByClassName","jumps","setAttribute","pods","ships","npcs","attachedElements","detach","occupied","count","next","max","frigTypes","connections","topLevel","tab","makeSystemNode","whId","inSigId","nodeTypeMarkup","additionalClasses","systemType","leadsToPointer","nodeSecurity","nodeFaction","getSystemType","effectClass","systemNameText","chainNode","statics","shortCodeMap","High-Sec","Low-Sec","Null-Sec","Triglavian","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","classMap","H","L","N","▼","formatStatics","makeCalcChildNode","childID","targetSystem","calcNode","calculated","nth","chainList","connectedTo","addCalcChildNodes","chainLinks","regionID","chainData","usedLinks","sig1","sig2","sig1Type","parentType","childType","floor","random","typeBM","classBM","sigIndex","supplier","supplierNodes","supplierNode","thirdParty","systemsInChainMap","sigText","renderPath","modifiers","parentModifiers","chainModifiers","cm","systemMarkup","newIndex","rawMap","drawRetryTimer","expires","universeJumps","getResponseHeader","system_id","ship_jumps","then","universeKills","pod_kills","ship_kills","npc_kills","editSigs","editComments","editSig","editComment","animate","backgroundColor","fadeOut","addSig","option","disabled","wh","tr","until","moment","utc","toDate","onExpiry","alwaysExpire","compact","serverSync","wrapInner","slideDown","$set","replaceWith","API","indicator","APIrefresh","expire","periodsToSeconds","onTick","t","from","to","stationID","shipTypeID","initial","secondary","toClass","title","signature2","resultSet","empty","action","comments","modified","$comment","comment","err","message","sticky","commentID","before","created","deleteSig","slideUp","edit","locationTimer","shipTimer","onlineTimer","baseUrl","userAgent","navigator","oauth","subject","accessToken","isExpired","tokenExpire","subtract","isBefore","expired","param","token","user_agent","jqXHR","locationDate","solar_system_id","stationName","shipID","shipName","station_id","stationLookup","always","reference","ship","shipDate","ship_item_id","ship_name","ship_type_id","typeLookup","online","characterStatus","typeID","destinationID","clear_waypoints","beginning","destination_id","clear_other_waypoints","add_to_beginning","Authorization","X-User-Agent","targetID","target_id","eveStatus","idLookup","eveIDs","contentType","processData","characterLookup","eveID","async","corporationLookup","allianceLookup","searchString","categories","strict","fullLookup","promise","Deferred","category","characterData","corporation_id","corporationData","corporation","alliance_id","allianceData","alliance","resolve","parseOauth","_data","$clone","characterChange","updateSignatureTable","mask","column","editing","sigEditing","signatureCount","pasteSignatures","processing","rowParse","scanner","columns","validScanGroups","validTypes","Combat Site","Data Site","Gas Site","Ore Site","Relic Site","Wormhole","Site de combat","Site de données","Site de collecte de gaz","Site de minerai","Site de reliques","Trou de ver","Kampfgebiet","Datengebiet","Gasgebiet","Mineraliengebiet","Reliktgebiet","Wurmloch","戦闘サイト","データサイト","ガスサイト","鉱石サイト","遺物サイト","ワームホール","전투 사이트","데이터 사이트","가스 사이트","채광 사이트","유물 사이트","웜홀","Боевой район","Информационный район","Газовый район","Астероидный район","Археологический район","Червоточина","scanGroup","parsePaste","paste","pasteIDs","removes","scan","clipboardData","getData","blur","lastIndex","redoItem","serverStatus","players","times","log","signatureTime","flareCount","flareTime","last_modified","commentCount","commentTime","appData","aSystems","wormholeInitialIDs","wormholeSecondaryIDs","notify","discord_integration","history","replaceState","effects","bad","whClass","modifier","abs","securityText","HS","LS","NS","Trig","fi","toFixed","factions","regions","tutorial","introJs","setOptions","showStepNumbers","steps","querySelector","intro","exitOnEsc","exitOnOverlayClick","skipLabel","onchange","_currentStep","previousMask","stepFunc","_options","setOption","exiting","exit","goToStep","off","onexit","undoItem","graph","span","role","calc","d","getValue","sourceColumn","setColumns","selectHandler","selections","AreaChart","isStacked","hAxis","textStyle","fontName","fontSize","showTextEvery","vAxis","viewWindowMode","viewWindow","min","maxValue","gridlineColor","pointSize","chartArea","legend","showColorCode","annotations","domain","focusTarget","CKConfig","skin","allowedContent","extraPlugins","enterMode","CKEDITOR","ENTER_BR","removeDialogTabs","autoGrow_onStartup","autoGrow_minHeight","toolbar_minToolbar","toolbar_maxToolbar","toolbar","smallToolbar","maximizedToolbar","fontSize_style","styles","font-size","overrides","attributes","cke","editor","domEvent","altKey","selected_ranges","getRanges","startContainer","parents","getParents","getFirst","getNext","selectElement","selectRanges","ev","definition","getContents","removeAllRanges","$this","instances","modifiedDate","createdDate","destroy","Delete","refreshTimer","$total","$ajax","refreshWindow","abort","$row","$col","modal","$menuItem","sortList","parentElement","Save","maskChange","slider","Reset","stats","system_visits","account","logins","lastLogin","username","admin","img","optional","accordion","heightStyle","collapsible","step","slide","direction","Add","Remove","send","Create","selectmenu","total","Send","systemText","alert","fromSignature","openSignatureDialog","sigDialogVM","sigId","aSigWormholes","durationPicker","not","form","valid","signatureID_Alpha","signatureID_Numeric","currentSignature","findIndex","signatureType","wormholeName","signatureLength","wormholeType","signatureID2_Alpha","signatureID2_Numeric","wormholeName2","wormholeType2","wormholeLife","signatureName","sigAlpha","invasions","_Invasions","pathSymbolMap","stellar_reconnaissance","triglavian_minor_victory","escalating_liminality","final_liminality","edencom_minor_victory","redoubt","bulwark","fortress","textMap","systemInvasion","derived_security_status","tip","keyBy"],"mappings":"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","file":"app.min.js","sourcesContent":["Object.sort = function(obj, prop) {\n\tvar swapped, prev;\n\tdo {\n\t\tswapped = false, prev = null;\n\t\tfor (var i in obj) {\n\t\t\tif (prev && Number(obj[i][prop]) < Number(obj[prev][prop])) {\n\t\t\t\tvar tmp = obj[i];\n\t\t\t\tobj[i] = obj[prev];\n\t\t\t\tobj[prev] = tmp;\n\t\t\t\tswapped = true;\n\t\t\t}\n\t\t\tprev = i;\n\t\t}\n\t} while (swapped);\n}\n\nObject.index = function(obj, prop, val, cs) {\n\tfor (var key in obj) {\n\t\tif (!cs && obj[key][prop] == val) {\n\t\t\treturn key;\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\n\t\t\treturn key;\n\t\t}\n\t}\n}\n\nObject.find = function(obj, prop, val, cs) {\n\tfor (var key in obj) {\n\t\tif (!cs && obj[key][prop] == val) {\n\t\t\treturn obj[key];\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\n\t\t\treturn obj[key];\n\t\t}\n\t}\n\n\treturn false;\n}\n\nObject.maxTime = function(obj, prop) {\n\tvar maxTimeString = \"\", maxTime;\n\n\tfor (var key in obj) {\n\t\tif (!maxTime || maxTime < new Date(obj[key][prop])) {\n\t\t\tmaxTime = new Date(obj[key][prop]);\n\t\t\tmaxTimeString = obj[key][prop];\n\t\t}\n\t}\n\treturn maxTimeString;\n}\n\nObject.size = function(obj) {\n    var size = 0, key;\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n\n    return size;\n};\n\nObject.time = function(obj) {\n\tvar dates = [], key;\n\tfor (key in obj) {\n\t\tdates.push(new Date(obj[key].time));\n\t}\n\n\treturn dates.length ? dates.sort()[dates.length -1].getTime() /1000 : 0;\n};\n\n(function($){\n    $.fn.serializeObject = function(){\n\n        var self = this,\n            json = {},\n            push_counters = {},\n            patterns = {\n                \"validate\": /^[a-zA-Z][a-zA-Z0-9_]*(?:\\[(?:\\d*|[a-zA-Z0-9_]+)\\])*$/,\n                \"key\":      /[a-zA-Z0-9_]+|(?=\\[\\])/g,\n                \"push\":     /^$/,\n                \"fixed\":    /^\\d+$/,\n                \"named\":    /^[a-zA-Z0-9_]+$/\n            };\n\n\n        this.build = function(base, key, value){\n            base[key] = value;\n            return base;\n        };\n\n        this.push_counter = function(key){\n            if(push_counters[key] === undefined){\n                push_counters[key] = 0;\n            }\n            return push_counters[key]++;\n        };\n\n        $.each($(this).serializeArray(), function(){\n\n            // skip invalid keys\n            if(!patterns.validate.test(this.name)){\n                return;\n            }\n\n            var k,\n                keys = this.name.match(patterns.key),\n                merge = this.value,\n                reverse_key = this.name;\n\n            while((k = keys.pop()) !== undefined){\n\n                // adjust reverse_key\n                reverse_key = reverse_key.replace(new RegExp(\"\\\\[\" + k + \"\\\\]$\"), '');\n\n                // push\n                if(k.match(patterns.push)){\n                    merge = self.build([], self.push_counter(reverse_key), merge);\n                }\n\n                // fixed\n                else if(k.match(patterns.fixed)){\n                    merge = self.build([], k, merge);\n                }\n\n                // named\n                else if(k.match(patterns.named)){\n                    merge = self.build({}, k, merge);\n                }\n            }\n\n            json = $.extend(true, json, merge);\n        });\n\n        return json;\n    };\n})(jQuery);\n\nvar numFormat = function(num) {\n\t//Seperates the components of the number\n\tvar n = num.toString().split(\".\");\n\t//Comma-fies the first part\n\tn[0] = n[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\t//Combines the two sections\n\treturn n.join(\".\");\n};\n\nvar letterToNumbers = function(string) {\n    string = string.toUpperCase();\n    var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', sum = 0, i;\n    for (i = 0; i < string.length; i++) {\n        sum += Math.pow(letters.length, i) * (letters.indexOf(string.substr(((i + 1) * -1), 1)) + 1);\n    }\n    return sum;\n};\n\nvar sigFormat = function(input, type) {\n\tif (!input) return \"\";\n\n\tvar alpha = /^[a-zA-Z]+$/;\n\tvar numeric = /^[0-9]+$/;\n\tvar format = type == \"type\" ? options.chain.typeFormat || \"\" : options.chain.classFormat || \"\";\n\n\tfor (var x = 0, l = format.length; x < l; x++) {\n\t\tif (format[x].match(alpha)) {\n\t\t\tif (format[x].toUpperCase() == \"B\" && input == \"a\") {\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\tif (format[x] == format[x].toUpperCase()) {\n\t\t\t\t\tformat = format.substr(0, x) + input.toUpperCase() + format.substr(x + 1, l);\n\t\t\t\t} else {\n\t\t\t\t\tformat = format.substr(0, x) + input + format.substr(x + 1, l);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (format[x].match(numeric)) {\n\t\t\tif (format[x] == 2 && input == \"a\") {\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\tformat = format.substr(0, x) + letterToNumbers(input) + format.substr(x +1, l);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn format;\n};\n\nvar isEmpty = function(obj) {\n    for(var key in obj) {\n        if(obj.hasOwnProperty(key))\n            return false;\n    }\n    return true;\n};\n\n/** Find the relative position of one element within the hierarchy tree of another */\nfunction positionRelativeTo(elem, ancestor) {\n\tconst elemPos = elem.getBoundingClientRect(),\n\t\tancestorPos = ancestor.getBoundingClientRect();\n\treturn { \n\t\tleft: elemPos.left - ancestorPos.left + ancestor.scrollLeft,\n\t\ttop: elemPos.top - ancestorPos.top + ancestor.scrollTop\n\t};\n}\n\n/** Look up one or more values in a comma separated string as keys in a data map, and return a property from the results in a new comma separated string.\nConvenience function for UI mapping.\nWill throw a failure message, unless suppress=true in which case it will return undefined, if \nany of the lookups fail to resolve. */\nfunction lookupMultiple(map, propertyName, lookupString, suppress) {\n\tconst values = lookupString.split(',');\n\tconst results = [];\n\tfor(var i = 0; i < values.length; i++) {\n\t\tconst v = values[i];\n\t\tconst r = map[v];\n\t\tif(!r) { \n\t\t\tif(suppress) { return undefined;}\n\t\t\telse { throw 'Value ' + v + ' did not match anything in ' + map; }\n\t\t}\n\t\tresults.push(r[propertyName]);\n\t}\n\treturn results.join(',');\n}\n\n/** Look up one or more values in a comma separated string as property values in a data map, and return the key from the results in a new comma separated string.\nConvenience function for UI mapping.\nWill throw a failure message, unless suppress=true in which case it will return undefined, if \nany of the lookups fail to resolve. */\nfunction lookupByPropertyMultiple(map, propertyName, lookupString, suppress) {\n\tconst values = lookupString.split(',');\n\tconst results = [];\n\tfor(var i = 0; i < values.length; i++) {\n\t\tconst v = values[i];\n\t\tconst r = Object.index(map, propertyName, v);\n\t\tif(!r) { \n\t\t\tif(suppress) { return undefined;}\n\t\t\telse { throw 'Value ' + v + ' did not match anything by property ' + propertyName + ' in ' + map; }\n\t\t}\n\t\tresults.push(r);\n\t}\n\treturn results.join(',');\n}\n\nvar getCookie = function(c_name) {\n\tvar c_value = document.cookie;\n\n\tvar c_start = c_value.indexOf(\" \" + c_name + \"=\");\n\tif (c_start == -1) {\n\t\tc_start = c_value.indexOf(c_name + \"=\");\n\t}\n\n\tif (c_start == -1) {\n\t\tc_value = null;\n\t} else {\n\t\tc_start = c_value.indexOf(\"=\", c_start) + 1;\n\t\tvar c_end = c_value.indexOf(\";\", c_start);\n\n\t\tif (c_end == -1) {\n\t\t\tc_end = c_value.length;\n\t\t}\n\n\t\tc_value = unescape(c_value.substring(c_start, c_end));\n\t}\n\n\treturn c_value;\n};\n\nvar setCookie = function(c_name, value, exdays) {\n\tvar exdate = new Date();\n\texdate.setDate(exdate.getDate() + exdays);\n\tvar c_value = escape(value) + ((exdays == null) ? \"\" : \"; expires=\"+exdate.toUTCString());\n\n\tdocument.cookie = c_name + \"=\" + c_value + \";\" + (document.location.protocol == \"https:\" ? \"secure;\" : \"\");\n};\n\n// Global CSS class change event\n(function($) {\n    var originalAddClassMethod = $.fn.addClass;\n\tvar originalRemoveClassMethod = $.fn.removeClass;\n\n    $.fn.addClass = function(className) {\n        // Execute the original method.\n        var result = originalAddClassMethod.apply(this, arguments);\n\n        // trigger a custom event\n        this.trigger('classchange', className);\n\n        // return the original result\n        return result;\n    }\n\n\t$.fn.removeClass = function(className) {\n        // Execute the original method.\n        var result = originalRemoveClassMethod.apply(this, arguments);\n\n        // trigger a custom event\n        this.trigger('classchange', className);\n\n        // return the original result\n        return result;\n    }\n})(jQuery);\n\nvar parseHeaders = function(headers) {\n\t\t// Convert the header string into an array\n\t\t// of individual headers\n\t\tvar arr = headers.trim().split(/[\\r\\n]+/);\n\n\t\t// Create a map of header names to values\n\t\tvar headerMap = {};\n\t\tarr.forEach(function (line) {\n\t\t\t\tvar parts = line.split(': ');\n\t\t\t\tvar header = parts.shift();\n\t\t\t\tvar value = parts.join(': ');\n\t\t\t\theaderMap[header] = value;\n\t\t});\n\t\treturn headerMap;\n}\n","var viewingSystem = $(\"meta[name=system]\").attr(\"content\");\nvar viewingSystemID = $(\"meta[name=systemID]\").attr(\"content\");\nvar server = $(\"meta[name=server]\").attr(\"content\");\nvar app_name = $(\"meta[name=app_name]\").attr(\"content\");\nvar version = $(\"meta[name=version]\").attr(\"content\");\n\n// Page cache indicator\nif (getCookie(\"loadedFromBrowserCache\") == \"true\") {\n\t$(\"#pageTime\").html(\"Page is Cached\");\n}\n\n// setCookie('loadedFromBrowserCache', true);\n\n// Use this to test performance of javascript code lines\n// var startTime = window.performance.now();\n// console.log(\"stint: \"+ (window.performance.now() - startTime));\n","var options = new function() {\n\tvar localOverrides = [\"grid\"];\n\tvar localOptions = JSON.parse(localStorage.getItem(\"tripwire_options\"));\n\tvar saveTimer;\n\n\tthis.userID = init.userID;\n\tthis.character = {id: init.characterID, name: init.characterName};\n\tthis.background = null;\n\tthis.uiscale = 1.0;\n\tthis.favorites = [];\n\tthis.grid = {};\n\tthis.tracking = {active: \"new\"};\n\tthis.masks = {active: init.corporationID + \".2\"};\n\tthis.chain = {typeFormat: null, classFormat: null, gridlines: true, active: 0, tabs: [], \"node-reference\": \"type\", zoom: 1.0, sigNameLocation: 'name', routingLimit: 15, routeSecurity: 'shortest', routeIgnore: { enabled: false, systems: [ 'Tama', 'Rancer' ] }, renderer: 'orgChart' };\n\tthis.signatures = {editType: \"unknown\", copySeparator: \",\", pasteLife: 72, alignment: {sigID: \"centerAlign\", sigType: \"centerAlign\", sigAge: \"centerAlign\", leadsTo: \"centerAlign\", sigLife: \"centerAlign\", sigMass: \"centerAlign\"}};\n\tthis.buttons = {follow: false, chainWidget: {viewing: false, favorites: false}, signaturesWidget: {autoMapper: false}};\n\n\tthis.saveDelay = function(delay) {\n\t\tif (saveTimer) clearTimeout(saveTimer);\n\n\t\tsaveTimer = setTimeout(\"options.save()\", delay);\n\t};\n\n\t// Saves options in both cookie and database\n\tthis.save = function() {\n\t\tvar options = JSON.stringify(window.options.get());\n\n\t\tlocalStorage.setItem(\"tripwire_options\", options);\n\n\t\treturn $.ajax({\n\t\t\turl: \"options.php\",\n\t\t\tdata: {mode: \"set\", options: options},\n\t\t\ttype: \"POST\",\n\t\t\tdataType: \"JSON\"\n\t\t});\n\t};\n\n\t// Loads options via passed object else cookie\n\tthis.load = function(data) {\n\t\tif (data && typeof(data) != \"undefined\") {\n\t\t\tthis.set(this, data);\n\t\t} else if (localOptions) {\n\t\t\tthis.set(this, localOptions);\n\t\t}\n\n\t\tthis.apply();\n\t};\n\n\t// Gets options from this by exluding types == function\n\tthis.get = function() {\n\t\tvar data = {};\n\n\t\tfor (var x in this) {\n\t\t\tif (typeof(this[x]) != \"function\") {\n\t\t\t\tdata[x] = this[x];\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t};\n\n\t// Sets this from passed object\n\tthis.set = function(local, data) {\n\t\tfor (var prop in data) {\n\t\t\tif (data[prop] && data[prop].constructor && data[prop].constructor === Object) {\n\t\t\t\tif (local) {\n\t\t\t\t\tthis.set(local[prop], data[prop]);\n\t\t\t\t}\n\t\t\t} else if (local && typeof(local[prop]) != \"undefined\") {\n\t\t\t\tlocal[prop] = data[prop];\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.reset = function() {\n\t\tfor (var x in this) {\n\t\t\tif (typeof(this[x]) != \"function\") {\n\t\t\t\tthis[x] = JSON.parse(JSON.stringify(this.reset.defaults[x]));\n\t\t\t}\n\t\t}\n\t};\n\n\t// Applies settings\n\tthis.apply = function() {\n\t\t// Local browser overrides\n\t\tif (localOptions) {\n            for (key in localOverrides) {\n                this[localOverrides[key]] = localOptions[localOverrides[key]];\n\t\t\t}\n\t\t}\n\n\t\t// Grid layout (detect old IGB setting options)\n\t\tif (this.grid.hasOwnProperty(\"oog\") && !isEmpty(this.grid.oog)) {\n\t\t\t$.each(this.grid.oog, function() {\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\n\t\t\t\t\t.css({width: this.width, height: this.height});\n\t\t\t});\n\t\t} else if (!isEmpty(this.grid)) {\n\t\t\t$.each(this.grid, function() {\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\n\t\t\t\t\t.css({width: this.width, height: this.height});\n\t\t\t});\n\t\t}\n\n\t\t// Make sure favorites are all ints and not strings\n\t\tthis.favorites = $.map(this.favorites, function(favorite) {\n\t\t\treturn parseInt(favorite);\n\t\t});\n\n\t\t// Buttons\n\t\tif (this.buttons.follow) $(\"#follow\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.home) $(\"#home\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.kspace) $(\"#k-space\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.viewing) $(\"#show-viewing\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.favorites) $(\"#show-favorite\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.evescout) $(\"#eve-scout\").addClass(\"active\");\n\t\tif ($.inArray(parseInt(viewingSystemID), this.favorites) !== -1) $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\");\n\t\tif (this.buttons.signaturesWidget.autoMapper) $(\"#toggle-automapper\").addClass(\"active\");\n\n\t\t// UI Scale\n\t\tif (this.uiscale) {\n\t\t\t$(\"body\").css(\"zoom\", this.uiscale);\n\t\t}\n\n\t\t// Chain zoom\n\t\tif (this.chain.zoom) {\n\t\t\t$(\"#chainParent\").css(\"zoom\", this.chain.zoom);\n\t\t}\n\n\t\t// Background\n\t\tif (this.background) {\n\t\t\tvar a = $('<a>', { href:this.background } )[0];\n\t\t\t$(\"#wrapper\").attr(\"style\", \"background-image: url(https://\" + a.hostname + a.pathname + a.search + \");\");\n\t\t} else {\n\t\t\t$(\"#wrapper\").attr(\"style\", \"\");\n\t\t}\n\n\t\t// Characters in Options\n\t\t$(\"#dialog-options #characters\").html(\"<img src='https://image.eveonline.com/Character/\"+init.characterID+\"_64.jpg' />\");\n\n\t\t// Active mask\n\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+this.masks.active+\"']\").attr(\"checked\", true);\n\n\t\t// Chain tabs\n\t\t$(\"#chainTabs\").html(\"\");\n\t\tfor (var x in this.chain.tabs) {\n\t\t\tif (this.chain.tabs[x]) {\n\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\n\n\t\t\t\t$tab.attr(\"id\", x).find(\".name\").data(\"tab\", this.chain.tabs[x].systemID).html(this.chain.tabs[x].name);\n\t\t\t\tif (x == this.chain.active) { $tab.addClass(\"current\"); }\n\n\t\t\t\t$(\"#chainTabs\").append($tab);\n\t\t\t}\n\t\t}\n\n\t\t// Draw chain if Tripwire is initialized\n\t\tif (typeof(tripwire) !== \"undefined\") {\n\t\t\tchain.redraw();\n\t\t}\n\t};\n\n\tthis.reset.defaults = JSON.parse(JSON.stringify(this.get()));\n\tthis.load(init && init.options ? init.options : null);\n}\n","var grid = $(\".gridster ul\").gridster({\n\twidget_selector: \"li.gridWidget\",\n\tavoid_overlapped_widgets: false,\n\twidget_base_dimensions: [50, 50],\n\twidget_margins: [5, 5],\n\tautogrow_cols: true,\n\thelper: \"clone\",\n\tdraggable: {\n\t\tstart: function(e, ui) {\n\t\t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\n\t\t}\n\t},\n\tresize: {\n    \tenabled: true,\n    \thandle_class: \"grid-resize\",\n    \tmax_size: [30, 30],\n    \tmin_size: [4, 4],\n    \tstart: function(e) {\n    \t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\n    \t},\n    \tstop: function(e, ui, $widget) {\n    \t\t//var width = parseInt($(\".gridster\").css(\"margin-left\")) + this.container_width;\n    \t\t//$(\"#wrapper\").css({width: width + \"px\"})\n    \t\tswitch ($widget.attr(\"id\")) {\n    \t\t\tcase \"infoWidget\":\n    \t\t\t\tsetTimeout(\"activity.redraw();\", 300);\n    \t\t\t\tbreak;\n    \t\t}\n    \t}\n\t},\n\tserialize_params: function($w, wgd) {\n\t\treturn {\n\t\t\tid: $w.attr(\"id\"),\n\t\t\tcol: wgd.col,\n\t\t\trow: wgd.row,\n\t\t\tsize_x: wgd.size_x,\n\t\t\tsize_y: wgd.size_y,\n\t\t\twidth: $w.width(),\n\t\t\theight: $w.height()\n\t\t}\n\t}\n}).data(\"gridster\").disable();\n\ngrid.disable_resize();\n$(\".grid-resize\").addClass(\"hidden\").attr(\"data-icon\", \"resize\");\n\n$(\".gridster\").css({visibility: \"visible\"});\n$(\".gridster > *\").addClass(\"gridster-transition\");\n\n$(\"#layout\").click(function() {\n\tif (!$(this).hasClass(\"active\")) {\n\t\tgrid.enable();\n\t\tgrid.enable_resize();\n\t\t$(\".grid-resize\").removeClass(\"hidden\");\n\n\t\t$(this).addClass(\"active\");\n\t} else {\n\t\tgrid.disable();\n\t\tgrid.disable_resize();\n\t\t$(\".grid-resize\").addClass(\"hidden\");\n\n\t\t$(this).removeClass(\"active\");\n\n\t\toptions.grid = grid.serialize();\n\n\t\toptions.save();\n\t}\n});\n","var tripwire = new function() {\n    this.timer, this.xhr;\n\tthis.version = version;\n\tthis.client = {signatures: {}, wormholes: {}};\n\tthis.server = {signatures: {}, wormholes: {}};\n\tthis.signatures = {list: {}, undo: JSON.parse(sessionStorage.getItem(\"tripwire_undo\")) || {}, redo: JSON.parse(sessionStorage.getItem(\"tripwire_redo\")) || {}};\n\tthis.serverSignatureCount = 0;\n\tthis.activity = {};\n\tthis.data = {tracking: {}, esi: {}};\n\tthis.refreshRate = 5000;\n\tthis.connected = true;\n\tthis.ageFormat = \"HM\";\n\tthis.instance = window.name ? window.name : (new Date().getTime() / 1000, window.name = new Date().getTime() / 1000);\n\n    // Command to start/stop tripwire updates\n\t// ToDo: Include API and Server timers\n\tthis.stop = function() {\n\t\tclearTimeout(this.timer);\n\t\treturn this.timer;\n\t};\n\n\tthis.start = function() {\n\t\treturn this.sync();\n\t}\n\n    // Command to change Age format\n\t// ToDo: Cookie change to keep\n\tthis.setAgeFormat = function(format) {\n\t\tvar format = typeof(format) !== 'undefined' ? format : this.ageFormat;\n\n\t\t$(\"span[data-age]\").each(function() {\n\t\t\t$(this).countdown(\"option\", {format: format});\n\t\t});\n\n\t\treturn true;\n\t}\n\n    this.serverTime = function() {\n\t\tthis.time;\n\n\t\tthis.serverTime.getTime = function() {\n\t\t\treturn tripwire.serverTime.time;\n\t\t}\n\t}\n    this.serverTime();\n\n    // Handles putting chain together\n\tthis.chainMap = function() {\n\t\tthis.chainMap.parse = function(data) {\n\t\t\tchain.draw(data);\n\t\t}\n\t}\n    this.chainMap();\n\n    this.pastEOL = function() {\n\t\tvar options = {since: $(this).countdown('option', 'until'), format: \"HM\", layout: \"-{hnn}{sep}{mnn}&nbsp;\"};\n\t\t$(this).countdown(\"option\", options);\n\t}\n\n    // Handles WH Type hover-over tooltip\n\t// ToDo: Use native JS\n\tthis.whTooltip = function(sig) {\n\t\tif (viewingSystemID == sig.systemID) {\n\t\t\tif ($.inArray(sig.type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\t\tvar type = sig.type;\n\t\t\t\tvar tooltip = '';\n\t\t\t} else {\n\t\t\t\tvar type = sig.sig2Type;\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+type+\"<br/>\";\n\t\t\t}\n\t\t} else {\n\t\t\tif ($.inArray(sig.sig2Type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\t\tvar type = sig.sig2Type;\n\t\t\t\tvar tooltip = '';\n\t\t\t} else {\n\t\t\t\tvar type = sig.type;\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+type+\"<br/>\";\n\t\t\t}\n\t\t}\n\n\t\tif ($.inArray(type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\tvar whType = true;\n\t\t} else {\n\t\t\tvar whType = false;\n\t\t}\n\n\t\ttooltip += \"<b>Life:</b> \"+(whType?tripwire.wormholes[type].life:\"Unknown\")+\"<br/>\";\n\n\t\tif (whType) {\n\t\t\tswitch (tripwire.wormholes[type].leadsTo.split(\" \")[0]) {\n\t\t\t\tcase 'High-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='hisec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Low-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='lowsec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Null-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='nullsec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Class':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='wh'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t}\n\t\t} else {\n\t\t\ttooltip += \"<b>Leads To:</b> <span>Unknown</span><br/>\";\n\t\t}\n\n\t\ttooltip += \"<b>Max Mass</b>: \"+(whType?numFormat(tripwire.wormholes[type].mass):\"Unknown\")+\" Kg<br/>\";\n\n\t\ttooltip += \"<b>Max Jumpable</b>: \"+(whType?numFormat(tripwire.wormholes[type].jump):\"Unknown\")+\" Kg<br/>\";\n\n\t\treturn tooltip;\n\t}\n\n\t// Handles Age hover-over tooltip\n\t// ToDo: Use native JS\n\tthis.ageTooltip = function(sig) {\n\t\t// var date = new Date(sig.lifeTime);\n\t\t// var localOffset = date.getTimezoneOffset() * 60000;\n\t\t// date = new Date(date.getTime() + localOffset);\n        var date = new Date(sig.lifeTime);\n\n\t\tvar tooltip = \"<table class=\\\"age-tooltip-table\\\"><tr>\"\n        + \"<th>Created:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\n        + \"<td>\"+sig.createdByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\n        + \"</tr>\";\n\n\t\tif (sig.lifeTime != sig.modifiedTime) {\n\t\t\tdate = new Date(sig.modifiedTime);\n\t\t\t// localOffset = date.getTimezoneOffset() * 60000;\n\t\t\t// date = new Date(date.getTime() + localOffset);\n      \n\t\t\ttooltip += \"<tr><th>Last Modified:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\n          + \"<td>\"+sig.modifiedByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\n          + \"</tr>\";\n\t\t}\n\n\t\ttooltip += \"</table>\";\n\n\t\treturn tooltip;\n\t}\n\n    this.refresh = function(mode, data, successCallback, alwaysCallback) {\n\t\tvar mode = mode || 'refresh';\n\n\t\tthis.sync(mode, data, successCallback, alwaysCallback);\n\t}\n}\n","$(\"body\").on(\"click\", \"a[href^='.?system=']\", function(e) {\n\te.preventDefault();\n\n\tvar system = $(this).attr(\"href\").replace(\".?system=\", \"\");\n\tvar systemID = Object.index(tripwire.systems, \"name\", system);\n\n\ttripwire.systemChange(systemID);\n});\n\n$(\"body\").on(\"submit\", \"#systemSearch\", function(e) {\n\te.preventDefault();\n\n\tvar system = $(this).find(\"[name='system']\").val();\n\tvar systemID = Object.index(tripwire.systems, \"name\", system, true) || false;\n\n\tif (systemID !== false) {\n\t\ttripwire.systemChange(systemID);\n\t\t$(this).find(\"[name='system']\").val(\"\");\n\t\t$(\"#search\").click();\n\t}\n});\n\n$(\"body\").on(\"click\", \"#undo:not(.disabled)\", function() {\n\ttripwire.undo();\n});\n\n$(\"body\").on(\"click\", \"#redo:not(.disabled)\", function() {\n\ttripwire.redo();\n});\n\n// Chain map zooming (Gets funky if you push things too far)\n$(\"#chainParent\").on(\"mousewheel\", function(e) {\n\te.preventDefault();\n\tvar zoom = parseFloat($(\"#chainParent\").css(\"zoom\")) || 1.0;\n\tvar min = 0.6;\n\tvar max = 2.0;\n\n    if (e.originalEvent.wheelDelta / 120 > 0 && zoom < max) {\n\t\t$(\"#chainParent\").css(\"zoom\", zoom + 0.1);\n    } else if (e.originalEvent.wheelDelta / 120 < 0 && zoom > min) {\n\t\t$(\"#chainParent\").css(\"zoom\", zoom - 0.1);\n    }\n\n\t// Show the reset zoom button for awhile\n\t$(\"#chain-zoom-reset\").fadeIn(200);\n\tif (this.timeout) clearTimeout(this.timeout);\n\tthis.timeout = setTimeout('$(\"#chain-zoom-reset\").fadeOut(200);', 3000);\n\n\t// Save options\n\toptions.chain.zoom = parseFloat($(\"#chainParent\").css(\"zoom\"));\n\toptions.saveDelay(2000);\n});\n\n$(\"#chain-zoom-reset\").on(\"click\", function() {\n\t$(\"#chainParent\").css(\"zoom\", 1);\n\toptions.chain.zoom = 1;\n\toptions.saveDelay(2000);\n});\n\n$(document).keydown(function(e)\t{\n\t//Abort - user is in input or textarea\n\tif ($(document.activeElement).is(\"textarea, input\")) return;\n\n\t// Ctrl key hooks\n\tif (e.metaKey || e.ctrlKey) {\n\n\t\tif (e.keyCode === 89 && !$(\"#redo\").hasClass(\"disabled\")) {\n\t\t\t// Ctrl-y redo hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#redo\").click();\n\t\t\tNotify.trigger(\"Redoing last undo\");\n\t\t} else if (e.keyCode === 90 && !$(\"#undo\").hasClass(\"disabled\")) {\n\t\t\t// Ctrl-z undo hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#undo\").click();\n\t\t\tNotify.trigger(\"Undoing last action\");\n\t\t} else if (e.keyCode === 65) {\n\t\t\t// Ctrl-a select all (signatures) hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#sigTable tbody tr\").addClass(\"selected\");\n\t\t\t$(\"#signaturesWidget #delete-signature\").trigger(\"delete:refresh\");\n\t\t} else if (e.keyCode === 67) {\n\t\t\t// Ctrl-c copy selected signatures hook\n\t\t\tif (window.getSelection().toString() === \"\") {\n\t\t\t\tvar output = \"\";\n\t\t\t\t$(\"#sigTable tbody tr.selected\").each(function(row) {\n\t\t\t\t\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\n\t\t\t\t\tvar row = [];\n\n\t\t\t\t\tif (signature.signatureID) {\n\t\t\t\t\t\trow.push(signature.signatureID.substring(0, 3).toUpperCase() + \"-\" + (signature.signatureID.substring(3, 6) || \"###\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.push(\"null\");\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(signature.type);\n\t\t\t\t\tif (signature.type === \"wormhole\") {\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\tvar otherSignature = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\trow.push(wormhole.type || \"null\" );\n\t\t\t\t\t\trow.push(tripwire.systems[signature.systemID] ? tripwire.systems[signature.systemID].name : tripwire.aSigSystems[signature.systemID]);\n\t\t\t\t\t\trow.push(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : tripwire.aSigSystems[otherSignature.systemID]);\n\t\t\t\t\t\trow.push(wormhole.life);\n\t\t\t\t\t\trow.push(wormhole.mass);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.push(signature.name);\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(signature.createdByName);\n\t\t\t\t\trow.push(signature.lifeTime);\n\t\t\t\t\trow.push(signature.lifeLength);\n\t\t\t\t\trow.push(signature.lifeLeft);\n\t\t\t\t\trow.push(signature.modifiedByName);\n\t\t\t\t\trow.push(signature.modifiedTime);\n\t\t\t\t\toutput += row.join(options.signatures.copySeparator) + \"\\r\\n\";\n\t\t\t\t});\n\t\t\t\t$(\"#clipboard\").text(output);\n\t\t\t\t$(\"#clipboard\").focus();\n\t\t\t\t$(\"#clipboard\").select();\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// delete key keyhooks\n\t\tif (e.keyCode == 46 && $(\"#sigTable tr.selected\").length > 0) {\n\t\t\t$(\"#delete-signature\").click();\n\t\t}\n\t}\n});\n\n// $(\"#APIclock\").knob({angleArc: 359.9, height: 20, width: 20, max: 60, readOnly: true, displayInput: false, fgColor: \"#CCC\", bgColor: \"#666\"});\n\n$(\"#follow\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\toptions.buttons.follow = $(this).hasClass(\"active\");\n\toptions.save();\n})\n\n$(\"#show-viewing\").click(function() {\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\tchain.redraw();\n\n\toptions.buttons.chainWidget.viewing = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#show-favorite\").click(function() {\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\tchain.redraw();\n\n\toptions.buttons.chainWidget.favorites = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#system-favorite\").click(function() {\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\").attr(\"data-icon\", \"star-empty\");\n\n\t\toptions.favorites.splice(options.favorites.indexOf(parseInt(viewingSystemID)), 1);\n\t} else {\n\t\t$(this).attr(\"data-icon\", \"star\").addClass(\"active\");\n\n\t\toptions.favorites.push(parseInt(viewingSystemID));\n\t}\n\n\tif ($(\"#show-favorite\").hasClass(\"active\"))\n\t\tchain.redraw();\n\n\toptions.save();\n});\n\n$(\"#search\").click(function(e) {\n\t$(\"#searchSpan\").toggle();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName)\n\t\t\t$(\"#currentSpan\").show();\n\t} else {\n\t\t$(this).addClass(\"active\");\n\t\t$(\"#currentSpan\").hide();\n\n\t\t$(\"#searchSpan input[name=system]\").focus().select();\n\t}\n});\n\n$(\"#toggle-automapper\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\t} else {\n\t\t$(this).addClass(\"active\");\n\t}\n\n\toptions.buttons.signaturesWidget.autoMapper = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#track\").on(\"click\", \".tracking-clone\", function() {\n\tvar characterID =$(this).attr(\"data-characterid\");\n\t$(\"#tracking .tracking-clone\").removeClass(\"active\");\n\n\tif (options.tracking.active == characterID) {\n\t\toptions.tracking.active = null;\n\t\ttripwire.EVE(false, true);\n\t\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\n\t} else {\n\t\toptions.tracking.active = characterID;\n\n\t\tif (tripwire.esi.characters[options.tracking.active]) {\n\t\t\t$(\"#tracking .tracking-clone[data-characterid='\"+ options.tracking.active +\"']\").addClass(\"active\");\n\t\t\ttripwire.EVE(tripwire.esi.characters[options.tracking.active], true);\n\t\t}\n\n\t\t$(\"#removeESI\").removeAttr(\"disabled\");\n\t}\n\n\toptions.save();\n});\n\n$(\"#login\").on(\"click\", \"#removeESI\", function() {\n\tvar characterID = options.tracking.active;\n\n\toptions.tracking.active = null;\n\ttripwire.EVE(false, true);\n\toptions.save();\n\n\t$(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\n\n\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\n\n\tif ($.isArray(tripwire.data.esi.delete)) {\n\t\ttripwire.data.esiDelete.push(characterID);\n\t} else {\n\t\ttripwire.data.esiDelete = [characterID];\n\t}\n});\n\n$(\"#user\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\n\t\t$(\"#login > #panel\").css({display: \"none\"});\n\n\t\t//$(\"#wrapper\").unbind(\"click\");\n\t} else {\n\t\t$(this).addClass(\"active\");\n\n\t\t$(\"#login > #panel\").css({display: \"inline\"});\n\t\t$(\"#loginForm input[name=username]\").focus().select();\n\n\t\t// Click outside closes\n\t\t$(\"#wrapper\").click(function(e) {\n\t\t\t$(\"#login > #panel\").css({display: \"none\"});\n\t\t\t$(\"#user\").removeClass(\"active\");\n\t\t});\n\n\t\t$(\"#login\").click(function(e) {\n\t\t\te.stopPropagation();\n\t\t})\n\t}\n});\n\n$(\"#logout\").click(function() {\n\twindow.location = \"logout.php\";\n});\n\nvar Notify = new function() {\n\tthis.trigger = function(content, color, stick, id) {\n\t\tvar color = typeof(color) !== \"undefined\" ? color : \"blue\";\n\t\tvar stick = typeof(stick) !== \"undefined\" ? stick : 10000;\n\t\tvar id = typeof(id) !== \"undefined\" ? id : null;\n\n\t\tnew jBox(\"Notice\", {\n\t\t\tid: id,\n\t\t\tcontent: content,\n\t\t\toffset: {y: 35},\n\t\t\tanimation: \"flip\",\n\t\t\tcolor: color,\n\t\t\tautoClose: stick\n\t\t});\n\t}\n}\n\n// Init valdiation tooltips\nvar ValidationTooltips = new jBox(\"Tooltip\", {\n\ttrigger: null,\n\taddClass: \"validation-tooltip\",\n\tanimation: \"flip\",\n\tfade: 0\n});\n\nvar Tooltips = new jBox(\"Tooltip\", {\n\tattach: $(\"[data-tooltip]\"),\n\tgetContent: \"data-tooltip\",\n\tposition: {x: \"right\", y: \"center\"},\n\toutside: \"x\"\n});\n\nvar SystemActivityToolTips = new jBox(\"Tooltip\", {\n\tgetContent: \"data-tooltip\",\n\tposition: {y: \"bottom\"},\n\tappendTo: $(\"#chainParent\"),\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\toffset: {y: +9, x: +3},\n\tonOpen: function() {\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\n\t\tvar nodePos = this.source.closest(\"[data-nodeid]\").position();\n\t\tvar parentPos = this.source.closest(\".nodeActivity\").position();\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar tooltipWidth = this.container.parent().width();\n\t\t// var tooltipHeight = this.container.parent().height();\n\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\n\t}\n});\n\nvar WormholeRouteToolTips = new jBox(\"Tooltip\", {\n\tgetContent: \"data-tooltip\",\n\tposition: {y: \"bottom\"},\n\tappendTo: $(\"#chainParent\"),\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\toffset: {y: +9, x: +3},\n\tonOpen: function() {\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar tooltipWidth = this.container.parent().width();\n\t\t// var tooltipHeight = this.container.parent().height();\n\t\t\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\n\t}\n});\n\nvar WormholeTypeToolTips = new jBox(\"Tooltip\", {\n\tattach: $(\"#chainMap .whEffect[data-icon]\"),\n\tgetContent: \"data-tooltip\",\n\tposition: {x: \"left\", y: \"center\"},\n\tappendTo: $(\"#chainParent\"),\n\toutside: \"x\",\n\tadjustDistance: 100,\n\tresponsiveWidth: false,\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\toffset: {y: +9, x: +3},\n\tonOpen: function() {\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\n\t\tvar tooltipWidth = this.container.parent().width();\n\n\t\tthis.options.position = {x: targetPos.left - tooltipWidth - 10, y: targetPos.top - 3};\n\t}\n});\n\nvar OccupiedToolTips = new jBox(\"Tooltip\", {\n\tpointer: \"top:-3\",\n\tposition: {x: \"right\", y: \"center\"},\n\tappendTo: $(\"#chainParent\"),\n\toutside: \"x\",\n\tminWidth: 100,\n\tanimation: \"move\",\n\tadjustDistance: 100,\n\tresponsiveWidth: false,\n\treposition: true,\n\trepositionOnOpen: true,\n\trepositionOnContent: true,\n\tcreateOnInit: true,\n\toffset: {y: +9, x: +3},\n\tonOpen: function() {\n\t\tvar tooltip = this;\n\t\tconst nodeElemJ = this.source.closest(\"[data-nodeid]\");\n\t\tvar systemID = nodeElemJ.data(\"nodeid\");\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\n\n\t\tthis.options.position = {x: targetPos.left + this.target[0].offsetWidth, y: targetPos.top - 3};\n\n\t\ttooltip.setContent(\"&nbsp;\");\n\n\t\t$.ajax({\n\t\t\turl: \"occupants.php\",\n\t\t\tdataType: \"JSON\",\n\t\t\tdata: \"systemID=\"+systemID,\n\t\t\tcache: false\n\t\t}).done(function(data) {\n\t\t\tif (data && data.occupants) {\n\t\t\t\tvar chars = \"<table>\";\n\n\t\t\t\t// Sort by characterName\n\t\t\t\tdata.occupants.sort(function(a, b) {\n\t\t\t\t\tif (a.characterName.toLowerCase() < b.characterName.toLowerCase()) return -1;\n\t\t\t\t\tif (a.characterName.toLowerCase() > b.characterName.toLowerCase()) return 1;\n\t\t\t\t\treturn 0;\n\t\t\t\t});\n\n\t\t\t\tfor (var x in data.occupants) {\n\t\t\t\t\tchars += \"<tr><td>\"+data.occupants[x].characterName+\"</td><td style='padding-left: 10px;'>\"+(data.occupants[x].shipTypeName?data.occupants[x].shipTypeName:\"\")+\"</td></tr>\";\n\t\t\t\t}\n\n\t\t\t\tchars += \"</table>\";\n\t\t\t\ttooltip.setContent(chars);\n\t\t\t}\n\t\t});\n\t}\n});\n\n$(\"#chainTabs\").sortable({\n\titems: \"> .tab\",\n\taxis: \"x\",\n\tdelay: 150,\n\ttolerance: \"pointer\",\n\tcontainment: \"parent\",\n\tupdate: function(e, ui) {\n\t\tvar result = $(\"#chainTabs\").sortable(\"toArray\");\n\t\tvar newTabs = [];\n\n\t\tfor (var x in result) {\n\t\t\tnewTabs.push(options.chain.tabs[result[x]]);\n\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\n\t\t}\n\n\t\toptions.chain.active = $(\".tab.current\").index();\n\t\toptions.chain.tabs = newTabs;\n\t\toptions.save();\n\t}\n});\n\n$(\"#chainTabs\").on(\"click\", \".tab\", function(e) {\n\te.preventDefault();\n\tchain.setActiveTab($(this).hasClass(\"current\") ? null : $(this).index())\n});\n\n$(\"#chainTabs\").on(\"click\", \".closeTab\", function(e) {\n\te.stopPropagation();\n\tvar $tab = $(this).closest(\".tab\");\n\n\t$(\"#dialog-confirm #msg\").html(\"This tab will be removed, are you sure?\");\n\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\tbuttons: {\n\t\t\t\"Remove Tab\": function() {\n\t\t\t\tvar i = $tab.index();\n\n\t\t\t\toptions.chain.active = $(\".tab.current\").index();\n\t\t\t\toptions.chain.tabs.splice(i, 1);\n\t\t\t\toptions.save();\n\n\t\t\t\t$tab.remove();\n\t\t\t\tif ($(\"#chainTabs .tab.current\").length == 0) {\n\t\t\t\t\t$(\"#chainTabs .tab:last\").click();\n\t\t\t\t}\n\n\t\t\t\tfor (var x = 0, l = $(\"#chainTabs .tab\").length; x < l; x++) {\n\t\t\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\n\t\t\t\t}\n\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t},\n\t\t\tCancel: function() {\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t}\n\t\t}\n\t}).dialog(\"open\");\n});\n\n$(\"#newTab\").on(\"click\", function() {\n\t// check if dialog is open\n\tif (!$(\"#dialog-newTab\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-newTab\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tOK: function() {\n\t\t\t\t\t$(\"#newTab_form\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-newTab .name\").val(viewingSystem).focus();\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").val(viewingSystem);\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#newTab_form\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\n\t\t\t\t\tvar name = $(\"#dialog-newTab .name\").val();\n\t\t\t\t\tvar systemID = lookupByPropertyMultiple(tripwire.systems, \"name\", $(\"#dialog-newTab .sigSystemsAutocomplete\").val(), true);\n\t\t\t\t\tvar thera = $(\"#tabThera\")[0].checked ? true : false;\n\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .name\")}).setContent(\"Must have a name!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (!systemID && $(\"#tabType1\")[0].checked) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if ($(\"#tabType2\")[0].checked) {\n\t\t\t\t\t\tsystemID = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\n\t\t\t\t\toptions.chain.tabs.push({systemID: systemID, name: name, evescout: thera});\n\t\t\t\t\toptions.save();\n\n\t\t\t\t\t$(\"#chainTabs\").append($tab);\n\n\t\t\t\t\t$(\"#dialog-newTab\").dialog(\"close\");\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").click(function(e) {\n\t\t\t\t\t$(\"#dialog-newTab #tabType1\").click();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-newTab\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-newTab\").dialog(\"open\");\n\t}\n});\n\n$(\"#chainTabs\").on(\"click\", \".editTab\", function(e) {\n\te.stopPropagation();\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-editTab\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-editTab\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tOK: function() {\n\t\t\t\t\t$(\"#editTab_form\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-editTab .name\").val(options.chain.tabs[options.chain.active].name).focus();\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").val(options.chain.tabs[options.chain.active].systemID != 0 ? lookupMultiple(tripwire.systems, 'name', options.chain.tabs[options.chain.active].systemID) : \"\");\n\t\t\t\toptions.chain.tabs[options.chain.active].systemID != 0 ? $(\"#dialog-editTab #editTabType1\")[0].checked = true : $(\"#dialog-editTab #editTabType2\")[0].checked = true;\n\t\t\t\t$(\"#dialog-editTab #editTabThera\")[0].checked = options.chain.tabs[options.chain.active].evescout;\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#editTab_form\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar $tab = $(\"#chainTabs .tab\").eq([options.chain.active]);\n\t\t\t\t\tvar name = $(\"#dialog-editTab .name\").val();\n\t\t\t\t\tvar systemID = lookupByPropertyMultiple(tripwire.systems, \"name\", $(\"#dialog-editTab .sigSystemsAutocomplete\").val(), true);\n\t\t\t\t\tvar thera = $(\"#editTabThera\")[0].checked ? true : false;\n\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .name\")}).setContent(\"Must have a name!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (!systemID && $(\"#editTabType1\")[0].checked) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if ($(\"#editTabType2\")[0].checked) {\n\t\t\t\t\t\tsystemID = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\n\t\t\t\t\toptions.chain.tabs[options.chain.active] = {systemID: systemID, name: name, evescout: thera};\n\t\t\t\t\toptions.save();\n\t\t\t\t\tchain.redraw();\n\n\t\t\t\t\ttripwire.parse(tripwire.client, \"refresh\");\n\n\t\t\t\t\t//$(\"#chainTabs\").append($tab);\n\n\t\t\t\t\t$(\"#dialog-editTab\").dialog(\"close\");\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").click(function(e) {\n\t\t\t\t\t$(\"#dialog-editTab #editTabType1\").click();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-editTab\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-editTab\").dialog(\"open\");\n\t}\n});\n\n// Signature column context menu\n$(\"#signaturesWidget #sigTable thead\").contextmenu({\n\tdelegate: \"th.sortable\",\n\tmenu: \"#signatureColumnMenu\",\n\tposition: function(event, ui) {\n        return {my: \"left top\", at: \"center\", of: ui.target};\n    },\n\tselect: function(e, ui) {\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\n\n\t\tswitch(col) {\n\t\t\tcase 1:\n\t\t\t\tcolName = \"sigID\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcolName = \"sigType\";\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcolName = \"sigAge\";\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcolName = \"leadsTo\";\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tcolName = \"sigLife\";\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tcolName = \"sigMass\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch(ui.cmd) {\n\t\t\tcase \"leftAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign rightAlign\").addClass(\"leftAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"leftAlign\";\n\t\t\t\tbreak;\n\t\t\tcase \"centerAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"leftAlign rightAlign\").addClass(\"centerAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"centerAlign\";\n\t\t\t\tbreak;\n\t\t\tcase \"rightAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign leftAlign\").addClass(\"rightAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"rightAlign\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\toptions.save();\n\t},\n\tbeforeOpen: function(e, ui) {\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\n\n\t\tswitch(col) {\n\t\t\tcase 1:\n\t\t\t\tcolName = \"sigID\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcolName = \"sigType\";\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcolName = \"sigAge\";\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcolName = \"leadsTo\";\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tcolName = \"sigLife\";\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tcolName = \"sigMass\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\t$(this).contextmenu(\"enableEntry\", \"leftAlign\", true);\n\t\t$(this).contextmenu(\"enableEntry\", \"centerAlign\", true);\n\t\t$(this).contextmenu(\"enableEntry\", \"rightAlign\", true);\n\n\t\t$(this).contextmenu(\"enableEntry\", options.signatures.alignment[colName], false);\n\t}\n});\n\n// Chain Map Context Menu\n$(\"#chainParent\").contextmenu({\n\tappendTo: \"#chainParent\",\n\tdelegate: \".nodeSystem a\",\n\tposition: function(event, ui) {\n        return {my: \"left top-1\", at: \"right top\", of: ui.target};\n    },\n\tmenu: \"#chainMenu\",\n\tshow: {effect: \"slideDown\", duration: 150},\n\tselect: function(e, ui) {\n\t\tconst nodeElem = $(ui.target[0]).closest(\"[data-nodeid]\");\n\t\tvar id = nodeElem.data(\"nodeid\");\n\t\tvar row = nodeElem.attr(\"id\").replace(\"node\", \"\") -1;\n\n\t\tswitch(ui.cmd) {\n\t\t\tcase \"showInfo\":\n\t\t\t\ttripwire.esi.showInfo(id, options.tracking.active);\n\t\t\t\tbreak;\n\t\t\tcase \"setDest\":\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, true);\n\t\t\t\tbreak;\n\t\t\tcase \"addWay\":\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, false);\n\t\t\t\tbreak;\n\t\t\tcase \"showMap\":\n\t\t\t\t// CCPEVE.showMap(id);\n\t\t\t\tbreak;\n\t\t\tcase \"red\":\n\t\t\t\tnodeElem.hasClass(\"redNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"yellow\":\n\t\t\t\tnodeElem.hasClass(\"yellowNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"green\":\n\t\t\t\tnodeElem.hasClass(\"greenNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"mass\":\n\t\t\t\t$(\"#dialog-mass\").data(\"id\", nodeElem.data(\"sigid\")).data(\"systemID\", id).dialog(\"open\");\n\t\t\t\tbreak;\n\t\t\tcase \"ping\":\n\t\t\t\t$(\"#dialog-ping\").data(\"id\", nodeElem.data(\"sigid\") || null).data(\"systemID\", id).dialog(\"open\");\n\t\t\t\tbreak;\n\t\t\tcase \"collapse\":\n\t\t\t\tvar toggle = options.chain.tabs[options.chain.active] ? ($.inArray(id, options.chain.tabs[options.chain.active].collapsed) == -1 ? true : false) : true;\n\t\t\t\tchain.renderer.collapse(id, toggle);\n\t\t\t\tbreak;\n\t\t\tcase \"makeTab\":\n\t\t\t\tconst existingTabIndex = Object.index(options.chain.tabs, 'systemID', '' + id, false);\n\t\t\t\tif(undefined !== existingTabIndex) {\n\t\t\t\t\tchain.setActiveTab(existingTabIndex);\n\t\t\t\t} else {\n\t\t\t\t\tconst systemName = tripwire.systems[id].name;\n\t\t\t\t\toptions.chain.tabs.push({systemID: '' + id, name: systemName});\n\t\t\t\t\tvar newTab = $(\"#chainTab .tab\").clone();\n\t\t\t\t\tnewTab.attr('id', options.chain.tabs.length - 1).find(\".name\").data(\"tab\", id).html(systemName);\n\t\t\t\t\t$(\"#chainTabs\").append(newTab);\n\t\t\t\t\tchain.setActiveTab(options.chain.tabs.length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t},\n\tbeforeOpen: function(e, ui) {\n\t\tvar wormholeID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"sigid\") || null;\n\t\tvar systemID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\");\n\n\t\t// Add check for k-space\n\t\tif (tripwire.systems[systemID].class || !tripwire.esi.characters[options.tracking.active]) {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", false);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", false);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\n\t\t} else {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", true);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", true);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\n\t\t}\n\t\t\n\t\t// Add check for in-sig\n\t\tif (wormholeID) {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", true);\n\t\t} else {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", false);\n\t\t}\n\t\t\n\t\t// Add check for tab validity\n\t\tconst existingTab = Object.find(options.chain.tabs, 'systemID', '' + systemID, false);\n\t\t$('#makeTabMenuItem').text(existingTab ? 'View Tab' : 'Make Tab' );\n\t},\n\tcreate: function(e, ui) {\n\t\t// Fix some bad CSS from jQuery Position\n\t\t$(this).find(\".ui-front\").css(\"width\", \"10em\");\n\t\t$(this).find(\".ui-front\").css(\"position\", \"\");\n\n\t\t$(\"#dialog-mass\").dialog({\n\t\t\tautoOpen: false,\n\t\t\twidth: \"auto\",\n\t\t\theight: \"auto\",\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tClose: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\tvar wormholeID = $(this).data(\"id\");\n\t\t\t\tvar systemID = $(this).data(\"systemID\");\n\t\t\t\tvar wormhole = tripwire.client.wormholes[wormholeID];\n\t\t\t\tvar signature = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\tvar otherSignature = tripwire.client.signatures[wormhole.secondaryID];\n\n\t\t\t\t$(\"#dialog-mass\").dialog(\"option\", \"title\", \"From \"+tripwire.systems[signature.systemID].name+\" to \"+tripwire.systems[otherSignature.systemID].name);\n\n\t\t\t\t$(\"#dialog-mass #massTable tbody tr\").remove();\n\n\t\t\t\tvar payload = {wormholeID: wormhole.id};\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"mass.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: payload,\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tif (data && data.mass) {\n                        var totalMass = 0;\n\t\t\t\t\t\tfor (x in data.mass) {\n                            totalMass += parseFloat(data.mass[x].mass);\n\t\t\t\t\t\t\t$(\"#dialog-mass #massTable tbody\").append(\"<tr><td>\"+data.mass[x].characterName+\"</td><td>\"+(data.mass[x].toID == systemID ? \"In\" : \"Out\")+\"</td><td>\"+data.mass[x].shipType+\"</td><td>\"+numFormat(data.mass[x].mass)+\"Kg</td><td>\"+data.mass[x].time+\"</td></tr>\");\n\t\t\t\t\t\t}\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr><td></td><td></td><td></td><th>\"+ numFormat(totalMass) +\"Kg</th><td></td></tr>\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$.moogle.contextmenu.prototype.setFlare = function(systemID, flare, ui) {\n\t\t\tvar data = {\"systemID\": systemID, \"flare\": flare};\n\n\t\t\t$.ajax({\n\t\t\t\turl: \"flares.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: data,\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.result) {\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\").addClass(flare+\"Node\");\n\n\t\t\t\t\tchain.data.flares.flares.push({systemID: systemID, flare: flare, time: null});\n\t\t\t\t\tchain.flares(chain.data.flares);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$.moogle.contextmenu.prototype.removeFlare = function(systemID, ui) {\n\t\t\tvar data = {\"systemID\": systemID};\n\n\t\t\t$.ajax({\n\t\t\t\turl: \"flares.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: data,\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.result) {\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\");\n\n\t\t\t\t\tchain.data.flares.flares.splice(Object.index(chain.data.flares.flares, \"systemID\", systemID), 1);\n\t\t\t\t\tchain.flares(chain.data.flares);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n\n// Used to generate eve-survival guide link\nfunction linkSig(sigName) {\n\tvar wormholeSignatures = [\n\t\t// Ore sites\n\t\t\"Average Frontier Deposit\",\n\t\t\"Unexceptional Frontier Deposit\",\n\t\t\"Common Perimeter Deposit\",\n\t\t\"Exceptional Core Deposit\",\n\t\t\"Infrequent Core Deposit\",\n\t\t\"Unusual Core Deposit\",\n\t\t\"Rarified Core Deposit\",\n\t\t\"Isolated Core Deposit\",\n\t\t\"Ordinary Permiter Deposit\",\n\t\t\"Uncommon Core Deposit\",\n\n\t\t// Gas Sites\n\t\t\"Barren Perimeter Reservoir\",\n\t\t\"Minor Perimeter Reservoir\",\n\t\t\"Ordinary Perimeter Reservoir\",\n\t\t\"Sizeable Perimeter Reservoir\",\n\t\t\"Token Perimeter Reservoir\",\n\t\t\"Bountiful Frontier Reservoir\",\n\t\t\"Vast Frontier Reservoir\",\n\t\t\"Instrumental Core Reservoir\",\n\t\t\"Vital Core Reservoir\",\n\n\t\t// Class 1\n\t\t\"Perimeter Ambush Point\",\n\t\t\"Perimeter Camp\",\n\t\t\"Phase Catalyst Node\",\n\t\t\"The Line\",\n\t\t\"Forgotten Perimeter Coronation Platform\",\n\t\t\"Forgotten Perimeter Power Array\",\n\t\t\"Unsecured Perimeter Amplifier\",\n\t\t\"Unsecured Perimeter Information Center\",\n\n\t\t// Class 2\n\t\t\"Perimeter Checkpoint\",\n\t\t\"Perimeter Hangar\",\n\t\t\"The Ruins of Enclave Cohort 27\",\n\t\t\"Sleeper Data Sanctuary\",\n\t\t\"Forgotten Perimeter Gateway\",\n\t\t\"Forgotten Perimeter Habitation Coils\",\n\t\t\"Unsecured Perimeter Comms Relay\",\n\t\t\"Unsecured Perimeter Transponder Farm\",\n\n\t\t// Class 3\n\t\t\"Fortification Frontier Stronghold\",\n\t\t\"Outpost Frontier Stronghold\",\n\t\t\"Solar Cell\",\n\t\t\"The Oruze Construct\",\n\t\t\"Forgotten Frontier Quarantine Outpost\",\n\t\t\"Forgotten Frontier Recursive Depot\",\n\t\t\"Unsecured Frontier Database\",\n\t\t\"Unsecured Frontier Receiver\",\n\n\t\t// Class 4\n\t\t\"Frontier Barracks\",\n\t\t\"Frontier Command Post\",\n\t\t\"Integrated Terminus\",\n\t\t\"Sleeper Information Sanctum\",\n\t\t\"Forgotten Frontier Conversion Module\",\n\t\t\"Forgotten Frontier Evacuation Center\",\n\t\t\"Unsecured Frontier Digital Nexus\",\n\t\t\"Unsecured Frontier Trinary Hub\",\n\n\t\t// Class 5\n\t\t\"Core Garrison\",\n\t\t\"Core Stronghold\",\n\t\t\"Oruze Osobnyk\",\n\t\t\"Quarantine Area\",\n\t\t\"Forgotten Core Data Field\",\n\t\t\"Forgotten Core Information Pen\",\n\t\t\"Unsecured Frontier Enclave Relay\",\n\t\t\"Unsecured Frontier Server Bank\",\n\n\t\t// Class 6\n\t\t\"Core Citadel\",\n\t\t\"Core Bastion\",\n\t\t\"Strange Energy Readings\",\n\t\t\"The Mirror\",\n\t\t\"Forgotten Core Assembly Hall\",\n\t\t\"Forgotten Core Circuitry Disassembler\",\n\t\t\"Unsecured Core Backup Array\",\n\t\t\"Unsecured Core Emergence\"\n\t];\n\n\tif (wormholeSignatures.indexOf(sigName) > -1) {\n\t\treturn '<a href=\"http://eve-survival.org/wikka.php?wakka='+sigName.replace(/ /g, '')+'\" target=\"_blank\" class=\"siteLink\">'+sigName+'</a>';\n\t}\n\n\treturn sigName;\n}\n\n// Custom inlinecomplete + dropdown input\n$.widget(\"custom.inlinecomplete\", $.ui.autocomplete, {\n\t_create: function() {\n\t\tif (!this.element.is(\"input\")) {\n\t\t\tthis._selectInit();\n\t\t}\n\n\t\t// Invoke the parent function\n\t\treturn this._super();\n\t},\n\t_value: function() {\n\t\t// Invoke the parent function\n\t\tvar originalReturn = this._superApply(arguments);\n\n\t\tthis.element.change();\n\n\t\treturn originalReturn;\n\t},\n\t_suggest: function(items) {\n\t\t// if (this.element.val() != items[0].value) {\n\t\t\t// this.element.val(items[0].value.substr(0, this.element.val().length));\n\t\t// }\n\n\t\t// Invoke the parent function\n\t\treturn this._super(items);\n\t},\n\t_initSource: function() {\n\t\tif ($.isArray(this.options.source)) {\n\t\t\tthis.source = function(request, response) {\n\t\t\t\tvar matcher = new RegExp(\"^\" + $.ui.autocomplete.escapeRegex(request.term), \"i\");\n\t\t\t\tvar results = new Array(); // results array\n\t\t\t\tvar data = this.options.source;\n\t\t\t\tvar maxSize = this.options.maxSize || 25; // maximum result size\n\t\t\t\t// simple loop for the options\n\t\t\t\tfor (var i = 0, l = data.length; i < l; i++) {\n\t\t\t\t\tif (matcher.test(data[i])) {\n\t\t\t\t\t\tresults.push(data[i]);\n\n\t\t\t\t\t\tif (maxSize && results.length > maxSize) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t // send response\n\t\t\t\t response(results);\n\t\t\t}\n\t\t} else {\n\t\t\t// Invoke the parent function\n\t\t\treturn this._super();\n\t\t}\n\t},\n\t_close: function(event) {\n\t\tthis.options.source = this.options.input_source ? this.options.input_source : this.options.source;\n\n\t\t// Invoke the parent function\n\t\treturn this._super(event);\n\t},\n\taddToSelect: function(value) {\n\t\tthis.options.select_added_value = value;\n\t\tthis.options.select_source.unshift(value);\n\t},\n\tremoveFromSelect: function(value) {\n\t\tif (value) {\n\t\t\tthis.options.select_source.splice(value, 1);\n\t\t} else if (this.options.select_added_value) {\n\t\t\tthis.options.select_source.splice(this.options.select_added_value, 1);\n\t\t}\n\t\tthis.options.select_added_value = null;\n\t},\n\t_selectInit: function() {\n\t\tthis.element.addClass(\"custom-combobox\");\n\t\tthis.wrapper = this.element;\n\t\tthis.element = this.wrapper.find(\"input:first\");\n\t\tthis.select = this.wrapper.find(\"select:first\").remove();\n\n\t\tthis.options.input_source = this.options.source;\n\t\tthis.options.select_source = this.select.children(\"option[value!='']\").map(function() {\n            return $.trim(this.text);\n        }).toArray();\n\n\t\tthis._createShowAllButton();\n\t},\n\t_createShowAllButton: function() {\n        var that = this,\n          wasOpen = false;\n\n        $(\"<a>\")\n\t\t\t.attr(\"tabIndex\", that.element.prop(\"tabindex\"))\n\t\t\t.attr(\"title\", \"\")\n\t\t\t.appendTo(that.wrapper)\n\t\t\t.button({icons: {primary: \"ui-icon-triangle-1-s\"}, text: false})\n\t\t\t.removeClass(\"ui-corner-all\")\n\t\t\t.addClass(\"custom-combobox-toggle ui-corner-right\")\n\t\t\t.on(\"mousedown\", function() {\n\t\t\t\twasOpen = that.widget().is(\":visible\");\n\t\t\t})\n\t\t\t.on(\"click\", function() {\n\t\t\t\tthat.element.trigger(\"focus\");\n\n\t\t\t\t// Close if already visible\n\t\t\t\tif (wasOpen) {\n\t\t\t\t  return;\n\t\t\t\t}\n\n\t\t\t\t// Pass empty string as value to search for, displaying all results\n\t\t\t\tthat.options.source = that.options.select_source;\n\t\t\t\tthat._search(\"\");\n\t\t\t});\n\t},\n});\n\n// Initialize tablesorter plugin on signaturesWidget table\n$(\"#sigTable\").tablesorter({\n\tsortReset: true,\n\twidgets: ['saveSort'],\n\ttextExtraction: {\n\t\t2: function(node) { return $(node).find(\"span\").data(\"age\"); }\n\t}\n});\n\n// Highlight signaturesWidget tr on click\n$(\"#sigTable tbody\").on(\"click\", \"tr\", function(e) {\n\tif (e.metaKey || e.ctrlKey) {\n\t\t// ctrl or cmd key\n\t\t$(this).toggleClass(\"selected\");\n\t} else if (e.shiftKey) {\n\t\t// shift key\n\t\t$(this).addClass(\"selected\");\n\t\t$(\"#sigTable tbody tr.selected:first\").nextUntil(\"#sigTable tbody tr.selected:last\").addBack().add(\"#sigTable tbody tr.selected:last\").addClass(\"selected\");\n\t} else {\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\n\t\t$(this).addClass(\"selected\");\n\t}\n});\n\n// Un-Highlight signaturesWidget tr on clicking outside\n$(document).click(function(e) {\n    if(!$(e.target).closest('#sigTable tbody').length && !$(e.target).closest('#edit-signature').length && !$(e.target).closest('#delete-signature').length) {\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\n    }\n});\n\n// Monitor custom 'classchange' event\n$(\"#sigTable tbody\").on(\"classchange\", \"tr\", function(e, className) {\n\t// Trigger signaturesWidget selected row change custom event\n\tif (className === \"selected\") {\n\t\t$(\"#signaturesWidget\").trigger(\"selected:change\");\n\t}\n});\n\n// Update signaturesWidget based on .selected rows change\n$(\"#signaturesWidget\").on(\"selected:change\", function() {\n\t// Enable/Disable delete icon\n\tif ($(\"#sigTable tr.selected\").length === 0) {\n\t\t$(\"#signaturesWidget #delete-signature\").addClass(\"disabled\");\n\t} else {\n\t\t$(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\n\t}\n\n\t// Enable/Disable edit icon\n\tif ($(\"#sigTable tr.selected\").length === 1) {\n\t\t$(\"#signaturesWidget #edit-signature\").removeClass(\"disabled\");\n\t} else {\n\t\t$(\"#signaturesWidget #edit-signature\").addClass(\"disabled\");\n\t}\n})\n\n$(\"#dialog-error\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tOk: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t},\n\tcreate: function() {\n\t\t$(this).dialog(\"option\", \"show\", {effect: \"shake\", duration: 150, easing: \"easeOutElastic\"});\n\t}\n});\n\n$(\"#dialog-msg\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tOk: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t}\n});\n\n$(\"#dialog-confirm\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tCancel: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t}\n});\n\nif (window.location.href.indexOf(\"galileo\") != -1) {\n\tNotify.trigger(\"This is the test version of Tripwire.<br/>Please use <a href='https://tripwire.cloud-things.com'>Tripwire</a>\")\n}\n","const systemAnalysis = new function() {\n\tconst mutators = [];\n\tthis.addMutator = function(m) { mutators.push(m); }\n\t\n\t/** Extract attributes of the system, and allow mutators to add/modify them.\n\t\tOptionally, pass in a system object */\n\tthis.analyse = function(systemID, system) {\n\t\tif(!system) { system = tripwire.systems[systemID]; }\n\t\tif(!system) { return system; }\n\t\tconst r = Object.assign({}, system);\n\t\t\n\t\t// Defaults or saved original values\n\t\tr.baseSecurity = 1 * system.security;\n\t\tr.pathSymbol = '■';\n\t\tr.systemTypeModifiers = [];\t\t\n\t\t\n\t\tmutators.forEach(function(m) { m.mutate(r, systemID); });\n\t\t\n\t\t// Calculated final values\n\t\tr.systemTypeClass = r.class ? 'wh class-' + r.class :\n\t\t\tr.factionID == 500026 ? 'triglavian' :\n\t\t\tr.security >= 0.45 ? 'hisec' :\n\t\t\tr.security > 0.0 ? 'lowsec' :\n\t\t\tr.security <= 0.0 ? 'nullsec' :\n\t\t\t'unknown';\n\t\tr.systemTypeName = r.class ? 'C' + r.class :\n\t\t\tr.factionID == 500026 ? 'Trig' :\n\t\t\tr.baseSecurity >= 0.45 ? 'HS' :\n\t\t\tr.baseSecurity > 0.0 ? 'LS' :\n\t\t\tr.baseSecurity <= 0.0 ? 'NS' :\n\t\t\t' ';\n\t\t\t\n\t\treturn r;\n\t};\n\n}","var guidance = (function (undefined) {\n\n\tvar extractKeys = function (obj) {\n\t\tvar keys = [];\n\n\t\tfor (var key in obj) {\n\t\t    Object.prototype.hasOwnProperty.call(obj,key) && keys.push(key);\n\t\t}\n\n\t\treturn keys;\n\t}\n\n\tvar sorter = function (a, b) {\n\t\treturn parseFloat (a) - parseFloat (b);\n\t}\n\n\tfunction adjustCostForOptions(mapCost, system) {\n\t\tvar system = systemAnalysis.analyse(30000000 + 1 * system);\n\t\tif(!system) { return mapCost; }\n\t\tif(options.chain.routeIgnore.enabled && options.chain.routeIgnore.systems.indexOf(system.name) >= 0) {\n\t\t\tmapCost += 100;\t// Penalty for an avoided system\n\t\t}\n\t\tswitch(options.chain.routeSecurity) {\n\t\t\tcase 'highsec': return mapCost + (system.security < 0.45 ? 100 : 0);\n\t\t\tcase 'avoid-high': return mapCost + (system.security >= 0.45 ? 100 : 0);\n\t\t\tcase 'avoid-null': return mapCost + (system.security <= 0.0 ? 100 : 0);\n\t\t\tdefault: return mapCost;\t// in case of some invalid option, default to shortest\n\t\t}\n\t}\n\n\tvar findPaths = function (map, start, end, infinity) {\n\t\tinfinity = infinity || Infinity;\n\n\t\tvar costs = {},\n\t\t    open = {'0': [start]},\n\t\t    predecessors = {},\n\t\t    keys;\n\n\t\tvar addToOpen = function (cost, vertex) {\n\t\t\tvar key = \"\" + cost;\n\t\t\tif (!open[key]) open[key] = [];\n\t\t\topen[key].push(vertex);\n\t\t}\n\n\t\tcosts[start] = 0;\n\n\t\twhile (open && !costs[end]) {\n\t\t\tif(!(keys = extractKeys(open)).length) break;\n\n\t\t\tkeys.sort(sorter);\n\n\t\t\tvar key = keys[0],\n\t\t\t    bucket = open[key],\n\t\t\t    node = bucket.shift(),\n\t\t\t    currentCost = parseFloat(key),\n\t\t\t    adjacentNodes = map[node] || {};\n\n\t\t\tif (!bucket.length) delete open[key];\n\n\t\t\tfor (var vertex in adjacentNodes) {\n\t\t\t    if (Object.prototype.hasOwnProperty.call(adjacentNodes, vertex)) {\n\t\t\t\t\tvar cost = adjustCostForOptions(adjacentNodes[vertex], vertex),\n\t\t\t\t\t    totalCost = cost + currentCost,\n\t\t\t\t\t    vertexCost = costs[vertex];\n\n\t\t\t\t\tif ((vertexCost === undefined) || (vertexCost > totalCost)) {\n\t\t\t\t\t\tcosts[vertex] = totalCost;\n\t\t\t\t\t\taddToOpen(totalCost, vertex);\n\t\t\t\t\t\tpredecessors[vertex] = node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (costs[end] === undefined) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn predecessors;\n\t\t}\n\n\t}\n\n\tvar extractShortest = function (predecessors, end) {\n\t\tvar nodes = [],\n\t\t    u = end;\n\n\t\twhile (u) {\n\t\t\tnodes.push(u);\n\t\t\tpredecessor = predecessors[u];\n\t\t\tu = predecessors[u];\n\t\t}\n\n\t\tnodes.reverse();\n\t\treturn nodes;\n\t}\n\n\tvar findShortestPath = function (map, nodes) {\n\t\tvar start = nodes.shift(),\n\t\t    end,\n\t\t    predecessors,\n\t\t    path = [],\n\t\t    shortest;\n\n\t\twhile (nodes.length) {\n\t\t\tend = nodes.shift();\n\t\t\tpredecessors = findPaths(map, start, end);\n\n\t\t\tif (predecessors) {\n\t\t\t\tshortest = extractShortest(predecessors, end);\n\t\t\t\tif (nodes.length) {\n\t\t\t\t\tpath.push.apply(path, shortest.slice(0, -1));\n\t\t\t\t} else {\n\t\t\t\t\treturn path.concat(shortest);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tstart = end;\n\t\t}\n\t}\n\n\tvar toArray = function (list, offset) {\n\t\ttry {\n\t\t\treturn Array.prototype.slice.call(list, offset);\n\t\t} catch (e) {\n\t\t\tvar a = [];\n\t\t\tfor (var i = offset || 0, l = list.length; i < l; ++i) {\n\t\t\t\ta.push(list[i]);\n\t\t\t}\n\t\t\treturn a;\n\t\t}\n\t}\n\n\tvar Guidance = function (map) {\n\t\tthis.map = map;\n\t}\n\n\tGuidance.prototype.findShortestPath = function (start, end) {\n\t\tvar result;\n\n\t\tif (Object.prototype.toString.call(start) === '[object Array]') {\n\t\t\tresult = findShortestPath(this.map, start);\n\t\t} else if (arguments.length === 2) {\n\t\t\tresult = findShortestPath(this.map, [start, end]);\n\t\t} else {\n\t\t\tresult = findShortestPath(this.map, toArray(arguments));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tGuidance.findShortestPath = function (map, start, end) {\n\t\tif (Object.prototype.toString.call(start) === '[object Array]') {\n\t\t\treturn findShortestPath(map, start);\n\t\t} else if (arguments.length === 3) {\n\t\t\treturn findShortestPath(map, [start, end]);\n\t\t} else {\n\t\t\treturn findShortestPath(map, toArray(arguments, 1));\n\t\t}\n\t}\n\n\treturn Guidance;\n})();\n","const thera = new _TheraConnection();\n\nfunction _TheraConnection() {\n\tconst _this = this;\n\t\n\tthis.links = [];\n\t\n\tthis.active = function() {\n\t\treturn options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout;\n\t}\n\t\n\tthis.nodeNameSuffix = 'eve-scout-thera';\n\t\n\tthis.findLinks = function(systemID, ids) {\n\t\tif(!_this.active()) { return; }\n\t\t\n\t\tconst r = [];\n\t\tfor(var ti = 0; ti < this.links.length; ti++) {\n\t\t\tvar theraNode;\n\t\t\tconst theraLink = this.links[ti];\n\t\t\tconst theraID = 'T-' + theraLink.id;\n\t\t\t\n\t\t\tconst nodeDefaults = {\n\t\t\t\tlife: theraLink.wormholeEol,\n\t\t\t\tmass: theraLink.wormholeMass,\n\t\t\t\tid: theraID,\n\t\t\t};\n\t\t\t\n\t\t\tif(theraLink.solarSystemId == systemID) {\t// Connection from this hole\n\t\t\t\tr.push(Object.assign({\n\t\t\t\t\t\n\t\t\t\t\tparent: {\n\t\t\t\t\t\tid: ids.parentID,\n\t\t\t\t\t\tsystemID: systemID,\n\t\t\t\t\t\tsignatureID: theraLink.wormholeDestinationSignatureId,\n\t\t\t\t\t\ttype: theraLink.sourceWormholeType.name,\n\t\t\t\t\t},\tchild: {\n\t\t\t\t\t\tid: ids.nextChildID++,\n\t\t\t\t\t\tsystemID: theraLink.wormholeDestinationSolarSystemId,\n\t\t\t\t\t\tsignatureID: theraLink.signatureId,\n\t\t\t\t\t\ttype: theraLink.destinationWormholeType.name,\t\t\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}, nodeDefaults));\n\t\t\t} else if(theraLink.wormholeDestinationSolarSystemId == systemID) { // Connection to this hole\n\t\t\t\tr.push(Object.assign({\n\t\t\t\t\tparent: {\n\t\t\t\t\t\tid: ids.parentID,\n\t\t\t\t\t\tsystemID: systemID,\n\t\t\t\t\t\tsignatureID: theraLink.signatureId,\n\t\t\t\t\t\ttype: theraLink.destinationWormholeType.name,\n\t\t\t\t\t},\tchild: {\n\t\t\t\t\t\tid: ids.nextChildID++,\n\t\t\t\t\t\tsystemID: theraLink.solarSystemId,\n\t\t\t\t\t\tsignatureID: theraLink.wormholeDestinationSignatureId,\n\t\t\t\t\t\ttype: theraLink.sourceWormholeType.name,\t\t\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}, nodeDefaults));\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn r;\n\t}\n\t\n\t/** Refresh the Thera data from the public Eve-Scout API */\n\tthis.refresh = function() {\n\t\tif(!_this.active()) {\n\t\t\treturn;\t// only look for Thera data if on a tab with the option selected\n\t\t}\n\t\t\n\t\t$.ajax({\n\t\t\turl: `https://api.allorigins.win/get?url=${encodeURIComponent('https://www.eve-scout.com/api/wormholes')}`,\n\t\t\ttype: \"GET\",\n\t\t\tdataType: \"JSON\"\n\t\t}).done(function(data, status, xhr) {\t\n            const wormholes = JSON.parse(data.contents);\n\t\t\tif(!_.isEqual(wormholes, _this.links)) {\n                \n\t\t\t\tconsole.info('Updating map for Thera update');\n\t\t\t\t_this.links = wormholes;\n\t\t\t\tchain.redraw();\n\t\t\t}\n\t\t}).fail(function(xhr, status, error) {\n\t\t\tconsole.warn('Failed to fetch Thera from eve-scout.com: ' + status, error);\n\t\t});\n\t};\n\t\n\tsetInterval(this.refresh, 60000);\n\tthis.refresh();\n}","const ChainMapRendererOrgchart = function(owner) {\n\tconst _this = this;\n\t\n\t/** Initialiser - callback from chart onload */\n\tthis.init = function() {\n\t\t_this.map = new google.visualization.OrgChart(document.getElementById(\"chainMap\"));\n\t\t_this.options = {allowHtml: true, allowCollapse: true, size: \"medium\", nodeClass: \"node\"};\n\n\t\tgoogle.visualization.events.addListener(_this.map, \"collapse\", _this.collapseHandler);\n\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\n\t}\n\t\n\t/** Is this renderer ready to accept draw calls? */\n\tthis.ready = function() { return !this.drawing && !!this.map; }\n\t\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\n\tthis.switchTo = function() {\n\t\tdocument.getElementById('chainGrid').style.display = '';\n\t\tif(!_this.map) { google.charts.setOnLoadCallback(this.init); }\n\t}\n\t\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\n\tthis.switchFrom = function() {\n\t\tdocument.getElementById('chainGrid').style.display = 'none';\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\t\t\n\t}\n\t\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\n\tthis.draw = function(map, lines, collapsed) {\n\t\tthis.drawing = true;\n\t\tthis.map.draw(newView(map), this.options); \n\t\t\n\t\tfor (var x in collapsed) {\n\t\t\tconst s = collapsed[x];\n\t\t\tconst nodeId = $(\"#chainMap [data-nodeid='\"+s+\"']\").attr(\"id\");\n\t\t\tif (nodeId) {\n\t\t\t\tconst nodeVal = nodeId.split(\"node\")[1];\n\t\t\t\tthis.map.collapse(nodeVal - 1, true);\n\t\t\t}\n\t\t}\n\t\t\n\t\tupdateLines(map, lines);\n\t\tthis.drawing = false;\n\t};\n\t\n\tconst newView = function(json) {\n\t\tconst view = new google.visualization.DataView(new google.visualization.DataTable(json));\n\t\treturn view;\n\t};\n\t\n\tconst updateLines = function(map, lines) {\n\t\t_this.lastLineData = { map: map, lines: lines };\n\t\tfunction drawNodeLine(system, parent, mode, signatureID) {\n\t\t\t/*\tfunction for drawing colored lines  */\n\t\t\tif(typeof mode == 'string') { mode = [mode]; }\n\n\t\t\tfunction addModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.addClass(c); }); }\n\t\t\tfunction removeModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.removeClass(c); }); }\n\t\t\tfunction doModeClasses(jquerySelector, prefixes, classFunc) {\n\t\t\t\tprefixes = prefixes || [];\n\t\t\t\tprefixes.push('');\n\t\t\t\tprefixes.forEach(function(prefix) { \n\t\t\t\t\tmode.forEach( function(mode) { classFunc(jquerySelector, (prefix.length ? prefix + '-' : '') + mode); });\n\t\t\t\t});\n\t\t\t\treturn jquerySelector;\n\t\t\t}\n\n\t\t\t// Find node in chainmap\n\t\t\t//var $node = $(\"#chainMap [data-nodeid='\"+system+\"']\").parent();\n\t\t\tvar $node = $(\"#chainMap #node\"+system).parent();\n\n\t\t\tif ($node.length == 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Get node # in this line\n\t\t\tvar nodeIndex = Math.ceil(($node[0].cellIndex + 1) / 2 - 1);\n\n\t\t\t// applly to my top line\n\t\t\tvar $connector = addModes($($node.parent().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[nodeIndex]), [ 'left', 'right' ]);\n\n\t\t\t// Find parent node\n\t\t\t//var $parent = $(\"#chainMap [data-nodeid='\"+parent+\"']\").parent();\n\t\t\tvar $parent = $(\"#chainMap #node\"+parent).parent();\n\n\t\t\tif ($parent.length == 0 || $connector.length == 0)\n\t\t\t\treturn false;\n\n\t\t\t// Find the col of my top line\n\t\t\tvar nodeCol = 0, connectorCell = $connector[0].cellIndex;\n\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\n\t\t\t\tnodeCol += this.colSpan;\n\n\t\t\t\tif (index == connectorCell) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Get node # in this line\n\t\t\tvar parentIndex = Math.ceil(($parent[0].cellIndex + 1) / 2 - 1);\n\n\t\t\t// Compensate for non-parent nodes (slight performance hit ~10ms)\n\t\t\tvar newparentIndex = parentIndex;\n\t\t\tfor (var i = 0; i <= parentIndex; i++) {\n\t\t\t\tvar checkSystem = 0;//$node.parent().prev().prev().prev().find(\"td:has([data-nodeid]):eq(\"+i+\")\").find(\"[data-nodeid]\").data(\"nodeid\");\n\t\t\t\t$node.parent().prev().prev().prev().find(\"td > [data-nodeid]\").each(function(index) {\n\t\t\t\t\tif (index == i) {\n\t\t\t\t\t\tcheckSystem = $(this).attr(\"id\").replace(\"node\", \"\");//$(this).data(\"nodeid\");\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif ($.map(map.rows, function(node) { return node.c[1].v == checkSystem ? node : null; }).length <= 0) {\n\t\t\t\t\tnewparentIndex--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentIndex = newparentIndex;\n\n\t\t\t// Apply to parent bottom line\n\t\t\tvar $connecte = addModes($($node.parent().prev().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[parentIndex]), [ 'left', 'right'] );\n\n\t\t\t// the beans\n\t\t\tvar col = 0, parent = false, me = false;\n\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index, value) {\n\t\t\t\tcol += this.colSpan;\n\n\t\t\t\tif (me && parent) {\n\t\t\t\t\t// All done - get outta here\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (typeof($connecte[0]) != \"undefined\" && $connecte[0].cellIndex == index) {\n\t\t\t\t\tparent = true;\n\n\t\t\t\t\taddModes($(this), ['left']);\n\n\t\t\t\t\t// remove bottom border that points to the right\n\t\t\t\t\tif (!me && col != nodeCol) {\n\t\t\t\t\t\taddModes($(this), ['bottom']);\n\t\t\t\t\t}\n\n\t\t\t\t\t// parent and node are same - we are done\n\t\t\t\t\tif (nodeCol == col) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else if (col == nodeCol) {\n\t\t\t\t\tme = true;\n\n\t\t\t\t\taddModes($(this), [ 'bottom' ]);\n\t\t\t\t} else if (me || parent) {\n\t\t\t\t\tvar tempCol = 0, breaker = false, skip = false;\n\n\t\t\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\n\t\t\t\t\t\ttempCol += this.colSpan;\n\n\t\t\t\t\t\tif (tempCol == col && ($(this).hasClass(\"google-visualization-orgchart-lineleft\") || $(this).hasClass(\"google-visualization-orgchart-lineright\"))) {\n\t\t\t\t\t\t\tif (parent == false) {\n\t\t\t\t\t\t\t\t// Stop looking cuz there is another node between us and parent\n\t\t\t\t\t\t\t\tbreaker = true;\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t} else if (parent == true) {\n\t\t\t\t\t\t\t\t// Lets make sure there isnt a node between the parent and me\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\n\n\t\t\t\t\t\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index) {\n\t\t\t\t\t\t\t\t\tif (index >= $connecte[0].cellIndex) {\n\t\t\t\t\t\t\t\t\t\t// there is a node after parent but before me\n\t\t\t\t\t\t\t\t\t\tremoveModes($(this), [ 'bottom' ]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tskip = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (breaker) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!skip) {\n\t\t\t\t\t\taddModes($(this), ['bottom'] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfor (var x in lines) {\n\t\t\tdrawNodeLine(lines[x][0], lines[x][1], lines[x][2], lines[x][3]);\n\t\t}\n\t};\n\n\tthis.collapseHandler = function() {\t\t\n\t\tif(_this.drawing) { return; }\n\t\t\n\t\tconst collapsed = _this.map.getCollapsedNodes();\n\t\tconst collapsedSystems = [];\n\t\tfor (x in collapsed) {\n\t\t\tvar systemID = $(\"#chainMap #node\"+(collapsed[x] +1)).data(\"nodeid\");\n\t\t\tcollapsedSystems.push(systemID);\n\t\t}\n\t\towner.updateCollapsed(collapsedSystems);\n\t\t\n\t\tif(_this.lastLineData) { updateLines(_this.lastLineData.map, _this.lastLineData.lines); }\n\t}\n\n\n};","const ChainMapRendererRadial = function(owner) {\n\t/** Is this renderer ready to accept draw calls? */\n\tthis.ready = function() { return !this.drawing; }\n\t\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\n\tthis.switchTo = function() {\n\t\tif(!document.getElementById('map-container')) {\n\t\t\tconst newDiv = document.createElement('div');\n\t\t\tnewDiv.id = 'map-container';\n\t\t\tnewDiv.className = 'radial-map';\n\t\t\tdocument.getElementById('chainMap').appendChild(newDiv);\n\t\t}\n\t\tthis.container = document.getElementById('map-container');\n\t\tthis.container.style.display = '';\n\t}\n\t\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\n\tthis.switchFrom = function() {\n\t\tconst div = document.getElementById('map-container');\n\t\tif(div) { div.parentNode.removeChild(div); }\n\t\tthis.container = null;\n\t}\n\t\n\tthis.collapse = function(systemID, collapse) {\n\t\tif(collapse) { this.mapData.collapsed.push(systemID); }\n\t\telse {  this.mapData.collapsed = this.mapData.collapsed.filter(x => x != systemID); }\n\t\towner.updateCollapsed(this.mapData.collapsed);\n\t\tdrawInner(this.mapData.map, this.mapData.lines, this.mapData.collapsed);\n\t}\n\t\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\n\tthis.draw = function(map, lines, collapsed) {\n\t\tthis.drawing = true;\n\t\tthis.mapData = {map: map, lines: lines, collapsed: collapsed};\n\t\t\n\t\t// Clear the map for a new one\n\t\t//this.switchFrom(); this.switchTo();\n\n\t\ttry { drawInner(map, lines, collapsed); }\n\t\tfinally { this.drawing = false; }\n\t}\n\t\n\tconst CIRCLE_SIZE = { x: 70, y: 60, first_ring_delta: 0.3,\n\t\tringX: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.x},\n\t\tringY: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.y},\n\t };\n\n\tconst _this = this;\n\tconst drawInner = function(map, lines, collapsed) {\n\t\tconst maps = [];\n\t\tconst nodesById = {};\n\t\t\n\t\t// First pass: arrange nodes into rings\n\t\tfor(var ri = 0; ri < map.rows.length; ri++) {\n\t\t\tconst item = map.rows[ri];\n\t\t\tconst inNode = item.c[0], id = inNode.v, parent = item.c[1].v;\n\t\t\t\n\t\t\tconst mapNode = { id: id, children: [], systemID: inNode.systemID, minArc: 0 };\n\t\t\t\n\t\t\tif(parent == null) {\n\t\t\t\tconst newMap =  { circles: [ { arc: 0, nodes: [ mapNode ] } ] };\n\t\t\t\tmapNode.map = newMap;\n\t\t\t\tmapNode.circle = 0;\n\t\t\t\tmaps.push(newMap);\n\t\t\t} else {\n\t\t\t\tconst parentNode = nodesById[parent];\n\t\t\t\tif(!parentNode) { throw 'Parent id ' + parent + ' not on map yet'; }\n\t\t\t\tparentNode.children.push(mapNode);\n\t\t\t\tmapNode.parent = parentNode;\n\t\t\t\tmapNode.connection = lines.filter(function(l) { return l[0] == id; })[0] || [id, parent, [], '?'];\n\t\t\t\tmapNode.connection[2].unshift('connection');\n\t\t\t\tmapNode.map = parentNode.map;\n\t\t\t\tmapNode.circle = parentNode.circle + 1;\n\t\t\t\tif(mapNode.map.circles.length <= mapNode.circle) {\n\t\t\t\t\tmapNode.map.circles.push({ arc: 0, nodes:[mapNode] });\n\t\t\t\t} else { mapNode.map.circles[mapNode.circle].nodes.push(mapNode); }\n\t\t\t}\n\t\t\tnodesById[id] = mapNode;\n\t\t\tmapNode.markup = inNode.f;\n\t\t}\n\n\t\t// Second pass - for each map, find the allocation of arc needed for each node\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\n\t\t\tconst map = maps[mi];\n\t\t\tfor(var ci = map.circles.length - 1; ci >= 1; ci--) {\t// don't need to calculate ring 0\n\t\t\t\tfor(var ni = 0; ni < map.circles[ci].nodes.length; ni++) {\n\t\t\t\t\tconst node = map.circles[ci].nodes[ni];\n\t\t\t\t\tnode.minArc *= ci / (ci + 1.0);\n\t\t\t\t\tif(node.minArc < 1 || collapsed.indexOf(node.systemID * 1) >= 0) { node.minArc = 1; }\n\t\t\t\t\tnode.parent.minArc += node.minArc;\n\t\t\t\t\tmap.circles[ci].arc += node.minArc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Third pass - lay out each ring based on the arc values\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\n\t\t\tconst map = maps[mi];\n\t\t\tvar mapDiv = document.getElementById(\"map\" + mi);\n\t\t\tif(!mapDiv) {\n\t\t\t\tmapDiv = document.createElement('div');\n\t\t\t\tmapDiv.id = \"map\" + mi;\n\t\t\t\tmapDiv.className = \"map-chain-wrapper\";\n\t\t\t}\n\t\t\tmapDiv.innerHTML = '<div class=\"map-outer-container\"><div class=\"map-inner-container\"><canvas class=\"map-drawing\" id=\"map-canvas-' + mi + '\"/></div></div>';\n\t\t\tconst innerContainer = mapDiv.firstChild.firstChild;\n\t\t\tdocument.getElementById('map-container').appendChild(mapDiv);\n\n\t\t\tmap.bounds = makeDivsForRing(innerContainer, 0, map.circles[0].nodes, 0, Math.PI * 2, collapsed);\n\t\t\tmap.domNode = mapDiv;\n\t\t\tmap.innerContainer = innerContainer;\n\t\t}\n\n\t\t// Fourth pass: update div and canvas bounds, and draw rings/links\n\t\tconst CANVAS_SCALE = 1;\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\n\t\t\tconst map = maps[mi];\n\t\t\tconst finalPositions = {\n\t\t\t\tw: 200 + map.bounds.x[1] - map.bounds.x[0],\n\t\t\t\th: 100 + map.bounds.y[1] - map.bounds.y[0],\n\t\t\t\tcx: 100 - map.bounds.x[0],\n\t\t\t\tcy: 50 - map.bounds.y[0]\n\t\t\t}\n\t\t\t\n\t\t\t// Fill the space available, if we didn't already\n\t\t\tif(maps.length == 1) {\n\t\t\t\tconst parentWidth = -38 + _this.container.offsetWidth;\t// 20px for map margins, 18 for scrollbar\n\t\t\t\tif(finalPositions.w < parentWidth) {\n\t\t\t\t\tfinalPositions.cx += 0.5 * (parentWidth - finalPositions.w);\n\t\t\t\t\tfinalPositions.w = parentWidth;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\tconst parentHeight = document.getElementById('chainParent').offsetHeight;\n\t\t\tif(finalPositions.h < parentHeight) {\n\t\t\t\tfinalPositions.cy += 0.5 * (parentHeight - finalPositions.h);\n\t\t\t\tfinalPositions.h = parentHeight;\n\t\t\t}\n\t\t\t\n\t\t\t// If there's enough space to centre the top level node now, do it\n\t\t\tif(finalPositions.h >= 2 * (map.bounds.y[1] > -map.bounds.y[0] ? map.bounds.y[1] : -map.bounds.y[0])) {\n\t\t\t\tfinalPositions.cy = finalPositions.h / 2;\n\t\t\t}\n\t\t\tif(finalPositions.w >= 2 * (map.bounds.x[1] > -map.bounds.x[0] ? map.bounds.x[1] : -map.bounds.x[0])) {\n\t\t\t\tfinalPositions.cx = finalPositions.w / 2;\n\t\t\t}\t\t\t\n\t\t\tmap.domNode.style.width = finalPositions.w + 'px';\n\t\t\tmap.domNode.style.height = finalPositions.h + 'px';\n\t\t\tconst outerContainer = map.domNode.firstChild;\n\t\t\touterContainer.style.left = finalPositions.cx + 'px';\n\t\t\touterContainer.style.top = finalPositions.cy + 'px';\n\t\t\tconst canvas = outerContainer.getElementsByTagName('canvas')[0];\n\t\t\tcanvas.width = CANVAS_SCALE * finalPositions.w;\n\t\t\tcanvas.style.width = finalPositions.w + 'px';\n\t\t\tcanvas.height = CANVAS_SCALE * finalPositions.h;\n\t\t\tcanvas.style.height = finalPositions.h + 'px';\n\t\t\tcanvas.style.left = -finalPositions.cx + 'px';\n\t\t\tcanvas.style.top = -finalPositions.cy + 'px';\n\t\t\tconst ctx = canvas.getContext('2d');\n\t\t\tctx.scale(CANVAS_SCALE, CANVAS_SCALE);\n\t\t\tctx.translate(finalPositions.cx, finalPositions.cy);\n\t\t\t\t\n\t\t\tfor(var ci = map.bounds.maxCi; ci >= 1; ci--) {\t// don't need to draw ring 0\n\t\t\t\tif(options.chain.gridlines) {\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tif(ctx.ellipse) {\n\t\t\t\t\t\tctx.lineWidth = 0.5;\n\t\t\t\t\t\tctx.setLineDash([]);\n\t\t\t\t\t\tctx.ellipse(0, 0, CIRCLE_SIZE.ringX(ci), CIRCLE_SIZE.ringY(ci), 0, 0, Math.PI * 2);\n\t\t\t\t\t}\n\t\t\t\t\tctx.strokeStyle = propertyFromCssClass('grid-default', 'color');\n\t\t\t\t\tctx.stroke();\t\t\n\t\t\t\t}\n\t\t\t\tif(ci >= map.circles.length) { continue; }\n\t\t\t\t\n\t\t\t\tfor(var ni = 0; ni < map.circles[ci].nodes.length; ni++) {\n\t\t\t\t\tconst node = map.circles[ci].nodes[ni];\n\t\t\t\t\tif(!node.position) { continue; }\t// not drawn on map\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineWidth = node.connection[2].reduce(function(w, c) { return c == 'frig' ? 1 : w; }, 3);\n\t\t\t\t\tctx.moveTo(node.position.x, node.position.y);\n\t\t\t\t\tconst cp1 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (node.radPosition.theta + 2 * node.parent.radPosition.theta) / 3.0 });\n\t\t\t\t\tconst cp2 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (2 * node.radPosition.theta + node.parent.radPosition.theta) / 3.0 });\n\t\t\t\t\t\n\t\t\t\t\tif(ci > 1) {\t\t\t\t\n\t\t\t\t\t\tctx.bezierCurveTo(cp2.x, cp2.y, cp1.x, cp1.y, node.parent.position.x, node.parent.position.y);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctx.lineTo(node.parent.position.x, node.parent.position.y);\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\tconst dist2 = (node.position.y - node.parent.position);\n\t\t\t\t\tctx.strokeStyle = propertyFromCssClass(node.connection[2], 'border-top-color');\n\t\t\t\t\tctx.setLineDash ({ dashed: [3, 2] }[propertyFromCssClass(node.connection[2], 'border-top-style')] || []);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\t\t\n\t\t// Remove any maps which aren't in use any more\n\t\tfor(var mi = maps.length; ; mi++) {\n\t\t\tconst div = document.getElementById('map' + mi);\n\t\t\tif(div) { div.parentNode.removeChild(div); }\n\t\t\telse { break; }\n\t\t}\n\t}\n\t\n\tfunction makeDivsForRing(innerContainer, ci, nodes, minRad, maxRad, collapsed) {\n\t\tconst bounds = { x: [0, 0], y: [0, 0], maxCi: ci };\n\t\tif(!nodes.length) { return bounds; }\n\t\tconst parentCollapsed = collapsed.indexOf(1 * (nodes[0].parent || {}).systemID) >= 0;\n\t\tconst max_nodes_per_rad = 1.4;\n\t\tif(ci > 0 && !parentCollapsed) {\n\t\t\tvar skipped = 0;\n\t\t\twhile(++skipped < 2 && nodes.length > max_nodes_per_rad * ci * (maxRad - minRad)) { ci++; }\n\t\t}\n\t\tconst totalArc = parentCollapsed ? nodes.length : nodes.reduce(function(acc, x) { return acc + x.minArc; }, 0);\n\t\tconst rads_per_arc = (maxRad - minRad) / totalArc;\n\t\tvar rad_offset = minRad;\n\t\tvar alignment_delta = 0;\n\t\t\n\t\tfor(var ni = 0; ni < nodes.length; ni++) {\n\t\t\tconst node = nodes[ni];\t\n\t\t\t\n\t\t\t// Make the node\n\t\t\tconst frag = document.createRange().createContextualFragment('<div class=\"node-wrapper\">' + node.markup + '</div>');\n\t\t\tnode.domNode = frag.firstChild;\n\t\t\tinnerContainer.appendChild(node.domNode);\n\t\t\tconst systemID = 1 * node.systemID;\n\t\t\t$(node.domNode).dblclick(() => _this.collapse(systemID, collapsed.indexOf(systemID) < 0));\n\t\t\t\n\t\t\t// Position the node\n\t\t\tconst dr = (parentCollapsed ? 1 : node.minArc) * rads_per_arc;\n\t\t\tconst rad_centre = rad_offset + (dr / 2);\n\t\t\t\n\t\t\tif(ci == 1 && ni == 0) { // First node on first ring should be axis aligned\n\t\t\t\talignment_delta -= rad_centre;\n\t\t\t}\n\t\t\t\n\t\t\tnode.radPosition = { r: ci, theta: rad_centre + alignment_delta };\n\t\t\tnode.position = radToCartesian(node.radPosition);\n\t\t\t\n\t\t\tif(node.position.x < bounds.x[0]) { bounds.x[0] = node.position.x; }\n\t\t\tif(node.position.x > bounds.x[1]) { bounds.x[1] = node.position.x; }\n\t\t\tif(node.position.y < bounds.y[0]) { bounds.y[0] = node.position.y; }\n\t\t\tif(node.position.y > bounds.y[1]) { bounds.y[1] = node.position.y; }\n\t\t\t\n\t\t\tnode.domNode.style.left = node.position.x + 'px';\n\t\t\tnode.domNode.style.top = node.position.y + 'px';\n\t\t\t\n\t\t\tif(parentCollapsed) {\n\t\t\t\tnode.domNode.style.display = 'none';\n\t\t\t} else {\t\t\t\t\n\t\t\t\t// Do the segment of the next circle\n\t\t\t\tconst excess = (ci > 0 && dr > node.minArc * ci) ? dr - node.minArc * ci : 0;\n\t\t\t\tif(node.children.length) {\n\t\t\t\t\tconst nextBounds = makeDivsForRing(innerContainer, ci + 1, node.children, rad_offset + (0.5 * excess) + alignment_delta, rad_offset - (0.5 * excess) + alignment_delta + dr, collapsed);\n\t\t\t\t\tif(nextBounds.x[0] < bounds.x[0]) { bounds.x[0] = nextBounds.x[0]; }\n\t\t\t\t\tif(nextBounds.x[1] > bounds.x[1]) { bounds.x[1] = nextBounds.x[1]; }\n\t\t\t\t\tif(nextBounds.y[0] < bounds.y[0]) { bounds.y[0] = nextBounds.y[0]; }\n\t\t\t\t\tif(nextBounds.y[1] > bounds.y[1]) { bounds.y[1] = nextBounds.y[1]; }\n\t\t\t\t\tif(nextBounds.maxCi > bounds.maxCi) { bounds.maxCi = nextBounds.maxCi; }\n\t\t\t\t}\n\t\t\t}\n\t\t\trad_offset += dr;\n\t\t}\n\t\t\n\t\treturn bounds;\n\t}\n\n\tfunction radToCartesian(rad) {\n\t\treturn { \n\t\t\tx: CIRCLE_SIZE.ringX(rad.r) * Math.sin(rad.theta), \n\t\t\ty: CIRCLE_SIZE.ringY(rad.r) * Math.cos(rad.theta)\n\t\t};\n\n\t}\n\n\t/** https://stackoverflow.com/questions/40978050 */\n\tfunction propertyFromCssClass(className, property) {\n\t\tif(Array.isArray(className)) { className = className.join(' '); }\n\t\tvar elem = document.getElementById('temp-div-' + className);\n\t\tif(!elem) {\n\t\t  elem = document.createElement(\"div\");\n\t\t  elem.id = 'temp-div-' + className;\n\t\t  elem.style.cssText = \"position:fixed;left:-100px;top:-100px;width:1px;height:1px\";\n\t\t  elem.className = className + ' temp';\n\t\t  document.body.appendChild(elem);  // required in some browsers\n\t\t  }\n\t  const color = getComputedStyle(elem).getPropertyValue(property);\n\t  //document.body.removeChild(tmp);\n\t  return color;\n\t}\t\n};","var chain = new function() {\n\tvar chain = this;\n\tthis.map, this.view, this.drawing, this.data = {};\n\t\n\tthirdPartySuppliers = [ thera ];\n\n\t// Renderer should have:\n\t//  ready() - Whether the renderer is initialised and can accept draw calls\n\t// switchTo() - Make this renderer active. The renderer can be in a blank state; draw() will be called after\n\t// switchFrom() - Switch away from this renderer. All node divs should be removed from the DOM, other items can be removed or made invisible\n\t// draw(map, lines, collapsedSystems) - Redraw the map, based on the given node set, line overrides and list of collapsed systems \n\t// collapse(systemID, toggle) - marks the system as collapsed/not collapsed\n\t// If the renderer allows collapsing of nodes then it will call updateCollapsed on the owner (the chain) with a list of collapsed systems in the current tab\n\t\n\tconst renderers = { \n\t\torgChart: new ChainMapRendererOrgchart(this),\n\t\tradial: new ChainMapRendererRadial(this)\n\t};\n\t\n\tthis.renderer = renderers[options.chain.renderer];\n\tthis.renderer.switchTo();\n\t\n\tthis.useRenderer = function(name) {\n\t\tif(!renderers[name]) { throw 'Unknown renderer ' + name; }\n\t\tif(this.renderer != renderers[name]) {\n\t\t\tthis.renderer.switchFrom();\n\t\t\tthis.renderer = renderers[name];\n\t\t\tthis.renderer.switchTo();\n\t\t\tthis.redraw();\n\t\t}\n\t}\n\n\tthis.activity = function(data) {\n\t\t/*\tfunction for adding recent activity to chain map nodes\t*/\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.activity;\n\n\t\t// Hide all activity colored dots instead of checking each one\n\t\tvar elements = document.querySelectorAll(\"#chainMap .nodeActivity span\");\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\n\t\t   elements[i].className = elements[i].className + \" invisible\";\n\t\t}\n\n\t\t// Loop through passed data and show dots by system\n\t\tvar elements = document.querySelectorAll(\"#chainMap [data-nodeid]\");\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\n\t\t   var systemID = elements[i].getAttribute(\"data-nodeid\");\n\t\t   if (data[systemID]) {\n\t\t\t   var shipJumps = data[systemID].shipJumps;\n\t\t\t   var podKills = data[systemID].podKills;\n\t\t\t   var shipKills = data[systemID].shipKills;\n\t\t\t   var npcKills = data[systemID].npcKills;\n\t\t\t   var node = elements[i].getElementsByClassName(\"nodeActivity\")[0];\n\n\t\t\t   if (shipJumps > 0) {\n\t\t\t\t   var jumps = node.getElementsByClassName(\"jumps\")[0];\n\t\t\t\t   jumps.className = jumps.className.replace(/invisible/g, \"\");\n\t\t\t\t   jumps.setAttribute(\"data-tooltip\", shipJumps + \" Jumps\");\n\t\t\t   }\n\n\t\t\t   if (podKills > 0) {\n\t\t\t\t   var pods = node.getElementsByClassName(\"pods\")[0];\n\t\t\t\t   pods.className = pods.className.replace(/invisible/g, \"\");\n\t\t\t\t   pods.setAttribute(\"data-tooltip\", podKills + \" Pod Kills\");\n\t\t\t   }\n\n\t\t\t   if (shipKills > 0) {\n\t\t\t\t   var ships = node.getElementsByClassName(\"ships\")[0];\n\t\t\t\t   ships.className = ships.className.replace(/invisible/g, \"\");\n\t\t\t\t   ships.setAttribute(\"data-tooltip\", shipKills + \" Ship Kills\");\n\t\t\t   }\n\n\t\t\t   if (npcKills > 0) {\n\t\t\t\t   var npcs = node.getElementsByClassName(\"npcs\")[0];\n\t\t\t\t   npcs.className = npcs.className.replace(/invisible/g, \"\");\n\t\t\t\t   npcs.setAttribute(\"data-tooltip\", npcKills + \" NPC Kills\");\n\t\t\t   }\n\t\t   }\n\t\t}\n\n\t\tif (SystemActivityToolTips.attachedElements && SystemActivityToolTips.attachedElements.length > 0) {\n\t\t\tSystemActivityToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t}\n\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeActivity > span[data-tooltip]:not(.invisible)\"));\n\n\t\treturn data;\n\t}\n\n\tthis.occupied = function(data) {\n\t\t/*\tfunction for showing occupied icon  */\n\n\t\t// Hide all icons instead of checking each one\n\t\t$(\"#chainMap [data-icon='user'], #chainMap [data-icon='user'] + .badge\").addClass(\"invisible\");\n\n\t\t// Loop through passed data and show icons\n\t\tfor (var x in data) {\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user']\").removeClass(\"invisible\");\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user'] + .badge\").removeClass(\"invisible\").html(data[x].count);\n\t\t}\n\n\t\tOccupiedToolTips.attach($(\"#chainMap [data-icon='user']:not(.invisible)\"));\n\n\t\treturn data;\n\t}\n\n\tthis.flares = function(data) {\n\t\t/*\tfunction for coloring chain map nodes via flares  */\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.flares;\n\n\t\t// Remove all current node coloring instead of checking each one\n\t\t$(\"#chainMap div.node\").removeClass(\"redNode yellowNode greenNode\");\n\n\t\t// Remove all coloring from chain grid\n\t\t$(\"#chainGrid tr\").removeClass(\"red yellow green\");\n\n\t\t// Loop through passed data and add classes by system\n\t\tif (data) {\n\t\t\tfor (var x in data.flares) {\n\t\t\t\tvar systemID = data.flares[x].systemID;\n\t\t\t\tvar flare = data.flares[x].flare;\n\n\t\t\t\tvar row = ($(\"#chainMap [data-nodeid=\"+systemID+\"]\").addClass(flare+\"Node\").parent().index() - 1) / 3 * 2;\n\n\t\t\t\tif (row > 0) {\n\t\t\t\t\t$(\"#chainGrid tr:eq(\"+row+\")\").addClass(flare).next().addClass(flare);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tthis.grid = function() {\n\t\t/*  function for showing/hiding grid lines  */\n\t\t// This is an optional feature\n\t\tif (options.chain.gridlines == false) {\n\t\t\t$(\"#chainGrid tr\").addClass(\"hidden\");\n\t\t\treturn false;\n\t\t}\n\n\t\t$(\"#chainGrid tr\").removeClass(\"hidden\");\n\t\t//$(\"#chainGrid\").css(\"width\", \"100%\");\n\n\t\t// Calculate how many rows have systems, max 0 hack to prevent negative numbers, and rows above this number get hidden\n\t\tvar rows = Math.max(0, $(\".google-visualization-orgchart-table tr:has(.node)\").length * 2 - 1);\n\t\t$(\"#chainGrid tr:gt(\"+rows+\")\").addClass(\"hidden\");\n\t}\n\n\tthis.nodes = function(map) {\n\t\tvar chain = {cols: [{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}], rows: []};\n\t\tvar frigTypes = [\"Q003\", \"E004\", \"L005\", \"Z006\", \"M001\", \"C008\", \"G008\", \"A009\", \"SML\" ];\n\t\tvar connections = [];\n\t\tvar chainMap = this;\n\n\t\tfunction formatStatics(statics) {\n\t\t\tif(!statics) { return ''; }\n\t\t\tconst shortCodeMap = { 'High-Sec': 'H', 'Low-Sec': 'L', 'Null-Sec': 'N', 'Triglavian':'▼',\n\t\t\t\t'Class 1': '1', 'Class 2': '2', 'Class 3': '3', 'Class 4': '4', 'Class 5' : 5, 'Class 6': 6\n\t\t\t};\n\t\t\tconst classMap = { H: 'hisec', L: 'lowsec', N: 'nullsec', '▼': 'triglavian' };\n\t\t\treturn statics.map(function(s) {\n\t\t\t\tconst text = shortCodeMap[tripwire.wormholes[s].leadsTo];\n\t\t\t\tconst className = classMap[text] || 'class-' +  text;\n\t\t\t\tconst tip = tripwire.wormholes[s].leadsTo + ' via ' + s;\n\t\t\t\treturn '<span class=\"' + className + '\" data-tooltip=\"' + tip + '\">' + text + '</span>';\n\t\t\t}).join('');\n\t\t}\n\n\t\tfunction topLevel(systemID, id) {\n\t\t\tif (!systemID || !tripwire.systems[systemID])\n\t\t\t\treturn false;\n\t\t\tconst tab = options.chain.tabs[options.chain.active];\n\t\t\tconst tabName = tab && tab.systemID != 0 && 0 > tab.systemID.indexOf(',') ? options.chain.tabs[options.chain.active].name : undefined;\n\t\t\treturn makeSystemNode(systemID, id, null, null, tabName, '&nbsp;', ['top-level']);\n\t\t}\n\n\t\tfunction makeSystemNode(systemID, id, whId, inSigId, systemName, nodeTypeMarkup, additionalClasses) {\n\t\t\t// System type switch\n\t\t\tvar systemType = getSystemType(systemID);\n\t\t\tconst system = tripwire.systems[systemID];\n\n\t\t\tvar effectClass = null, effect = null;\n\t\t\tif (system && system.effect) {\n\t\t\t\tswitch(system.effect) {\n\t\t\t\t\tcase \"Black Hole\":\n\t\t\t\t\t\teffectClass = \"blackhole\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Cataclysmic Variable\":\n\t\t\t\t\t\teffectClass = \"cataclysmic-variable\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Magnetar\":\n\t\t\t\t\t\teffectClass = \"magnetar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Pulsar\":\n\t\t\t\t\t\teffectClass = \"pulsar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Red Giant\":\n\t\t\t\t\t\teffectClass = \"red-giant\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Wolf-Rayet Star\":\n\t\t\t\t\t\teffectClass = \"wolf-rayet\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\teffect = system.effect;\n\t\t\t}\n\t\t\t\n\t\t\tsystemName = _.escape(systemName);\n\t\t\tconst systemNameText = \n\t\t\t\toptions.chain.sigNameLocation == 'name' ? (systemName ? systemName : system ? system.name : '&nbsp;') :\n\t\t\t\toptions.chain.sigNameLocation == 'name_prefix' ?\n\t\t\t\t\t(systemName ? systemName + (system ? ' - ' + system.name : '') : (system ? system.name : '&nbsp;')) :\n\t\t\t\t(system ? system.name : '&nbsp;');\t\n\n\t\t\tvar node = {v: id, systemID: systemID };\n\t\t\tvar chainNode = \"<div id='node\"+id+\"' data-nodeid='\"+systemID+\"'\"\n\t\t\t\t+(whId ? \" data-sigid='\"+whId+\"'\" : '')\n\t\t\t\t+(inSigId ? \" data-inSigid='\"+inSigId+\"'\" : '')\n\t\t\t\t+\" class='node \" + ((additionalClasses || []).join(' ')) + \"'>\"\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i class='whEffect' \"+(effectClass ? \"data-icon='\"+effectClass+\"' data-tooltip='\"+effect+\"'\" : null)+\"></i>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge invisible'></span>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+systemType+\"</h4>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\n\t\t\t\t\t\t\t+\t\t(system ? \"<a href='.?system=\"+system.name+\"'>\"+systemNameText+\"</a>\" : systemNameText)\n\t\t\t\t\t\t\t+\t\"</h4>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>\" + nodeTypeMarkup + \"</h4>\"\n\t\t\t\t\t\t\t+\t\"<div class='statics'>\"\n\t\t\t\t\t\t\t+ formatStatics(system ? system.statics : [])\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\"</div>\";\n\n\t\t\tnode.f = chainNode;\n\n\t\t\treturn node;\n\t\t}\n\t\t\n\t\tfunction makeCalcChildNode(childID, node, targetSystem) {\n\t\t\tvar path = guidance.findShortestPath(tripwire.map.shortest, [targetSystem - 30000000, node.child.systemID - 30000000]);\n\t\t\tif(!path) { return null; }\n\t\t\t\n\t\t\tvar calcNode = { calculated: true};\n\t\t\tcalcNode.life = \"Gate\";\n\t\t\tcalcNode.parent = {};\n\t\t\tcalcNode.parent.id = node.child.id;\n\t\t\tcalcNode.parent.systemID = node.child.systemID;\n\t\t\tcalcNode.parent.name = node.child.name;\n\t\t\tcalcNode.parent.type = node.child.type;\n\t\t\tcalcNode.parent.nth = node.child.nth;\n\n\t\t\tcalcNode.child = {};\n\t\t\tcalcNode.child.id = ++childID;\n\t\t\tcalcNode.child.systemID = targetSystem;\n\t\t\tcalcNode.child.name = tripwire.systems[targetSystem].name;\n\t\t\tcalcNode.child.path = path;\n\t\t\tcalcNode.child.jumps = path.length - 1;\n\t\t\tcalcNode.child.nth = null;\t\t\t\n\t\t\t\n\t\t\treturn { childID, calcNode };\n\t\t}\n\t\t\n\t\tfunction getSystemType(systemID) {\n\t\t\tvar system = systemAnalysis.analyse(systemID);\n\t\t\tif(!system) { \n\t\t\t\tvar leadsToPointer = typeof(systemID) === \"string\" && systemID.indexOf(\"|\") >= 0 ? tripwire.aSigSystems[systemID.substring(0, systemID.indexOf(\"|\"))] : null;\n\t\t\t\tconst nodeClass = \n\t\t\t\t\tleadsToPointer && leadsToPointer.substring(0, 6) == 'Class-' ? 1 * leadsToPointer.substring(6) :\n\t\t\t\t\tundefined;\n\t\t\t\tconst nodeSecurity = \n\t\t\t\t\tleadsToPointer == \"High-Sec\" ? 0.8 :\n\t\t\t\t\tleadsToPointer == \"Low-Sec\" ? 0.4 :\n\t\t\t\t\tleadsToPointer == \"Null-Sec\" ? -0.1 :\n\t\t\t\t\tundefined;\n\t\t\t\tconst nodeFaction = \n\t\t\t\t\tleadsToPointer == \"Triglavian\" ? 500026 :\n\t\t\t\t\tundefined;\n\t\t\t\t\n\t\t\t\tsystem = systemAnalysis.analyse(systemID, { security: nodeSecurity, class: nodeClass, factionID: nodeFaction } );\n\t\t\t}\n\t\t\treturn \"<span class='\" + system.systemTypeClass + \"'>\" + system.systemTypeName + system.systemTypeModifiers.join('') + \"</span>\";\n\t\t}\t\t\n\n\t\tfunction findLinks(system) {\n\t\t\tif (system[0] <= 0) return false;\n\n\t\t\tvar parentID = parseInt(system[1]), childID = chainList.length;\n\t\t\tconst connectedTo = [];\t// Local cache, in addition to usedLinks, for extra link sources\n\n\t\t\t/** Add the 'current' and 'favourite' calculated nodes if appropriate */\n\t\t\tconst addCalcChildNodes = function(node) {\n\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class && viewingSystemID != node.child.systemID ) {\n\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, viewingSystemID);\n\t\t\t\t\tif(calcNode) {\n\t\t\t\t\t\tchildID = calcNode.childID;\n\n\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\n\t\t\t\t\t\tchainList.push([0, childID]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[node.child.systemID].class) {\n\t\t\t\t\tfor (var x in options.favorites) {\n\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000 || options.favorites[x] == node.child.systemID)\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, options.favorites[x]);\n\t\t\t\t\t\tif(calcNode) {\n\t\t\t\t\t\t\tchildID = calcNode.childID;\n\n\t\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\n\t\t\t\t\t\t\tchainList.push([0, childID]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\t\n\t\t\t};\n\n\t\t\tfor (var x in chainData) {\n\t\t\t\tvar wormhole = chainData[x];\t\t\t\t\n\t\t\t\tif ($.inArray(wormhole.id, usedLinks) == -1) {\n\t\t\t\t\tvar sig1, sig2, sig1Type, sig2Type,\n\t\t\t\t\t\tparent, child, parentType, childType;\n\t\t\t\t\tif (wormhole.parent == \"secondary\") {\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.secondaryID];\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.secondaryID];\n\t\t\t\t\t}\n\t\t\t\t\tsig1Type = wormhole.type; sig2Type = 'K162';\n\t\t\t\t\t\n\t\t\t\t\tif (sig1 && sig1.systemID == system[0]) {\n\t\t\t\t\t\tparent = sig1; child = sig2;\n\t\t\t\t\t\tparentType = sig2Type; childType = sig1Type;\n\t\t\t\t\t} else if(sig2 && sig2.systemID == system[0]) {\n\t\t\t\t\t\tparent = sig2; child = sig1;\n\t\t\t\t\t\tchildType = sig2Type; parentType = sig1Type;\n\t\t\t\t\t} else { continue; }\n\t\t\t\t\t\n\t\t\t\t\tvar node = {};\n\t\t\t\t\tnode.id = wormhole.id;\n\t\t\t\t\tnode.life = wormhole.life;\n\t\t\t\t\tnode.mass = wormhole.mass;\n\t\t\t\t\tnode.time = parent.modifiedTime;\n\n\t\t\t\t\tnode.parent = {};\n\t\t\t\t\tnode.parent.id = parentID;\n\t\t\t\t\tnode.parent.systemID = tripwire.systems[parent.systemID] ? parent.systemID : parent.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\n\t\t\t\t\tnode.parent.name = parent.name;\n\t\t\t\t\tnode.parent.type = parentType;\n\t\t\t\t\tnode.parent.typeBM = null;\n\t\t\t\t\tnode.parent.classBM = null;\n\t\t\t\t\tnode.parent.nth = null;\n\t\t\t\t\tnode.parent.signatureID = child.signatureID;\n\t\t\t\t\tnode.parent.sigIndex = child.id;\n\n\t\t\t\t\tnode.child = {};\n\t\t\t\t\tnode.child.id = ++childID;\n\t\t\t\t\tnode.child.systemID = tripwire.systems[child.systemID] ? child.systemID : child.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\n\t\t\t\t\tnode.child.name = child.name;\n\t\t\t\t\tnode.child.type = childType;\n\t\t\t\t\tnode.child.typeBM = null;\n\t\t\t\t\tnode.child.classBM = null;\n\t\t\t\t\tnode.child.nth = null;\n\t\t\t\t\tnode.child.signatureID = parent.signatureID;\n\t\t\t\t\tnode.child.sigIndex = parent.id;\n\n\t\t\t\t\tchainLinks.push(node);\n\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\n\t\t\t\t\tusedLinks.push(node.id);\n\t\t\t\t\tif(tripwire.systems[child.systemID]) { connectedTo.push(1 * child.systemID); }\t// cast to number - sigs have the system as a string\n\t\t\t\t\t// usedLinks[system[2]].push(node.id);\n\t\t\t\t\t\n\t\t\t\t\taddCalcChildNodes(node);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthirdPartySuppliers.forEach(function(supplier) {\t\t\t\t\n\t\t\t\tconst ids = { parentID: parentID, nextChildID: ++childID };\n\t\t\t\tconst supplierNodes = supplier.findLinks(1 * system[0], ids);\n\t\t\t\tif(!supplierNodes) { return; }\n\t\t\t\tchildID = ids.nextChildID - 1;\n\n\t\t\t\tfor(var ti = 0; ti < supplierNodes.length; ti++) {\n\t\t\t\t\tvar supplierNode = supplierNodes[ti];\n\t\t\t\t\tif(0 > usedLinks.indexOf(supplierNode.id)) {\n\t\t\t\t\t\tif(0 > connectedTo.indexOf(supplierNode.child.systemID)) { // not in our map already\n\t\t\t\t\t\t\tsupplierNode.thirdParty = supplier.nodeNameSuffix;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tchainLinks.push(supplierNode);\n\t\t\t\t\t\t\tchainList.push([supplierNode.child.systemID, supplierNode.child.id, system[2]]);\n\t\t\t\t\t\t\tconnectedTo.push(supplierNode.child.systemID);\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\taddCalcChildNodes(supplierNode);\t\t\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\n\t\t\t\t\t\t// Always want to do this, even if we didn't add it, because in that case the link is overridden by one on this mask, so it is 'used' even if not made visible\n\t\t\t\t\t\tusedLinks.push(supplierNode.id);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tif ($(\"#chainTabs .current\").length > 0) {\n\t\t\tvar systems = $(\"#chainTabs .current .name\").data(\"tab\").toString().split(\",\");\n\t\t\tvar chainList = [];\n\t\t\tvar chainData = map;\n\t\t\tvar chainLinks = [];\n\t\t\tvar usedLinks = [];\n\n\t\t\tif (systems == 0) {\n                                let i = 0;\n                                Object.keys(map).slice()/*.reverse()*/.forEach(x => {\n\t\t\t\t        const parent = tripwire.client.signatures[map[x].initialID];\n\t\t\t\t        const child = tripwire.client.signatures[map[x].secondaryID];\n                                        if (parent && tripwire.systems[parent.systemID] && typeof(tripwire.systems[parent.systemID].class) == \"undefined\") {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\t// usedLinks[parent.systemID] = [];\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(parent.systemID, i), {v: null}]});\n\t\t\t\t\t\tchainList.push([parent.systemID, i, parent.systemID]);\n                                        } else if (child && tripwire.systems[child.systemID] && typeof(tripwire.systems[child.systemID].class) == \"undefined\") {\n\t\t\t\t  \t        i++;\n\t\t\t\t  \t\t// usedLinks[child.systemID] = [];\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(child.systemID, i), {v: null}]});\n\t\t\t\t\t\tchainList.push([child.systemID, i, child.systemID]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfor (var x in systems) {\n\t\t\t\t\t// usedLinks[systems[x]] = [];\n\t\t\t\t\tchain.rows.push({c: [topLevel(systems[x], parseInt(x) + 1), {v: null}]});\n\t\t\t\t\tchainList.push([systems[x], parseInt(x) + 1, systems[x]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < chainList.length; i++) {\n\t\t\t\tfindLinks(chainList[i]);\n\t\t\t}\n\t\t} else {\n\t\t\t$(\"#chainError\").hide();\n\n\t\t\tvar row = {c: []};\n\t\t\tvar systemID = viewingSystemID;\n\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\n\n\t\t\tchain.rows.push(row);\n\n\t\t\tvar chainList = [[systemID, 1]];\n\t\t\tvar chainData = map;\n\t\t\tvar chainLinks = [];\n\t\t\tvar usedLinks = [];\n\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\n\t\t\t\tfindLinks(chainList[i]);\n\t\t\t}\n\t\t}\n\n\t\tconst systemsInChainMap = {};\n\t\tfor (var x in chainLinks) {\n\t\t\tvar node = chainLinks[x];\n\t\t\tvar row = {c: []};\n\t\t\t\n\t\t\tconst sigText = options.chain[\"node-reference\"] == \"id\" ? (node.child.signatureID ? node.child.signatureID.substring(0, 3) : \"???\") :\n\t\t\t\t\t(node.child.type || \"(?)\") + sigFormat(node.child.typeBM, \"type\");\n\t\t\tconst nodeTypeMarkup = node.child.path ? \n\t\t\t\tchainMap.renderPath(node.child.path) :\n\t\t\t\t\"<a href='#' onclick='openSignatureDialog({data: { signature: \" + node.child.sigIndex + \", mode: \\\"update\\\" }}); return false;'>\" + _.escape(\n\t\t\t\t\tnode.parent.name && options.chain.sigNameLocation == 'ref' ? node.parent.name :\n\t\t\t\t\tnode.parent.name && options.chain.sigNameLocation == 'ref_prefix' ? node.parent.name + ' - ' + sigText :\n\t\t\t\t\tsigText\n\t\t\t\t) + '</a>';\n\t\t\tconst additionalClasses = node.calculated ? ['calc'] : systemsInChainMap[node.child.systemID] ? [ 'loop' ] : [];\n\t\t\tif(node.thirdParty) { additionalClasses.push('third-party', 'third-party-' + node.thirdParty); }\n\t\t\tvar modifiers = [];\t\t\t\n\t\t\tif (node.life == \"critical\") { modifiers.push('eol'); }\n\t\t\tif (node.mass == \"critical\") { modifiers.push('critical'); }\n\t\t\telse if (node.mass == \"destab\") { modifiers.push('destab'); }\n\t\t\t\n\t\t\tif($.inArray(node.parent.type, frigTypes) != -1 || $.inArray(node.child.type, frigTypes) != -1) { modifiers.push('frig'); }\n\t\t\t\n\t\t\tconst parentModifiers = (systemsInChainMap[node.parent.systemID] || { chainModifiers:[]}).chainModifiers;\n\t\t\trow.chainModifiers = modifiers.concat(parentModifiers);\n\t\t\t\n\t\t\trow.chainModifiers.forEach(function(cm) { modifiers.push(cm + '-chain')});\n\t\t\t\n\t\t\t// Update result set (rows/connections)\n\t\t\tconst child = makeSystemNode(node.child.systemID, node.child.id, node.id, node.child.sigIndex, node.parent.name, nodeTypeMarkup, additionalClasses.concat(modifiers));\n\n\t\t\tvar parent = {v: node.parent.id};\n\n\t\t\trow.c.push(child, parent);\n\t\t\tchain.rows.push(row);\n\t\t\tif(modifiers.length) { connections.push(Array(child.v, parent.v, modifiers, node.id)); }\n\t\t\t\n\t\t\tif(!node.calculated) { systemsInChainMap[node.child.systemID] = row; }\t// store for loops/chain modifiers\n\t\t}\n\n\t\t// Apply critical/destab line colors\n\t\tconnections.reverse(); // so we apply to outer systems first\n\n\t\t//this.data.map = chain;\n\t\t//this.data.lines = connections;\n\t\treturn {\"map\": chain, \"lines\": connections};\n\t}\n\n\tthis.renderPath = function(path) {\n\t\tif(path.length <= 1 || path.length > options.chain.routingLimit) { return '' + path.length - 1; }\n\t\telse {\n\t\t\tvar systemMarkup = path\n\t\t\t.slice(0, path.length - 1).reverse()\n\t\t\t.map(function(s) {\n\t\t\t\tconst systemID = 30000000 + 1 * s;\n\t\t\t\tconst system = systemAnalysis.analyse(systemID);\n\t\t\t\tconst securityClass = system.systemTypeClass;\n\t\t\t\treturn '<span class=\"' + securityClass + '\" data-tooltip=\"' + system.name + ' (' + system.security + ')\" onclick=\"tripwire.systemChange(' + systemID + ')\">' + system.pathSymbol + '</span>';\n\t\t\t});\n\t\t\tvar r = '<span class=\"path\">';\n\t\t\tfor(var i = 0; i < systemMarkup.length; i++) {\n\t\t\t\tif(i > 0 && 0 == i % 5) { r += '|'; }\n\t\t\t\t\n\t\t\t\tr += systemMarkup[i];\t\t\t\t \n\t\t\t}\n\t\t\treturn r + '</span>';\n\t\t}\n\t}\n\n\tthis.setActiveTab = function(newIndex) {\n\t\t$(\"#chainTabs .tab\").removeClass(\"current\");\n\t\toptions.chain.active = newIndex;\n\t\tif(newIndex != null) {\n\t\t\t$(\"#chainTabs .tab\").eq(newIndex).addClass('current');\n\t\t}\n\t\t\n\t\toptions.save();\n\t\tchain.redraw();\n\t\ttripwire.parse(tripwire.client, \"refresh\");\n\t}\n\n\tthis.redraw = function() {\n\t\tthis.useRenderer(options.chain.renderer);\n\t\t\n\t\tvar data = $.extend(true, {}, this.data);\n\t\tdata.map = $.extend(true, {}, data.rawMap);\n\n\t\tthis.draw(data);\n\t}\n\t\n\tvar drawRetryTimer = null;\n\n\tthis.draw = function(data) {\n\t\tvar data = typeof(data) !== \"undefined\" ? data : {};\n\t\tclearTimeout(drawRetryTimer);\n\n\t\t// We need to make sure Google chart is ready and we have signature data for this system before we begin, otherwise delay\n\t\tif (!this.renderer.ready() || (Object.size(data.map) && !tripwire.client.signatures)) {\n\t\t\tdrawRetryTimer = setTimeout(function() { chain.draw(data) }, 100);\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.map) {\n\t\t\tthis.drawing = true;\n\n\t\t\tthis.data.rawMap = $.extend(true, {}, data.map);\n\n\t\t\t// if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout == false)) {\n\t\t\t// \tif (options.masks.active != \"273.0\") {\n\t\t\t// \t\tfor (var i in data.map) {\n\t\t\t// \t\t\tif (data.map[i].mask == \"273.0\") {\n\t\t\t// \t\t\t\tdelete data.map[i];\n\t\t\t// \t\t\t}\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t\t// Sort so we keep the chain map order the same\n\t\t\tObject.sort(data.map, \"id\");\n\n\t\t\t$.extend(data, this.nodes(data.map)); // 250ms -> <100ms\n\t\t\t$.extend(this.data, data);\n\t\t\t\n\t\t\tconst collapsedSystems = options.chain.tabs[options.chain.active] ? (options.chain.tabs[options.chain.active].collapsed || []) : [];\n\n\t\t\tthis.renderer.draw(data.map, data.lines, collapsedSystems); // 150ms\n\t\t\t//this.map.draw(this.newView(data.map), this.options); // 150ms\n\n//\t\t\tthis.renderer.lines(data); // 300ms\n\t\t\tthis.grid(); // 4ms\n\n\t\t\t// Apply current system style\n\t\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\"); // 0.1ms\n\n\t\t\t// Remove old system effect tooltips and add current ones\n\t\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\n\t\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t\t}\n\t\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\")); // 0.30ms\n\t\t\tWormholeRouteToolTips.attach($(\"#chainMap .path span[data-tooltip]\"));\n\t\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeClass span[data-tooltip]\"));\n\n\t\t\tthis.drawing = false;\n\t\t}\n\n\t\t// Gather latest system activity\n\t\tif (!this.data.activity || new Date() > this.data.activity.expires) {\n\t\t\tdata.activity = {};\n\t\t\ttripwire.esi.universeJumps()\n\t\t\t\t.done(function(results, status, request) {\n\t\t\t\t\tdata.activity.expires = new Date(request.getResponseHeader(\"expires\"));\n\t\t\t\t\t$.each(results, function(x) {\n\t\t\t\t\t\tdata.activity[results[x].system_id] = {\n\t\t\t\t\t\t\tsystemID: results[x].system_id,\n\t\t\t\t\t\t\tshipJumps: results[x].ship_jumps\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(function() {\n\t\t\t\t\t return tripwire.esi.universeKills()\n\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t$.each(results, function(x) {\n\t\t\t\t\t\t\t\tif (data.activity[results[x].system_id]) {\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].podKills = results[x].pod_kills;\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].shipKills = results[x].ship_kills;\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].npcKills = results[x].npc_kills;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id] = {\n\t\t\t\t\t\t\t\t\t\tsystemID: results[x].system_id,\n\t\t\t\t\t\t\t\t\t\tpodKills: results[x].pod_kills,\n\t\t\t\t\t\t\t\t\t\tshipKills: results[x].ship_kills,\n\t\t\t\t\t\t\t\t\t\tnpcKills: results[x].npc_kills,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(function() {\n\t\t\t\t\tchain.data.activity = chain.activity(data.activity);\n\t\t\t\t});\n\t\t} else if (data.map) {\n\t\t\tchain.activity(this.data.activity);\n\t\t}\n\n\t\tif (data.occupied) { // 3ms\n\t\t\tthis.data.occupied = this.occupied(data.occupied);\n\t\t}\n\n\t\tif (data.flares) { // 20ms\n\t\t\tthis.data.flares = this.flares(data.flares);\n\t\t}\n\t}\n\n\tthis.updateCollapsed = function(collapsedSystems) {\n\t\tif (options.chain.tabs[options.chain.active]) {\n\t\t\toptions.chain.tabs[options.chain.active].collapsed = collapsedSystems;\n\t\t}\n\t\t\n\t\t// Apply current system style\n\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\");\n\n\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\n\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t}\n\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\"));\n\n\t\tchain.activity(chain.data.activity);\n\n\t\tchain.occupied(chain.data.occupied);\n\n\t\tchain.flares(chain.data.flares);\n\n\t\tchain.grid();\n\n\t\toptions.save();\n\t}\n\n}\n","tripwire.active = function(data) {\n    var editSigs = [];\n    var editComments = [];\n\n    for (var x in data) {\n        var activity = JSON.parse(data[x].activity);\n        editSigs.push(parseInt(activity.editSig));\n        editComments.push(parseInt(activity.editComment));\n\n        if (activity.editSig) {\n            $(\"#sigTable tr[data-id='\"+activity.editSig+\"']\")\n                //.attr('data-tooltip', sig.editing)\n                //.attr(\"title\", sig.editing)\n                .addClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#001b47\"}, 1000); //35240A - Yellow\n        }\n\n        if (activity.editComment && $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"'] .cke\").length > 0) {\n            $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"']\")\n                .addClass(\"editing\")\n                .find(\".commentStatus\").html(data[x].characterName + \" is editing\").fadeIn();\n        }\n    }\n\n    $(\"#sigTable tr.editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editSigs) == -1) {\n            $(\"#sigTable tr[data-id='\"+$(this).data(\"id\")+\"']\")\n                //.attr('data-tooltip', '')\n                //.removeAttr(\"title\")\n                .removeClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n        }\n    });\n\n    $(\"#commentWrapper .editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editComments) == -1) {\n            $(\"#commentWrapper .editing[data-id='\"+$(this).data(\"id\")+\"']\")\n                .removeClass(\"editing\")\n                .find(\".commentStatus\").fadeOut(function() {$(this).html(\"\")});\n        }\n    });\n}\n","// Hanldes adding to Signatures section\n// ToDo: Use native JS\ntripwire.addSig = function(add, option, disabled) {\n    var option = option || {};\n    var animate = typeof(option.animate) !== 'undefined' ? option.animate : true;\n    var disabled = disabled || false;\n    var wormhole = {};\n\n    if (add.type == \"wormhole\") {\n        var wormhole = Object.values(tripwire.client.wormholes).find(function (wh) { return wh.initialID == add.id || wh.secondaryID == add.id});\n        if (!wormhole) return false;\n        var otherSignature = add.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n        if (!otherSignature) return false;\n\n        if (add.name) {\n          leadsTo = tripwire.systems[otherSignature.systemID] ? \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+add.name+\"</a>\" : add.name;\n        } else if (tripwire.aSigSystems[otherSignature.systemID]) {\n            leadsTo = tripwire.aSigSystems[otherSignature.systemID];\n        } else if (tripwire.systems[otherSignature.systemID]) {\n            leadsTo = \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+tripwire.systems[otherSignature.systemID].name+\"</a>\";\n        } else {\n            leadsTo = \"\";\n        }\n\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(add.signatureID ? add.signatureID.substring(0, 3)+\"-\"+(add.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+(wormhole[wormhole.parent+\"ID\"] == add.id ? wormhole.type || \"\" : (wormhole.parent ? \"K162\" : \"\"))+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(leadsTo || \"\")+\"</td>\"\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+wormhole.life+\"</td>\"\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    } else {\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(add.signatureID ? add.signatureID.substring(0, 3)+\"-\"+(add.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+add.type+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(add.name?linkSig(add.name):'')+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    }\n\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\n\n    $(\"#sigTable\").append(tr);\n\n    // Add counter\n    if (wormhole.life == \"critical\") {\n        $(tr).find('span[data-age]').countdown({until: moment.utc(add.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\n            // .countdown('pause')\n            .addClass('critical')\n            // .countdown('resume');\n    } else {\n        $(tr).find('span[data-age]').countdown({since: moment.utc(add.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\n    }\n\n    if (animate) {\n        $(tr)\n            .find('td')\n            .wrapInner('<div class=\"hidden\" />')\n            .parent()\n            .find('td > div')\n            .slideDown(700, function(){\n                $set = $(this);\n                $set.replaceWith($set.contents());\n            });\n\n        $(tr).find(\"td\").animate({backgroundColor: \"#004D16\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n    }\n}\n","// Handles API updates\ntripwire.API = function() {\n    this.indicator;\n    this.APIrefresh;\n\n    this.API.expire = function() {\n        var options = {since: tripwire.API.APIrefresh, until: null, format: \"MS\", layout: \"-{mnn}{sep}{snn}\"};\n        $(\"#APItimer\").countdown(\"option\", options);\n    }\n\n    this.API.refresh = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: false,\n            dataType: \"JSON\",\n            data: \"indicator=\"+tripwire.API.indicator\n        }).done(function(data) {\n            if (data && data.APIrefresh) {\n                tripwire.API.indicator = data.indicator;\n                tripwire.API.APIrefresh = new Date(data.APIrefresh);\n                activity.refresh(); //Refresh graph\n\n                var options = {until: tripwire.API.APIrefresh, since: null, layout: \"{mnn}{sep}{snn}\"};\n                $(\"#APItimer\").countdown(\"option\", options);\n                setTimeout(\"tripwire.API.refresh();\", $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30);\n            } else if ($(\"#APItimer\").countdown(\"option\", \"layout\") !== \"-{mnn}{sep}{snn}\" && $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) > 120) {\n                setTimeout(\"tripwire.API.refresh();\", ($.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30) * 1000);\n            } else {\n                setTimeout(\"tripwire.API.refresh();\", 15000);\n            }\n        });\n    }\n\n    this.API.init = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: true,\n            dataType: \"JSON\",\n            data: \"init=true\"\n        }).done(function(data) {\n            tripwire.API.indicator = data.indicator;\n            tripwire.API.APIrefresh = new Date(data.APIrefresh);\n\n            $(\"#APItimer\").countdown({until: tripwire.API.APIrefresh, onExpiry: tripwire.API.expire, alwaysExpire: true, compact: true, format: \"MS\", serverSync: tripwire.serverTime.getTime, onTick: function(t) { $(\"#APIclock\").val(t[5] + 1).trigger(\"change\"); }})\n            var timer = $(\"#APItimer\").countdown(\"option\", \"layout\") === \"-{mnn}{sep}{snn}\" ? 15 : $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30;\n            setTimeout(\"tripwire.API.refresh();\", timer * 1000);\n        });\n    }\n\n    this.API.init();\n}\n// tripwire.API();\n","tripwire.autoMapper = function(from, to) {\n    var pods = [33328, 670];\n    var undo = [];\n\n    // Convert from & to from system name to system ID for diagnostic testing\n    // from = viewingSystemID;\n    // to = Object.index(tripwire.systems, 'name', to);\n\n    // Make sure the automapper is turned on & not disabled\n    if (!$(\"#toggle-automapper\").hasClass(\"active\") || $(\"#toggle-automapper\").hasClass(\"disabled\"))\n        return false;\n\n    // Make sure from and to are valid systems\n    if (!tripwire.systems[from] || !tripwire.systems[to])\n        return false;\n\n    // Make sure from and to are not the same system\n    if (from == to)\n        return false;\n\n    // Is pilot in a station?\n    if (tripwire.client.EVE && tripwire.client.EVE.stationID)\n        return false;\n\n    // Is pilot in a pod?\n    if (tripwire.client.EVE && tripwire.client.EVE.shipTypeID && $.inArray(parseInt(tripwire.client.EVE.shipTypeID), pods) >= 0)\n         return false;\n\n    // Is this a gate?\n    if (typeof(tripwire.map.shortest[from - 30000000]) != \"undefined\" && typeof(tripwire.map.shortest[from - 30000000][to - 30000000]) != \"undefined\")\n        return false;\n\n     // Is this an existing connection?\n     if ($.map(tripwire.client.wormholes,\n               function(wormhole) {\n                 const initial = tripwire.client.signatures[wormhole.initialID];\n                 const secondary = tripwire.client.signatures[wormhole.secondaryID];\n                 return initial && secondary &&\n                   ((initial.systemID == from && secondary.systemID == to) ||\n                    (initial.systemID == to && secondary.systemID == from))  ? wormhole : null;\n               }).length > 0) {\n       return false;\n     }\n\n    var payload = {\"signatures\": {\"add\": [], \"update\": []}};\n    var sig, toClass;\n\n    if (tripwire.systems[to].class)\n        toClass = \"Class-\" + tripwire.systems[to].class;\n    else if (tripwire.systems[to].security >= 0.45)\n        toClass = \"High-Sec\";\n    else if (tripwire.systems[to].security > 0)\n        toClass = \"Low-Sec\";\n    else\n        toClass = \"Null-Sec\";\n\n    var wormholes = $.map(tripwire.client.wormholes, function(wormhole) {\n        if ( ( tripwire.client.signatures[wormhole.initialID] !== undefined ) && ( tripwire.client.signatures[wormhole.secondaryID] !== undefined ) ) {\n            // Find wormholes that have no set Leads To system, and their initial system is from the wormhole we just jumped from\n            if (tripwire.client.signatures[wormhole.initialID].systemID == from && !tripwire.systems[tripwire.client.signatures[wormhole.secondaryID].systemID]) {\n                if (tripwire.aSigSystems[tripwire.client.signatures[wormhole.secondaryID].systemID] == toClass) {\n                    // Find wormholes that Leads To is generically set to the class we just jumped into\n                    return wormhole;\n                } else if (wormhole.type && tripwire.wormholes[wormhole.type] && tripwire.wormholes[wormhole.type].leadsTo.replace(' ', '-') == toClass) {\n                    // Find wormholes that Type is known to lead to the class we just jumped into\n                    return wormhole;\n                } else if (tripwire.client.signatures[wormhole.secondaryID].systemID === null && (!wormhole.type || !tripwire.wormholes[wormhole.type])) {\n                    // Find wormholes that don't have a Type or any kind of Leads To entered\n                    return wormhole;\n                }\n            }\n        }\n    });\n\n    if (wormholes.length) {\n        if (wormholes.length > 1) {\n            $(\"#dialog-select-signature\").dialog({\n                autoOpen: true,\n                title: \"Which Signature?\",\n                width: 390,\n                buttons: {\n                    Cancel: function() {\n                        $(this).dialog(\"close\");\n                    },\n                    Ok: function() {\n                        var i = $(\"#dialog-select-signature [name=sig]:checked\").val();\n                        var wormhole = wormholes[i];\n                        var signature = tripwire.client.signatures[wormhole.initialID];\n                        var signature2 = tripwire.client.signatures[wormhole.secondaryID];\n\n                        payload.signatures.update.push({\n                            \"wormhole\": {\n                                \"id\": wormhole.id\n                            },\n                            \"signatures\": [\n                                {\n                                    \"id\": signature.id\n                                },\n                                {\n                                    \"id\": signature2.id,\n                                    \"systemID\": to\n                                }\n                            ]\n                        });\n\n                        var success = function(data) {\n                            if (data.resultSet && data.resultSet[0].result == true) {\n                                undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\n                                $(\"#dialog-select-signature\").dialog(\"close\");\n                            }\n                        }\n\n                        tripwire.refresh('refresh', payload, success);\n                    }\n                },\n                open: function() {\n                    $(\"#dialog-select-signature .optionsTable tbody\").empty();\n\n                    $.each(wormholes, function(i) {\n                        var signature = tripwire.client.signatures[wormholes[i].initialID];\n                        var signatureRow = $(\"#sigTable tr[data-id='\"+signature.id+\"']\").html();\n                        var tr = \"<tr>\"\n                          + \"<td><input type='radio' name='sig' value='\"+i+\"' id='sig\"+i+\"' /></td>\"\n                          + signatureRow\n                          + \"</tr>\";\n\n                        $(\"#dialog-select-signature .optionsTable tbody\").append(tr);\n                        $(\"#dialog-select-signature .optionsTable tbody td\").wrapInner(\"<label for='sig\"+i+\"' />\");\n                    });\n                }\n            });\n        } else {\n            var wormhole = wormholes[0];\n            var signature = tripwire.client.signatures[wormhole.initialID];\n            var signature2 = tripwire.client.signatures[wormhole.secondaryID];\n\n            payload.signatures.update.push({\n                \"wormhole\": {\n                    \"id\": wormhole.id\n                },\n                \"signatures\": [\n                    {\n                        \"id\": signature.id\n                    },\n                    {\n                        \"id\": signature2.id,\n                        \"systemID\": to\n                    }\n                ]\n            });\n            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\n        }\n    } else {\n        // Nothing matches, create a new wormhole\n        payload.signatures.add.push({\n            \"wormhole\": {\n                \"type\": null,\n                \"parent\": \"initial\",\n                \"life\": \"stable\",\n                \"mass\": \"stable\"\n            },\n            \"signatures\": [\n                {\n                    \"systemID\": from,\n                    \"type\": \"wormhole\"\n                },\n                {\n                    \"systemID\": to,\n                    \"type\": \"wormhole\"\n                }\n            ]\n        });\n    }\n\n    if (payload.signatures.add.length || payload.signatures.update.length) {\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                $(\"#undo\").removeClass(\"disabled\");\n\n                if (data.results) {\n                    if (viewingSystemID in tripwire.signatures.undo) {\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\n                    }\n                }\n\n                if (undo.length) {\n                    if (viewingSystemID in tripwire.signatures.undo) {\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        tripwire.refresh('refresh', payload, success);\n    }\n}\n","$(\"body\").on(\"dblclick\", \".comment\", function(e) {\n\te.preventDefault();\n\tdocument.getSelection().removeAllRanges();\n\t$(this).find(\".commentEdit\").click();\n})\n\n$(\"body\").on(\"click\", \".commentEdit\", function(e) {\n\te.preventDefault();\n\n\t// Prevent multiple editors\n\tif ($(\".cke\").length) return false;\n\n\tvar $comment = $(this).closest(\".comment\");\n\n\t$comment.find(\".commentToolbar\").hide();\n\n\tCKEDITOR.replace($comment.find(\".commentBody\").attr(\"id\"), CKConfig).on(\"instanceReady\", function() {\n\t\t$comment.find(\".commentStatus\").html(\"\");\n\t\t$comment.find(\".commentFooter\").show();\n\t\t$comment.find(\".commentFooter .commentControls\").show();\n\t});\n\n\ttripwire.activity.editComment = $comment.data(\"id\");\n\ttripwire.refresh('refresh');\n});\n\n$(\"body\").on(\"click\", \".commentSave, .commentCancel\", function(e) {\n\te.preventDefault();\n\tvar $this = $(this);\n\tif ($this.attr(\"disabled\")) return false;\n\n\tvar $comment = $this.closest(\".comment\");\n\t$this.attr(\"disabled\", \"true\");\n\n\tif ($this.hasClass(\"commentSave\")) {\n\t\tvar data = {\"mode\": \"save\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? 0 : viewingSystemID, \"comment\": CKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].getData()};\n\n\t\t$.ajax({\n\t\t\turl: \"comments.php\",\n\t\t\ttype: \"POST\",\n\t\t\tdata: data,\n\t\t\tdataType: \"JSON\"\n\t\t}).done(function(data) {\n\t\t\tif (data && data.result == true) {\n\t\t\t\t$comment.find(\".commentModified\").html(\"Edited by \" + data.comment.modifiedByName + \" at \" + data.comment.modifiedDate);\n\t\t\t\t$comment.find(\".commentCreated\").html(\"Posted by \" + data.comment.createdByName + \" at \" + data.comment.createdDate);\n\t\t\t\tTooltips.attach($comment.find(\"[data-tooltip]\"));\n\n\t\t\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(false);\n\t\t\t\t$comment.attr(\"data-id\", data.comment.id);\n\t\t\t\t$comment.find(\".commentToolbar\").show();\n\t\t\t\t$comment.find(\".commentFooter\").hide();\n\t\t\t\t$this.removeAttr(\"disabled\");\n\t\t\t}\n\t\t});\n\t} else {\n\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(true);\n\n\t\tif (!$comment.attr(\"data-id\")) {\n\t\t\t$comment.remove();\n\t\t} else {\n\t\t\t$comment.find(\".commentToolbar\").show();\n\t\t\t$comment.find(\".commentFooter\").hide();\n\t\t\t$this.removeAttr(\"disabled\");\n\t\t}\n\t}\n\n\t$comment.find(\".commentStatus\").html(\"\");\n\n\tdelete tripwire.activity.editComment;\n\ttripwire.refresh('refresh');\n});\n\n$(\"body\").on(\"click\", \".commentDelete\", function(e) {\n\te.preventDefault();\n\tvar $comment = $(this).closest(\".comment\");\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-deleteComment\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#notesWidget\")},\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tDelete: function() {\n\t\t\t\t\t// Prevent duplicate submitting\n\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"disable\");\n\n\t\t\t\t\tvar $comment = $(this).data(\"comment\");\n\t\t\t\t\tvar data = {\"mode\": \"delete\", \"commentID\": $comment.data(\"id\")};\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: \"comments.php\",\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\tif (data && data.result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-deleteComment\").dialog(\"close\");\n\t\t\t\t\t\t\t$comment.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"enable\");\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-deleteComment\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog(\"open\");\n\t}\n});\n\n$(\"body\").on(\"click\", \"#add-comment\", function(e) {\n\te.preventDefault();\n\n\t// Prevent multiple editors\n\tif ($(\".cke\").length) return false;\n\n\tvar $comment = $(\".comment:last\").clone();\n\tvar commentID = $(\".comment:visible:last .commentBody\").attr(\"id\") ? $(\".comment:visible:last .commentBody\").attr(\"id\").replace(\"comment\", \"\") + 1 : 0;\n\t$(\".comment:last\").before($comment);\n\n\t$comment.find(\".commentBody\").attr(\"id\", \"comment\" + commentID);\n\t$comment.removeClass(\"hidden\").find(\".commentEdit\").click();\n});\n\n$(\"body\").on(\"click\", \".commentSticky\", function(e) {\n\te.preventDefault();\n\tvar $comment = $(this).closest(\".comment\");\n\n\tvar data = {\"mode\": \"sticky\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? viewingSystemID : 0};\n\n\t$.ajax({\n\t\turl: \"comments.php\",\n\t\ttype: \"POST\",\n\t\tdata: data,\n\t\tdataType: \"JSON\"\n\t}).done(function(data) {\n\t\tif (data && data.result == true) {\n\t\t\t$comment.find(\".commentSticky\").hasClass(\"active\") ? $comment.find(\".commentSticky\").removeClass(\"active\") : $comment.find(\".commentSticky\").addClass(\"active\");\n\t\t}\n\t});\n});\n","// Handles removing from Signatures section\ntripwire.deleteSig = function(key) {\n    var tr = $(\"#sigTable tr[data-id='\"+key+\"']\");\n\n    //Append empty space to prevent non-coloring\n    $(tr).find('td:empty, a:empty').append(\"&nbsp;\");\n\n    $(tr)\n        .find('td')\n        .wrapInner('<div />')\n        .parent()\n        .find('td > div').animate({backgroundColor: \"#4D0000\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000)\n        .slideUp(700, function(){\n            // Remove countdown reference\n            $(tr).find('span[data-age]').countdown(\"destroy\");\n\n            $(this).parent().parent().remove();\n            $(\"#sigTable\").trigger(\"update\");\n        });\n}\n","// Handles changing Signatures section\n// ToDo: Use native JS\ntripwire.editSig = function(edit, disabled) {\n    var disabled = disabled || false;\n    var wormhole = {};\n\n    if (edit.type == \"wormhole\") {\n        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == edit.id || wormhole.secondaryID == edit.id) return wormhole; })[0];\n        if (!wormhole) return false;\n        var otherSignature = edit.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n        if (!otherSignature) return false;\n\n        if (edit.name) {\n          leadsTo = tripwire.systems[otherSignature.systemID] ? \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+edit.name+\"</a>\" : edit.name;\n        } else if (tripwire.aSigSystems[otherSignature.systemID]) {\n            leadsTo = tripwire.aSigSystems[otherSignature.systemID];\n        } else if (tripwire.systems[otherSignature.systemID]) {\n            leadsTo = \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+tripwire.systems[otherSignature.systemID].name+\"</a>\";\n        } else {\n            leadsTo = \"\";\n        }\n\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(edit.signatureID ? edit.signatureID.substring(0, 3)+\"-\"+(edit.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+(wormhole[wormhole.parent+\"ID\"] == edit.id ? wormhole.type || \"\" : (wormhole.parent ? \"K162\" : \"\"))+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(leadsTo || \"\")+\"</td>\"\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+wormhole.life+\"</td>\"\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    } else {\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(edit.signatureID ? edit.signatureID.substring(0, 3)+\"-\"+(edit.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+edit.type+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(edit.name?linkSig(edit.name):'')+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    }\n\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\n\n    // Destroy the pervious countdown to prevent errors on a non-existant DOM element\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").find('span[data-age]').countdown(\"destroy\");\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").replaceWith(tr);\n\n    $(\"#sigTable\").trigger(\"update\");\n    // Update counter\n    if (wormhole.life == \"critical\") {\n        $(tr).find('span[data-age]').countdown({until: moment.utc(edit.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\n            .addClass('critical');\n    } else {\n        $(tr).find('span[data-age]').countdown({since: moment.utc(edit.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\n    }\n\n    $(tr).effect(\"pulsate\");\n}\n","tripwire.esi = function() {\n    var baseUrl = \"https://esi.evetech.net\";\n    var userAgent = \"Tripwire Client \" + tripwire.version + \" (\" + window.location.hostname + \") - \" + window.navigator.userAgent;\n    var locationTimer, shipTimer, onlineTimer;\n    this.esi.connection = true;\n    this.esi.characters = {};\n    this.esi.oauth = { subject: \"\", accessToken: \"\"};\n\n    var scopeError = function(characterID) {\n        $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").find(\".alert\").show();\n    }\n\n\tvar isExpired = function(tokenExpire) {\n\t\treturn moment.utc(tokenExpire).subtract(5, \"minutes\").isBefore(moment());\n\t}\n\n    this.esi.location = function() {\n        clearTimeout(locationTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            // Check for expiring token\n            if (isExpired(character.tokenExpire)) {\n                tripwire.data.esi = {\"expired\": true};\n                continue;\n            }\n\n            const xhr = $.ajax({\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/location/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\n                type: \"GET\",\n                dataType: \"JSON\",\n                characterID: characterID\n            }).done(function(data, status, jqXHR) {\n                var character = tripwire.esi.characters[this.characterID];\n\n                if (character) {\n                    character.locationDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\n\n                    if (character.systemID != data.solar_system_id) {\n                        character.systemID = data.solar_system_id || null;\n                        character.systemName = tripwire.systems[data.solar_system_id] ? tripwire.systems[data.solar_system_id].name : null;\n\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".system\").html(character.systemName || \"&nbsp;\");\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.stationID != data.station_id) {\n                        character.stationID = data.station_id || null;\n\n                        if (data.station_id) {\n                            tripwire.esi.stationLookup(data.station_id, this.characterID)\n                                .always(function(data) {\n                                    var character = tripwire.esi.characters[this.reference];\n\n                                    character.stationName = data.name || null;\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".station\").html(data.name.substring(0, 17) + \"...\" || \"&nbsp;\").attr(\"data-tooltip\", data.name);\n                                    Tooltips.attach($(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"'] .station[data-tooltip]\"));\n\n                                    // Send to Tripwire server on next refresh call\n                                    tripwire.data.tracking[this.reference] = {\n                                        characterID: character.characterID,\n                                        characterName: character.characterName,\n                                        systemID: character.systemID,\n                                        systemName: character.systemName,\n                                        stationID: character.stationID,\n                                        stationName: character.stationName,\n                                        shipID: character.shipID,\n                                        shipName: character.shipName,\n                                        shipTypeID: character.shipTypeID,\n                                        shipTypeName: character.shipTypeName};\n                                });\n                        } else {\n                            character.stationName = null;\n                            // $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".station\").html(\"&nbsp;\").attr(\"data-tooltip\", \"&nbsp;\");\n                            Tooltips.detach($(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"'] .station[data-tooltip]\"));\n\n                            // Send to Tripwire server on next refresh call\n                            tripwire.data.tracking[this.characterID] = {\n                                characterID: character.characterID,\n                                characterName: character.characterName,\n                                systemID: character.systemID,\n                                systemName: character.systemName,\n                                stationID: character.stationID,\n                                stationName: character.stationName,\n                                shipID: character.shipID,\n                                shipName: character.shipName,\n                                shipTypeID: character.shipTypeID,\n                                shipTypeName: character.shipTypeName};\n                        }\n                    }\n\n                    if (options.tracking.active == this.characterID) {\n                        tripwire.EVE(tripwire.esi.characters[options.tracking.active]);\n                    }\n                }\n            }).fail(function(data) {\n                if (data.status == 403) {\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\n                }\n            }).always(function(data, status, jqXHR) {\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\n                    tripwire.esi.connection = false;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\n                    tripwire.esi.connection = true;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\n                }\n            });\n            xhr.always(function(){\n                const warn = xhr.getResponseHeader('warning');\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\n            });\n        }\n\n        locationTimer = setTimeout(\"tripwire.esi.location()\", 5000);\n    }\n\n    this.esi.ship = function() {\n        clearTimeout(shipTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            // Check for expiring token\n            if (isExpired(character.tokenExpire)) {\n                tripwire.data.esi = {\"expired\": true};\n                continue;\n            }\n\n            const xhr = $.ajax({\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/ship/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\n                type: \"GET\",\n                dataType: \"JSON\",\n                characterID: characterID\n            }).done(function(data, status, jqXHR) {\n                var character = tripwire.esi.characters[this.characterID];\n\n                if (character) {\n                    character.shipDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\n\n                    if (character.shipID != data.ship_item_id) {\n                        character.shipID = data.ship_item_id || null;\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.shipName != data.ship_name) {\n                        character.shipName = data.ship_name || null;\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".shipname\").html(data.ship_name || \"&nbsp;\");\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.shipTypeID != data.ship_type_id) {\n                        character.shipTypeID = data.ship_type_id || null;\n\n                        if (data.ship_type_id) {\n                            tripwire.esi.typeLookup(data.ship_type_id, this.characterID)\n                                .always(function(data) {\n                                    var character = tripwire.esi.characters[this.reference];\n\n                                    character.shipTypeName = data.name || null;\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".ship\").html(data.name || \"&nbsp;\");\n\n                                    // Send to Tripwire server on next refresh call\n                                    tripwire.data.tracking[this.reference] = {\n                                        characterID: character.characterID,\n                                        characterName: character.characterName,\n                                        systemID: character.systemID,\n                                        systemName: character.systemName,\n                                        stationID: character.stationID,\n                                        stationName: character.stationName,\n                                        shipID: character.shipID,\n                                        shipName: character.shipName,\n                                        shipTypeID: character.shipTypeID,\n                                        shipTypeName: character.shipTypeName};\n                                });\n                        } else {\n                            character.shipTypeName = null;\n                            $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".ship\").html(\"&nbsp;\");\n\n                            // Send to Tripwire server on next refresh call\n                            tripwire.data.tracking[this.characterID] = {\n                                characterID: character.characterID,\n                                characterName: character.characterName,\n                                systemID: character.systemID,\n                                systemName: character.systemName,\n                                stationID: character.stationID,\n                                stationName: character.stationName,\n                                shipID: character.shipID,\n                                shipName: character.shipName,\n                                shipTypeID: character.shipTypeID,\n                                shipTypeName: character.shipTypeName};\n                        }\n                    }\n                }\n            }).fail(function(data) {\n                if (data.status == 403) {\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\n                }\n            }).always(function(data, status, jqXHR) {\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\n                    tripwire.esi.connection = false;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\n                    tripwire.esi.connection = true;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\n                }\n            });\n            xhr.always(function(){\n                const warn = xhr.getResponseHeader('warning');\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\n            });\n\n        }\n\n        shipTimer = setTimeout(\"tripwire.esi.ship()\", 5000);\n    }\n\n    this.esi.online = function() {\n        clearTimeout(onlineTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            tripwire.esi.characterStatus(character.characterID, character)\n                .done(function(data) {\n                    if (data.online) {\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"critical\").addClass(\"stable\");\n                    } else {\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\n                    }\n                }).fail(function(data) {\n                    if (data && data.status == 403) {\n                        scopeError(this.reference.characterID);\n                    }\n                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\n                });\n        }\n\n        onlineTimer = setTimeout(\"tripwire.esi.online()\", 60000);\n    }\n\n    this.esi.typeLookup = function(typeID, reference) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v3/universe/types/\"+ typeID +\"/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.stationLookup = function(stationID, reference) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v2/universe/stations/\"+ stationID +\"/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.setDestination = function(destinationID, characterID, clear_waypoints, beginning) {\n        clear_waypoints = clear_waypoints ? clear_waypoints : false;\n        beginning = beginning ? beginning : false;\n        const xhr = $.ajax({\n            url: baseUrl + \"/v2/ui/autopilot/waypoint/?\" + $.param({destination_id: destinationID, clear_other_waypoints: clear_waypoints, add_to_beginning: beginning}),\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"POST\",\n            dataType: \"JSON\"\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.showInfo = function(targetID, characterID) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v1/ui/openwindow/information/?\" + $.param({target_id: targetID}),\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"POST\",\n            dataType: \"JSON\"\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.characterStatus = function(characterID, reference) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v2/characters/\" + characterID + \"/online/?\" + $.param({\"token\": tripwire.esi.characters[characterID].accessToken, \"user_agent\": userAgent}),\n            // headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.eveStatus = function() {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v1/status/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\"\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.idLookup = function(eveIDs) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v2/universe/names/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"POST\",\n            dataType: \"JSON\",\n            contentType: \"application/json\",\n            processData: false,\n            data: JSON.stringify(eveIDs)\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.characterLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        const xhr = $.ajax({\n            url: baseUrl + \"/latest/characters/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.corporationLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        const xhr = $.ajax({\n            url: baseUrl + \"/v4/corporations/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.allianceLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        const xhr = $.ajax({\n            url: baseUrl + \"/v3/alliances/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.search = function(searchString, categories, strict) {\n        const xhr = $.ajax({\n            url: baseUrl + \"/latest/characters/\" + tripwire.esi.oauth.subject + \"/search/?\" + $.param({\"user_agent\": userAgent}),\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.oauth.accessToken},\n            type: \"GET\",\n            dataType: \"JSON\",\n            contentType: \"application/json\",\n            data: {\"search\": searchString, \"categories\": categories, \"strict\": strict}\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.universeJumps = function() {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v1/universe/system_jumps/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\"\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    this.esi.universeKills = function() {\n        const xhr = $.ajax({\n            url: baseUrl + \"/v2/universe/system_kills/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\"\n        });\n        return xhr.always(function(){\n            const warn = xhr.getResponseHeader('warning');\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\n        });\n    }\n\n    // Wrapper to make lookups easier\n    this.esi.fullLookup = function(eveIDs) {\n        var promise = $.Deferred();\n\n        tripwire.esi.idLookup(eveIDs)\n            .done(function(data) {\n                for (item in data) {\n                    if (data[item].category == \"character\") {\n                        tripwire.esi.characterLookup(data[item].id, data[item], false)\n                            .done(function(characterData) {\n                                $.extend(data[item], characterData);\n                                tripwire.esi.corporationLookup(characterData.corporation_id, this.reference, false)\n                                    .done(function(corporationData) {\n                                        data[item].corporation = corporationData;\n                                        if (corporationData.alliance_id) {\n                                            tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\n                                                .done(function(allianceData) {\n                                                    data[item].alliance = allianceData;\n                                                });\n                                        }\n                                    });\n                            });\n                    } else if (data[item].category == \"corporation\") {\n                        tripwire.esi.corporationLookup(data[item].id, data[item], false)\n                            .done(function(corporationData) {\n                                $.extend(data[item], corporationData);\n                                if (corporationData.alliance_id) {\n                                    tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\n                                        .done(function(allianceData) {\n                                            data[item].alliance = allianceData;\n                                        });\n                                }\n                            })\n                    }\n                }\n\n                promise.resolve(data);\n            });\n\n        return promise;\n    }\n\n    // Parse main account oauth information out of refresh data. This is used\n    // to make authenticated ESI requests for enpoints that are not specific to\n    // tracking characters, e.g., mask access management.\n    this.esi.parseOauth = function(data) {\n        const _data = data || {}\n        tripwire.esi.oauth = {\n            subject: _data.subject,\n            accessToken: _data.accessToken\n        };\n    }\n\n    this.esi.parse = function(characters) {\n        for (characterID in tripwire.esi.characters) {\n            if (!(characterID in characters)) {\n                delete tripwire.esi.characters[characterID];\n                $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\n                if (options.tracking.active == characterID) {\n                    tripwire.EVE(false, true);\n                    $(\"#removeESI\").attr(\"disabled\", \"disabled\");\n                }\n            }\n        }\n\n        for (characterID in characters) {\n            if (options.tracking.active == \"new\") {\n                options.tracking.active = characterID;\n            }\n\n            if (!(characterID in tripwire.esi.characters)) {\n                var $clone = $(\"#tracking-clone\").clone();\n                $clone.attr(\"data-characterid\", characterID);\n                $clone.find(\".avatar img\").attr(\"src\", \"https://image.eveonline.com/Character/\"+ characterID +\"_32.jpg\");\n                $clone.find(\".name\").html(characters[characterID].characterName);\n                $clone.removeAttr(\"id\");\n                $clone.removeClass(\"hidden\");\n                $clone.addClass(\"tracking-clone\");\n\n                if (options.tracking.active == characterID) {\n                    $clone.addClass(\"active\");\n                    $(\"#removeESI\").removeAttr(\"disabled\");\t\t\t\t}\n\n                $(\"#tracking\").append($clone);\n                // Tooltips.attach($clone.find(\"[data-tooltip]\"));\n            }\n\n            tripwire.esi.characters[characterID] = characters[characterID];\n        }\n\n        tripwire.esi.ship();\n        tripwire.esi.location();\n        tripwire.esi.online();\n    }\n}\ntripwire.esi();\n","// Handles data from EVE in-game data\ntripwire.EVE = function(EVE, characterChange) {\n    var systemChange = this.client.EVE && this.client.EVE.systemChange || false;\n\n    if (EVE) {\n        // Automapper\n        if (!characterChange) {\n            // Did the system change or did it previously and we have yet to try an autoMapper call?\n            if ((this.client.EVE && this.client.EVE.systemID != EVE.systemID) || systemChange == true) {\n                systemChange = true;\n\n                // Check if location was updated after the last ship update\n                // if (moment(EVE.locationDate).isAfter(moment(this.client.EVE.shipDate))) {\n                    systemChange = false;\n                    tripwire.autoMapper(this.client.EVE.systemID, EVE.systemID);\n                // }\n            }\n        }\n\n        // System follower\n        if (!characterChange && options.buttons.follow && (this.client.EVE && this.client.EVE.systemID != EVE.systemID) && $(\".ui-dialog:visible\").length == 0) {\n            tripwire.systemChange(EVE.systemID);\n        }\n\n        if (!$(\"#search\").hasClass(\"active\")) {\n            $(\"#currentSpan\").show();\n        }\n\n        // Enable auto-mapper\n        $(\"#toggle-automapper\").removeClass(\"disabled\");\n\n        // Update current system\n        if (EVE.systemID) {\n            // add system to Leads To dropdown\n            if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"addToSelect\", tripwire.systems[EVE.systemID].name);\n            }\n            $(\"#EVEsystem\").html(tripwire.systems[EVE.systemID].name).attr(\"href\", \".?system=\"+ tripwire.systems[EVE.systemID].name);\n        }\n    } else {\n        // Update current system\n        $(\"#EVEsystem\").html(\"\");\n        $(\"#currentSpan\").hide();\n        // Disable automapper\n        $(\"#toggle-automapper\").addClass(\"disabled\");\n        // remove system from Leads To dropdown\n        if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\n            $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\n        }\n    }\n\n    this.client.EVE = {\n        characterID: EVE.characterID,\n        characterName: EVE.characterName,\n        systemID: EVE.systemID,\n        systemName: EVE.systemName,\n        shipTypeID: EVE.shipTypeID,\n        shipTypeName: EVE.shipTypeName,\n        stationID: EVE.stationID,\n        stationName: EVE.stationName,\n        locationDate: EVE.locationDate,\n        shipDate: EVE.shipDate,\n        systemChange: systemChange\n    };\n}\n","tripwire.parse = function(server, mode) {\n    var data = $.extend(true, {}, server);\n\n    var updateSignatureTable = false;\n\n    if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout != true)) {\n        if (options.masks.active != \"273.0\") {\n            for (var key in data.signatures) {\n                if (data.signatures[key].mask == \"273.0\") {\n                    delete data.signatures[key];\n                }\n            }\n        }\n    }\n\n    if (mode == 'refresh') {\n        // preserve client.EVE across refresh otherwise tracking/automapper will be confused\n        var EVE = this.client.EVE;\n        this.client = server;\n        this.client.EVE = EVE;\n\n        for (var key in data.signatures) {\n            if (data.signatures[key].systemID != viewingSystemID) {\n                continue;\n            }\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\n\n            // Check for differences\n            if (!tripwire.signatures.list[key]) {\n\t\t\t\ttripwire.signatures.list[key] = data.signatures[key];\t// To reduce race condition chance\n                this.addSig(data.signatures[key], {animate: true}, disabled);\n                updateSignatureTable = true;\n            } else if (tripwire.signatures.list[key].modifiedTime !== data.signatures[key].modifiedTime) {\n                var edit = false;\n                for (column in data.signatures[key]) {\n                    if (data.signatures[key][column] != tripwire.signatures.list[key][column] && column != \"editing\") {\n                        edit = true;\n                    }\n                }\n\n                if (edit) {\n                    this.editSig(data.signatures[key], disabled);\n                } else {\n                    // this.sigEditing(data.signatures[key]);\n                }\n            }\n        }\n\n        // Sigs needing removal\n        for (var key in tripwire.signatures.list) {\n            if (!data.signatures[key]) {\n                this.deleteSig(key);\n            }\n        }\n    } else if (mode == 'init' || mode == 'change') {\n        this.client = server;\n\n        for (var key in data.signatures) {\n            if (data.signatures[key].systemID != viewingSystemID) {\n                continue;\n            }\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\n\t\t\t\n\t\t\tif(!tripwire.signatures.list[key]) {\n\t\t\t\tthis.addSig(data.signatures[key], {animate: false}, disabled);\n\t\t\t\tupdateSignatureTable = true;\n\t\t\t}\n            if (data.signatures[key].editing) {\n                this.sigEditing(data.signatures[key]);\n            }\n        }\n    }\n\n    if (updateSignatureTable) {\n        $(\"#sigTable\").trigger(\"update\");\n    }\n    tripwire.signatures.list = data.signatures;\n\n    // set the sig count in the UI\n    var signatureCount = 0;\n    $.map(data.signatures, function(signature) {signature.systemID == viewingSystemID ? signatureCount++ : null;});\n    $(\"#signature-count\").html(signatureCount);\n}\n","// Handles pasting sigs from EVE\ntripwire.pasteSignatures = function() {\n    var processing = false;\n\n    var rowParse = function(row) {\n        var scanner = {};\n        var columns = row.split(\"\t\"); // Split by tab\n        var validScanGroups = [\n            // English (en-us)\n            \"Cosmic Signature\",\n            \"Cosmic Anomaly\",\n\n            // French (fr)\n            \"Signature cosmique\",\n            \"Anomalie cosmique\",\n\n            // German (de)\n            \"Kosmische Anomalie\",\n            \"Kosmische Signatur\",\n\n            // Japanese (ja)\n            \"宇宙の特異点\",\n            \"宇宙のシグネチャ\",\n\n            // Korean (ko)\n            \"코즈믹 시그니처\",\n            \"코즈믹 어노말리\",\n\n            // Russian (ru)\n            \"Скрытый сигнал\",\n            \"Космическая аномалия\",\n        ];\n\n        var validTypes = {\n            // English (en-us)\n            \"Combat Site\": \"Combat\",\n            \"Data Site\": \"Data\",\n            \"Gas Site\": \"Gas\",\n            \"Ore Site\": \"Ore\",\n            \"Relic Site\": \"Relic\",\n            \"Wormhole\": \"Wormhole\",\n\n            // French (fr)\n            \"Site de combat\": \"Combat\",\n            \"Site de données\": \"Data\",\n            \"Site de collecte de gaz\": \"Gas\",\n            \"Site de minerai\": \"Ore\",\n            \"Site de reliques\": \"Relic\",\n            \"Trou de ver\": \"Wormhole\",\n\n            // German (de)\n            \"Kampfgebiet\": \"Combat\",\n            \"Datengebiet\": \"Data\",\n            \"Gasgebiet\": \"Gas\",\n            \"Mineraliengebiet\": \"Ore\",\n            \"Reliktgebiet\": \"Relic\",\n            \"Wurmloch\": \"Wormhole\",\n\n            // Japanese (ja)\n            \"戦闘サイト\": \"Combat\",\n            \"データサイト\": \"Data\",\n            \"ガスサイト\": \"Gas\",\n            \"鉱石サイト\": \"Ore\",\n            \"遺物サイト\": \"Relic\",\n            \"ワームホール\": \"Wormhole\",\n\n            // Korean (ko)\n            \"전투 사이트\": \"Combat\",\n            \"데이터 사이트\": \"Data\",\n            \"가스 사이트\": \"Gas\",\n            \"채광 사이트\": \"Ore\",\n            \"유물 사이트\": \"Relic\",\n            \"웜홀\": \"Wormhole\",\n\n            // Russian (ru)\n            \"Боевой район\": \"Combat\",\n            \"Информационный район\": \"Data\",\n            \"Газовый район\": \"Gas\",\n            \"Астероидный район\": \"Ore\",\n            \"Археологический район\": \"Relic\",\n            \"Червоточина\": \"Wormhole\",\n        };\n\n        for (var x in columns) {\n            if (columns[x].match(/^([A-Z]{3}[-]\\d{3})$/)) {\n                scanner.id = columns[x].split(\"-\");\n                continue;\n            }\n\n            if (columns[x].match(/(\\d([.|,]\\d)?[ ]?(%))/) || columns[x].match(/(\\d[.|,]?\\d+\\s?(UA|AU|AE|km|m|а.е.|км|м))/i)) { // Exclude scan % || AU\n                continue;\n            }\n\n            if ($.inArray(columns[x], validScanGroups) != -1) {\n                scanner.scanGroup = columns[x];\n                continue;\n            }\n\n            if (validTypes[columns[x]]) {\n                scanner.type = validTypes[columns[x]];\n                continue;\n            }\n\n            if (columns[x] != \"\") {\n                scanner.name = columns[x].trim();\n            }\n        }\n\n        if (!scanner.id || scanner.id.length !== 2) {\n            return false;\n        }\n\n        return scanner;\n    }\n\n    this.pasteSignatures.parsePaste = function(paste) {\n        var paste = paste.split(\"\\n\");\n        var payload = {\"signatures\": {\"add\": [], \"update\": []}, \"systemID\": viewingSystemID};\n        var undo = [];\n        processing = true;\n\n        for (var i in paste) {\n            var scanner = rowParse(paste[i]);\n\n            if (scanner.id) {\n                var signature = $.map(tripwire.client.signatures, function(signature) { if (signature.signatureID && signature.signatureID.toUpperCase() == scanner.id[0] + scanner.id[1]) return signature; })[0];\n                if (signature) {\n                    // Update signature (only non-wormholes can be updated to a wormhole)\n                    if (scanner.type == \"Wormhole\" && signature.type != \"wormhole\") {\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\n                        payload.signatures.update.push({\n                            \"wormhole\": {\n                                \"id\": wormhole.id || null,\n                                \"type\": wormhole.type || null,\n                                \"life\": wormhole.life || \"stable\",\n                                \"mass\": wormhole.mass || \"stable\"\n                            },\n                            \"signatures\": [\n                                {\n                                    \"id\": signature.id,\n                                    \"signatureID\": signature.signatureID,\n                                    \"systemID\": viewingSystemID,\n                                    \"type\": \"wormhole\",\n                                    \"name\": signature.name\n                                },\n                                {\n                                    \"id\": otherSignature.id || null,\n                                    \"signatureID\": otherSignature.signatureID || null,\n                                    \"systemID\": otherSignature.systemID || null,\n                                    \"type\": \"wormhole\",\n                                    \"name\": otherSignature.name\n                                }\n                            ]\n                        });\n\n                        if (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[otherSignature.id]]});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t}\n                    // Make sure we are only updating when we have new info (we never turn wormholes into regular signatures)\n                    } else if (signature.type != \"wormhole\" && ((scanner.type && scanner.type.toLowerCase() != signature.type) || (scanner.name && scanner.name != signature.name))) {\n                        payload.signatures.update.push({\n                            \"id\": signature.id,\n                            \"systemID\": viewingSystemID,\n                            \"type\": scanner.type || 'unknown',\n                            \"name\": scanner.name,\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                        });\n                        undo.push(tripwire.client.signatures[signature.id]);\n                    }\n                } else {\n                    // Add signature\n                    if (scanner.type == \"Wormhole\") {\n                        payload.signatures.add.push({\n                            \"wormhole\": {\n                                \"type\": null,\n                                \"parent\": \"initial\",\n                                \"life\": \"stable\",\n                                \"mass\": \"stable\"\n                            },\n                            \"signatures\": [\n                                {\n                                    \"signatureID\": scanner.id[0] + scanner.id[1],\n                                    \"systemID\": viewingSystemID,\n                                    \"type\": \"wormhole\",\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                                },\n                                {\n                                    \"signatureID\": null,\n                                    \"systemID\": null,\n                                    \"type\": \"wormhole\",\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                                }\n                            ]\n                        });\n                    } else {\n                        payload.signatures.add.push({\n                            \"signatureID\": scanner.id[0] + scanner.id[1],\n                            \"systemID\": viewingSystemID,\n                            \"type\": scanner.type || 'unknown',\n                            \"name\": scanner.name,\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                        });\n                    }\n                }\n            }\n        }\n\n        if (payload.signatures.add.length || payload.signatures.update.length) {\n            var success = function(data) {\n                if (data.resultSet && data.resultSet[0].result == true) {\n                    $(\"#undo\").removeClass(\"disabled\");\n\n                    if (data.results) {\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\n                        } else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\n                        }\n                    }\n\n                    if (undo.length) {\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\n\t\t\t\t\t\t} else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\n\t\t\t\t\t\t}\n                    }\n\n                    sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                }\n            }\n\n            var always = function(data) {\n                processing = false;\n            }\n\n            tripwire.refresh('refresh', payload, success, always);\n        } else {\n            processing = false;\n        }\n    }\n\n    this.pasteSignatures.init = function() {\n        $(document).keydown(function(e)\t{\n            if ((e.metaKey || e.ctrlKey) && (e.keyCode == 86 || e.keyCode == 91) && !processing) {\n                //Abort - user is in input or textarea\n                if ($(document.activeElement).is(\"textarea, input\")) return;\n\n                $(\"#clipboard\").focus();\n            }\n        });\n\n        $(\"body\").on(\"click\", \"#fullPaste\", function(e) {\n            e.preventDefault();\n\n            var paste = $(this).data(\"paste\").split(\"\\n\");\n            var pasteIDs = [];\n            var removes = [];\n            var undo = [];\n\n            for (var i in paste) {\n                if (scan = rowParse(paste[i])) {\n                    pasteIDs.push((scan.id[0] + scan.id[1]).toLowerCase());\n                }\n            }\n\n            for (var i in tripwire.client.signatures) {\n                var signature = tripwire.client.signatures[i];\n\n                if (signature.systemID == viewingSystemID && signature.signatureID && $.inArray(signature.signatureID.toLowerCase(), pasteIDs) === -1 && signature.signatureID !== \"???\") {\n                    if (signature.type == \"wormhole\") {\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\n                        if (wormhole.type !== \"GATE\") {\n                            removes.push(wormhole);\n                            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, otherSignature]});\n                        }\n                    } else {\n                        removes.push(signature.id);\n                        undo.push(signature);\n                    }\n                }\n            }\n\n            if (removes.length > 0) {\n                var payload = {\"signatures\": {\"remove\": removes}};\n\n                var success = function(data) {\n                    if (data.resultSet && data.resultSet[0].result == true) {\n                        $(\"#undo\").removeClass(\"disabled\");\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n                        } else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n                        }\n\n                        sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                    }\n                }\n\n                tripwire.refresh('refresh', payload, success);\n            }\n        });\n\n        $(\"#clipboard\").on(\"paste\", function(e) {\n            e.preventDefault();\n            var paste = window.clipboardData ? window.clipboardData.getData(\"Text\") : (e.originalEvent || e).clipboardData.getData('text/plain');\n\n            $(\"#clipboard\").blur();\n            Notify.trigger(\"Paste detected<br/>(<a id='fullPaste' href=''>Click to delete missing sigs</a>)\");\n            $(\"#fullPaste\").data(\"paste\", paste);\n            tripwire.pasteSignatures.parsePaste(paste);\n        });\n    }\n\n    this.pasteSignatures.init();\n}\ntripwire.pasteSignatures();\n","tripwire.redo = function() {\n    if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n        $(\"#redo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.redo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var redoItem = tripwire.signatures.redo[viewingSystemID][lastIndex];\n        var undo = $.map(redoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(redoItem.action) {\n            case \"add\":\n                data.signatures.add = data.signatures.add.concat(redoItem.signatures);\n                break;\n            case \"remove\":\n                data.signatures.remove = data.signatures.remove.concat($.map(redoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(redoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.redo[viewingSystemID].pop();\n\n                $(\"#undo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.undo) {\n                    if (redoItem.action == \"add\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": data.results});\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID].push({action: redoItem.action, signatures: redoItem.signatures});\n                    }\n                } else {\n                    if (redoItem.action == \"add\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": data.results}];\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": undo}];\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: redoItem.action, signatures: redoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n                $(\"#redo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","// Handles pulling TQ status & player count\ntripwire.serverStatus = function() {\n    this.data;\n    this.timer;\n\n    clearTimeout(tripwire.serverStatus.timer);\n\n    tripwire.esi.eveStatus()\n        .always(function(data) {\n            if (data && data.players && data.players > 0) {\n                if (!tripwire.serverStatus.data || tripwire.serverStatus.data.players !== data.players) {\n                    $('#serverStatus').html(\"<span class='\"+(data.players > 0 ? 'stable' : 'critical')+\"'>TQ</span>: \"+numFormat(data.players));\n\n                    if (tripwire.serverStatus.data) {\n                        $(\"#serverStatus\").effect('pulsate', {times: 5});\n                    }\n                }\n\n                tripwire.serverStatus.data = data;\n            } else {\n                $('#serverStatus').html(\"<span class='critical'>TQ</span>\");\n            }\n\n            tripwire.serverStatus.timer = setTimeout(\"tripwire.serverStatus();\", 15000);\n        });\n}\ntripwire.serverStatus();\n","tripwire.sync = function(mode, data, successCallback, alwaysCallback) {\n    var data = typeof(data) === \"object\" ? $.extend(true, {}, data) : {};\n\n    // Grab any pending changes\n    $.extend(true, data, tripwire.data);\n\n    // Remove old timer to prevent multiple\n    if (this.timer) clearTimeout(this.timer);\n    if (this.xhr) {\n\t\tconsole.log('Awaiting existing XHR ' + this.xhr.data.mode + ': ', this.xhr);\n\t\ttripwire.data = data;\n\t\tthis.timer = setTimeout(function() { tripwire.sync(mode, data, successCallback, alwaysCallback); }, 50);\n\t\treturn false;\n\t}\n\n    if (mode == 'refresh' || mode == 'change') {\n        data.signatureCount = tripwire.serverSignatureCount;\n        data.signatureTime = Object.maxTime(this.client.signatures, \"modifiedTime\");\n\n        data.flareCount = chain.data.flares ? chain.data.flares.flares.length : 0;\n        data.flareTime = chain.data.flares ? chain.data.flares.last_modified : 0;\n\n        data.commentCount = Object.size(this.comments.data);\n        data.commentTime = Object.maxTime(this.comments.data, \"modified\");\n\n        data.activity = this.activity;\n    } else {\n        // Expand Tripwire with JSON data from EVE Data Dump and other static data\n        $.extend(this, appData);\n\n        this.aSystems = $.map(this.systems, function(system) { return system.name; });\n        this.aSigSystems = [\"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Class-1\", \"Class-2\", \"Class-3\", \"Class-4\", \"Class-5\", \"Class-6\", \"Class-13\", \"Triglavian\"];\n        $.merge(this.aSigSystems, this.aSystems.slice());\n\n        $(\".systemsAutocomplete\").inlinecomplete({source: this.aSystems, maxSize: 10, delay: 0});\n    }\n\n    data.mode = mode != \"init\" ? \"refresh\" : \"init\";\n    data.systemID = viewingSystemID;\n    data.systemName = viewingSystem;\n    data.instance = tripwire.instance;\n    data.version = tripwire.version;\n\n    this.xhr = $.ajax({\n        url: \"refresh.php\",\n        data: data,\n        type: \"POST\",\n        dataType: \"JSON\",\n        cache: false\n    }).done(function(data) {\n        if (data) {\n            tripwire.server = data;\n            if(data.signatures) { // Save this count before we delete entries\n                tripwire.serverSignatureCount = Object.size(data.signatures);\n            }\n\n            if (data.wormholes) {\n                // Purge bad wormhole signatures\n                var wormholeInitialIDs = {};\n                var wormholeSecondaryIDs = {};\n                Object.values(data.wormholes).forEach(function (wh) {\n                    wormholeInitialIDs[parseInt(wh.initialID)] = wh.id;\n                    wormholeSecondaryIDs[parseInt(wh.secondaryID)] = wh.id;\n                })\n                for (var i in data.signatures) {\n                  if (data.signatures[i].type == \"wormhole\") {\n                    var id = data.signatures[i].id;\n                    if (wormholeInitialIDs[id] === undefined && wormholeSecondaryIDs[id] === undefined) {\n                      delete data.signatures[i];\n                    }\n                  }\n                }\n            }\n\n            if (data.esi) {\n                tripwire.esi.parse(data.esi);\n            }\n\n            if (data.oauth) {\n                tripwire.esi.parseOauth(data.oauth);\n            }\n\n            if (data.sync) {\n                tripwire.serverTime.time = new Date(data.sync);\n            }\n\n            if (data.signatures) {\n                tripwire.parse(data, mode);\n            }\n\n            if (data.comments) {\n                tripwire.comments.parse(data.comments);\n            }\n\n            if (data.wormholes || data.occupied || data.flares) {\n                tripwire.chainMap.parse({\"map\": data.wormholes || null, \"occupied\": data.occupied || null, \"flares\": data.flares || null});\n            } else if (chain.data.occupied && chain.data.occupied.length && !data.occupied) {\n                // send update to remove all occupied system indicators\n                tripwire.chainMap.parse({\"occupied\": []});\n            }\n\n            tripwire.active(data.activity);\n\n            if (data.notify && !$(\"#serverNotification\")[0]) Notify.trigger(data.notify, \"yellow\", false, \"serverNotification\");\n\t\t\t\n\t\t\t$('[data-command=ping]')[data.discord_integration ? 'show' : 'hide']();\n        }\n\n        tripwire.data = {tracking: {}, esi: {}};\n        successCallback ? successCallback(data) : null;\n    }).always(function(data, status) {\n        tripwire.timer = setTimeout(\"tripwire.refresh();\", tripwire.refreshRate);\n\n        alwaysCallback ? alwaysCallback(data) : null;\n\n        if (data.status == 403) {\n            window.location.href = \".\";\n        } else if (status != \"success\" && status != \"abort\" && tripwire.connected == true) {\n            tripwire.connected = false;\n            $(\"#ConnectionSuccess\").click();\n            Notify.trigger(\"Error syncing with server\", \"red\", false, \"connectionError\");\n        } else if (status == \"success\" && tripwire.connected == false) {\n            tripwire.connected = true;\n            $(\"#connectionError\").click();\n            Notify.trigger(\"Successfully reconnected with server\", \"green\", 5000, \"connectionSuccess\");\n        }\n\t\t\n\t\ttripwire.xhr = null;\n    });\n\tthis.xhr.data = data;\n\t\n    return true;\n}\ntripwire.sync(\"init\");\n","// Change the currently viewed system\ntripwire.systemChange = function(systemID, mode) {\n\tconst system = systemAnalysis.analyse(systemID);\n\t\t\n    if (mode != \"init\") {\n        $(\"#infoSecurity\").removeClass();\n        $(\"#infoStatics\").empty();\n\n        viewingSystem = system.name;\n        viewingSystemID = systemID;\n\n        // Reset activity\n        activity.refresh(true);\n\n        // Reset signatures\n        $(\"#sigTable span[data-age]\").countdown(\"destroy\");\n        $(\"#sigTable tbody\").empty();\n        $(\"#signature-count\").html(0);\n        tripwire.signatures.list = {};\n        tripwire.client.signatures = null;\n\n        // Reset chain map\n        chain.redraw();\n\n        // Reset comments\n        $(\"#notesWidget .content .comment:visible\").remove();\n        tripwire.comments.data = null;\n\n        // Change the URL & history\n        history.replaceState(null, null, \"?system=\"+viewingSystem);\n\n        tripwire.refresh(\"change\");\n    }\n\n    // Change the title\n    document.title = system.name + \" - \" + app_name;\n\n    $(\"#infoSystem\").text(system.name);\n\n    // Current system favorite\n    $.inArray(parseInt(viewingSystemID), options.favorites) != -1 ? $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\") : $(\"#system-favorite\").attr(\"data-icon\", \"star-empty\").removeClass(\"active\");\n\t\n    if (system.class) {\n        // Security\n        $(\"#infoSecurity\").html(\"<span class='wh pointer'>Class \" + system.class + \"</span>\");\n\n        // Effects\n        if (system.effect) {\n            var tooltip = \"<table cellpadding=\\\"0\\\" cellspacing=\\\"1\\\">\";\n            for (var x in tripwire.effects[system.effect]) {\n                var effect = tripwire.effects[system.effect][x].name;\n                var base = tripwire.effects[system.effect][x].base;\n                var bad = tripwire.effects[system.effect][x].bad;\n                var whClass = system.class > 6 ? 6 : system.class;\n                var modifier = 0;\n\n                switch (Math.abs(base)) {\n                    case 15:\n                        modifier = base > 0 ? 7 : -7;\n                        break;\n                    case 30:\n                        modifier = base > 0 ? 14 : -14;\n                        break;\n                    case 60:\n                        modifier = base > 0 ? 28 : -28;\n                        break;\n                }\n\n                tooltip += \"<tr><td>\" + effect + \"</td><td style=\\\"padding-left: 25px; text-align: right;\\\" class=\\\"\" + (bad ? \"critical\" : \"stable\") + \"\\\">\";\n                tooltip += base + (modifier * (whClass -1)) + \"%</td></tr>\";\n            }\n            tooltip += \"</table>\";\n            $(\"#infoSecurity\").append(\"&nbsp;<span class='pointer' data-tooltip='\" + tooltip + \"'>\" + system.effect + \"</span>\");\n        }\n\n        // Statics\n        for (var x in system.statics) {\n            var type = system.statics[x];\n            var wormhole = tripwire.wormholes[type];\n            var color = \"wh\";\n\n            switch (wormhole.leadsTo) {\n                case \"High-Sec\":\n                    color = \"hisec\";\n                    break;\n                case \"Low-Sec\":\n                    color = \"lowsec\";\n                    break;\n                case \"Null-Sec\":\n                    color = \"nullsec\";\n                    break;\n            }\n\n            $(\"#infoStatics\").append(\"<div><span class='\"+ color +\"'>&#9679;</span> <b>\"+ wormhole.leadsTo +\"</b> via <span class='\"+ color +\"'>\"+ type +\"</span></div>\");\n        }\n\n        // Faction\n        $(\"#infoFaction\").html(\"&nbsp;\");\n    } else {\n        // Security\n\t\tconst securityText = {HS: 'High-Sec', LS: 'Low-Sec', NS: 'Null-Sec', 'Trig': 'Triglavian' }[system.systemTypeName];\n       $(\"#infoSecurity\").addClass(system.systemTypeClass).html(securityText + \" \" + system.baseSecurity.toFixed(2) + system.systemTypeModifiers.join(' '));\n\n        // Faction\n        $(\"#infoFaction\").html(system.factionID ? tripwire.factions[system.factionID].name : \"&nbsp;\");\n\t\t\n\t\t// Route to favourites\n\t\tfor (var fi in options.favorites) {\n\t\t\tconst f = options.favorites[fi];\n\t\t\tconst path = guidance.findShortestPath(tripwire.map.shortest, f - 30000000, viewingSystemID - 30000000);\n\t\t\tif(path) { $('#infoStatics').append('<p><b><a href=\".?system=' + tripwire.systems[f].name + '\">' +tripwire.systems[f].name + '</a></b>: ' + chain.renderPath(path) + '</p>'); }\n\t\t}\n    }\n\t\n\tTooltips.attach($(\"#infoStatics [data-tooltip]\"));\n    Tooltips.attach($(\"#infoSecurity [data-tooltip]\"));\n\n    // Region\n    $(\"#infoRegion\").text(tripwire.regions[system.regionID].name);\n\n    // Info Links\n    $(\"#infoWidget .infoLink\").each(function() {\n        this.href = $(this).data(\"href\").replace(/\\$systemName/gi, system.name).replace(/\\$systemID/gi, systemID);\n    });\n\n    // Reset undo/redo\n    tripwire.signatures.undo[systemID] && tripwire.signatures.undo[systemID].length > 0 ? $(\"#undo\").removeClass(\"disabled\") : $(\"#undo\").addClass(\"disabled\");\n    tripwire.signatures.redo[systemID] && tripwire.signatures.redo[systemID].length > 0 ? $(\"#redo\").removeClass(\"disabled\") : $(\"#redo\").addClass(\"disabled\");\n\n    // Reset delete signature icon\n    $(\"#sigTable tr.selected\").length == 0 ? $(\"#signaturesWidget #delete-signature\").addClass(\"disabled\") : $(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\n}\ntripwire.systemChange(viewingSystemID, \"init\");\n","var tutorial;\n\n// infoWidget\n$(\"#infoWidget .tutorial\").click(function() {\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        steps: [\n            {\n                element: document.querySelector(\"#infoWidget\"),\n                intro: \"<h4>System information widget</h4><br/><p>Displays information on the currently <b>selected</b> Tripwire system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoGeneral\"),\n                intro: \"<p>This section includes:<br/>System Name<br/>Security Rating<br/>Region<br/>Owning Faction Name</p><br/><p>If the selected system is a wormhole with a system effect, that will also be shown - hover over it to view the effect breakdown.</p>\"\n            },\n            {\n                element: document.querySelector(\"#activityGraph\"),\n                intro: \"<p>This is the graph containing historical ship jump and kill information from the EVE API.</p><br/><p>This data is only available for K-Space systems and not wormhole systems.</p><br/><p>The EVE API updates this data each hour, so this graph will update itself at the top of every hour.</p>\"\n            },\n            {\n                element: $(\"#activityGraph svg > g > g:nth-child(5)\")[0],\n                intro: \"<p>Each category can be toggled by clicking these keys to drill down the graph into finer detail.</p>\"\n            },\n            {\n                element: document.querySelector(\"#activityGraphControls\"),\n                intro: \"<p>Select different lengths of historical data to adjust the graph to display more or less information.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoStatics\"),\n                intro: \"<p>If a wormhole system is selected, the publicaly known static wormholes will appear here.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoLinks\"),\n                intro: \"<p>These are some quick links to various sites for this specific system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#system-favorite\"),\n                intro: \"<p>This toggles wether this is a 'favorite' system, orange is active.</p><br/><p>'Favorite' systems can be rendered in the chain map to be able to see how far away trade hub systems are from your wormhole chain K-Space exits.</p>\"\n            }\n        ]\n    }).start();\n});\n\n// signaturesWidget\n$(\"#signaturesWidget .tutorial\").click(function() {\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        steps: [\n            {\n                element: document.querySelector(\"#signaturesWidget\"),\n                intro: \"<h4>System signatures widget</h4><br/><p>Displays all signatures and wormholes in the currently <b>selected</b> Tripwire system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#add-signature\"),\n                intro: \"<p>Add new signatures and wormholes manually by clicking the + icon.</p><br/><p>Copy & Paste EVE scanner results anywhere once Tripwire has focus to add or update signatures, repeated pastes will only update with new information.</p>\"\n            },\n            {\n                element: document.querySelector(\"#delete-signature\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>DELETE</b> to delete <b>selected</b> signatures from this system.</p><br/><p>Click on a row to select it, click multiple rows to delete multiple signatures at once, click a selected row again to unselect it.</p>\"\n            },\n            {\n                element: document.querySelector(\"#signature-count\"),\n                intro: \"<p>This shows the current count of signatures, including wormholes, in the selected system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#undo\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Z</b> to undo the last changes you made in this sytem (this includes clipboard pasted changes).</p><br/><p>You can undo multiple times as history is kept in the browser.</p>\"\n            },\n            {\n                element: document.querySelector(\"#redo\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Y</b> to redo the last changes you made in this system (this includes clipboard pasted changes).</p><br/><p>You can redo multiple times as history is kept in the browser.</p>\"\n            },\n            {\n                element: document.querySelector(\"#toggle-automapper\"),\n                intro: \"<p>Click here to toggle the Auto-mapper feature on (orange) or off.</p><br/><p>This feature only works when an in-game character is being actively tracked, otherwise this icon appears disabled.</p><br/><p>The automapper will watch for a change in your in-game system not via a star gate and try to automatically add or update wormholes.</p><br/><p>First it tries to seach for wormholes already added but missing a leads to system, this includes via wormhole type (B274) or with a leads to of 'High-Sec' for example.</p><br/><p>Next it searches for wormholes without any type or leads to at all.</p><br/><p>Finally if there are no wormholes or they all have a leads to system already, it will add a new wormhole.</p><br/><p>If at any time if finds multiple wormholes it can update, a dialog window will appear asking which wormhole you want to update.</p>\"\n            },\n            {\n                element: document.querySelector(\"#sigTable\"),\n                intro: \"<p>Each column can be sorted by clicking the column label, sort by multiple columns by holding the shift key.</p><br/><p>Right-click a column to change the text-alignment.</p>\"\n            }\n        ]\n    }).start();\n});\n\n// notesWidget\n$(\"#notesWidget .tutorial\").click(function(e) {\n    e.preventDefault();\n\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        exitOnEsc: false,\n        exitOnOverlayClick: false,\n        skipLabel: \"Abort\",\n        steps: [\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<h4>System notes widget</h4><br/><p>Displays comments based on the currently <b>selected</b> Tripwire system.</p><br/><p>The rest of this tutorial will guide you through actually adding a comment, but don't worry we will switch you to your private Tripwire mask so we don't disturb anyone else.</p><br/><p>When you finish or leave this tutorial we will switch you back to your previous Tripwire mask.</p>\"\n            },\n            {\n                element: document.querySelector(\"#add-comment\"),\n                intro: \"<p>Now click the + icon to begin adding a new comment in this system (\" + viewingSystem + \").</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Type some basic text now and click save.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>This is our newly created comment. Hover over the comment with your mouse to see additional information and controls.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>You can click the 'pin' or 'sticky' button to toggle showing this comment for every system, not just this system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Use the <b>Edit</b> to modify a comment and <b>Delete</b> to remove a comment.</p><br/><p>You can also quickly edit any comment by simply doubling clicking anywhere on it.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Click on the <b>Edit</b> now on our comment.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>The toolbar at the top allows you to customize your notes.</p><br/><p>You can also click on the <b>Maximize/Minimize</b> button (the far right toolbar icon) to edit this comment in full screen mode.</p><br/><p>In full screen mode you will see 1 new button added to the toolbar to view the source code of the comment where you can write HTML, CSS, and even Javascript in your notes!</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>This concludes the tutorial, we will now switch you back to your previous Tripwire mask and delete the comment we created.</p>\"\n            }\n        ]\n    }).start();\n\n    tutorial.onchange(function(element) {\n        switch(tutorial._currentStep) {\n            case 1:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n\n                console.log(\"switch mask to private\");\n                tutorial.previousMask = options.masks.active;\n                options.masks.active = options.character.id + \".1\";\n                options.save();\n\n                tutorial.stepFunc = function() {\n                    setTimeout(function() {\n                        tutorial._options.steps[2].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(3);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget #add-comment\").on(\"click\", tutorial.stepFunc);\n                break;\n            case 2:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n                $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\n\n                tutorial.stepFunc = function() {\n                    tutorial.comment = $(this).closest(\".comment\");\n                    setTimeout(function() {\n                        tutorial._options.steps[3].element = tutorial.comment[0];\n                        tutorial._options.steps[4].element = tutorial.comment.find(\".commentSticky\")[0];\n                        tutorial._options.steps[5].element = tutorial.comment.find(\".commentControls\")[0];\n                        tutorial._options.steps[6].element = tutorial.comment.find(\".commentControls\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(4);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget\").on(\"click\", \".commentSave\", tutorial.stepFunc);\n                break;\n            case 6:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n                $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\n\n                tutorial.stepFunc = function() {\n                    setTimeout(function() {\n                        tutorial._options.steps[7].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial._options.steps[8].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(8);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget\").on(\"click\", \".commentEdit\", tutorial.stepFunc);\n                break;\n        }\n    });\n\n    tutorial.onexit(function() {\n        if (tutorial.exiting) {\n            $(\".commentCancel:visible\").click();\n            // delete the tutorial comment that was created\n            if (tutorial.comment) {\n                var data = {\"mode\": \"delete\", \"commentID\": tutorial.comment.data(\"id\")};\n\n                $.ajax({\n                    url: \"comments.php\",\n                    type: \"POST\",\n                    data: data,\n                    dataType: \"JSON\"\n                }).done(function(data) {\n                    if (data && data.result == true) {\n                        tutorial.comment.remove();\n                    }\n                });\n            }\n\n            if (tutorial.previousMask) {\n                setTimeout(function() {\n                    console.log(\"change mask back, delete comment\", tutorial.previousMask);\n                    options.masks.active = tutorial.previousMask;\n                    options.save();\n                }, 200);\n            }\n\n            // remove event listeners\n            $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".commentEdit\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".cke_toolgroup:has(.cke_button__toolbarswitch)\", tutorial.stepFunc);\n        }\n    });\n\n    tutorial.previousMask;\n    tutorial.comment;\n    tutorial.stepFunc;\n    tutorial.exiting = true;\n});\n","tripwire.undo = function() {\n    if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n        $(\"#undo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.undo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var undoItem = tripwire.signatures.undo[viewingSystemID][lastIndex];\n        var redo = $.map(undoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(undoItem.action) {\n            case \"add\":\n                data.signatures.remove = data.signatures.remove.concat($.map(undoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"remove\":\n                data.signatures.add = data.signatures.add.concat(undoItem.signatures);\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(undoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.undo[viewingSystemID].pop();\n\n                $(\"#redo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.redo) {\n                    if (undoItem.action == \"remove\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": data.results});\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": redo});\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": undoItem.signatures});\n                    }\n                } else {\n                    if (undoItem.action == \"remove\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": data.results}];\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": redo}];\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": undoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n                $(\"#undo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","var activity = new function() {\n\tthis.graph;\n\tthis.options;\n\tthis.view;\n\tthis.span = 24;\n\tthis.columns = [\n\t\t{id: \"time\", label: \"Time\", role: \"domain\", type: \"string\", calc: function(d, r) { return d.getValue(r, 0) + \"h\"; }},\n\t\t{id: \"jumps\", label: \"Jumps\", role: \"data\", type: \"number\", sourceColumn: 1, column: 1, title: \"Jumps\"},\n\t\t{id: \"podkills\", label: \"Pod Kills\", role: \"data\", type: \"number\", sourceColumn: 2, column: 2, title: \"Pod Kills\"},\n\t\t{id: \"shipkills\", label: \"Ship Kills\", role: \"data\", type: \"number\", sourceColumn: 3, column: 3, title: \"Ship Kills\"},\n\t\t{id: \"npckills\", label: \"NPC Kills\", role: \"data\", type: \"number\", sourceColumn: 4, column: 4, title: \"NPC Kills\"},\n\t\t//{id: \"annotationLabel\", label: \"Test\", role: \"annotation\", type: \"string\", sourceColumn: 5, title: \"Test\"},\n\t\t//{id: \"annotationText\", label: \"Test\", role: \"annotationText\", type: \"string\", sourceColumn: 6, title: \"Test\"}\n\t];\n\n\tthis.getData = function(span, cache) {\n\t\tvar span = typeof(span) !== \"undefined\" ? span : this.span;\n\t\tvar cache = typeof(cache) !== \"undefined\" ? cache : true;\n\n\t\t// Google hasn't finished loading yet\n\t\tif (!activity.graph) {\n\t\t\t\tsetTimeout(function() {activity.getData(span, cache)}, 500);\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn $.ajax({\n\t\t\turl: \"activity_graph.php\",\n\t\t\tdata: {systemID: viewingSystemID, time: span},\n\t\t\ttype: \"GET\",\n\t\t\tdataType: \"JSON\",\n\t\t\tcache: cache\n\t\t}).done(function(json) {\n\t\t\tif (json) {\n\t\t\t\tjson.rows.reverse();\n\t\t\t\tactivity.view = new google.visualization.DataView(new google.visualization.DataTable(json));\n\t\t\t\tactivity.view.setColumns(activity.columns);\n\t\t\t\tactivity.graph.draw(activity.view, activity.options);\n\t\t\t}\n\t\t});\n\t};\n\n\tthis.selectHandler = function() {\n\t\tvar selections = activity.graph.getSelection();\n\n\t\tif (selections[0] && selections[0].row == null) {\n\t\t\tvar c = selections[0].column;\n\n\t\t\tif (activity.columns[c].sourceColumn) {\n\t\t\t\t//activity.columns[c].calc = function() { return null };\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title + \" (off)\";\n\t\t\t\tdelete activity.columns[c].sourceColumn;\n\t\t\t} else {\n\t\t\t\tactivity.columns[c].sourceColumn = activity.columns[c].column;\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title;\n\t\t\t\t//delete activity.columns[c].calc;\n\t\t\t}\n\n\t\t\tactivity.view.setColumns(activity.columns);\n\t\t\tactivity.options.animation.duration = 0;\n\t\t\tactivity.graph.draw(activity.view, activity.options);\n\t\t\tactivity.options.animation.duration = 500;\n\t\t}\n\t}\n\n\tthis.init = function() {\n\t\tactivity.graph = new google.visualization.AreaChart(document.getElementById(\"activityGraph\"));\n\t\tactivity.options = {\n\t\t\tisStacked: false,\n\t\t\tbackgroundColor: \"transparent\",\n\t\t\thAxis: {textStyle: {color: \"#999\", fontName: \"Verdana\", fontSize: 10}, showTextEvery: 3},\n\t\t\tvAxis: {textStyle: {color: \"#666\", fontName: \"Verdana\", fontSize: 10}, viewWindowMode: \"maximized\", viewWindow: {min: 0}, maxValue: 5},\n\t\t\tgridlineColor: \"#454545\",\n\t\t\tpointSize: 2,\n\t\t\tlineWidth: 1,\n\t\t\tchartArea: {left: \"10%\", top: \"5%\", width: \"88%\", height: \"85%\"},\n\t\t\tlegend: {position: \"in\", textStyle: {color: \"#CCC\", fontName: \"Verdana\", fontSize: 8.5}},\n\t\t\tanimation: {duration: 500, easing: \"inAndout\"},\n\t\t\ttooltip: {showColorCode: true},\n\t\t\tannotations: {style: \"line\", textStyle: {fontSize: 12, color: \"#ccc\"}, domain: 0},\n\t\t\tfocusTarget: \"category\"\n\t\t}\n\n\t\tgoogle.visualization.events.addListener(activity.graph, \"select\", activity.selectHandler);\n\n\t\tactivity.getData(activity.span);\n\t}\n\n\tthis.time = function(span) {\n\t\tswitch(span) {\n\t\t\tcase 24:\n\t\t\t\tthis.options.hAxis.showTextEvery = 3;\n\t\t\t\tbreak;\n\t\t\tcase 48:\n\t\t\t\tthis.options.hAxis.showTextEvery = 6;\n\t\t\t\tbreak;\n\t\t\tcase 168:\n\t\t\t\tthis.options.hAxis.showTextEvery = 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.span = span;\n\t\tthis.getData(span);\n\t}\n\n\tthis.redraw = function() {\n\t\tthis.graph.draw(this.view, this.options);\n\t}\n\n\tthis.refresh = function(cache) {\n\t\tthis.getData(this.span, cache);\n\t}\n\n\tgoogle.charts.setOnLoadCallback(this.init);\n}\n","var CKConfig = {\n\tskin: \"custom\",\n\theight: 100,\n\tallowedContent: true,\n\textraPlugins: \"toolbarswitch,autogrow,autolink\",\n\tenterMode: CKEDITOR.ENTER_BR,\n\tremoveDialogTabs: 'link:advanced',\n\tautoGrow_onStartup: true,\n\tautoGrow_minHeight: 100,\n\ttoolbar_minToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\"]},\n\t\t{name: \"paragraph\", items: [\"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\"]},\n\t\t{name: \"tools\", items: [\"Toolbarswitch\"]}\n\t],\n\ttoolbar_maxToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"Subscript\", \"Superscript\"]},\n\t\t{name: \"paragraph\", items: [\"NumberedList\", \"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\", \"Font\"]},\n\t\t{name: \"tools\", items: [\"Source\", \"Toolbarswitch\"]}\n\t],\n\ttoolbar: \"minToolbar\",\n\tsmallToolbar: \"minToolbar\",\n\tmaximizedToolbar: \"maxToolbar\",\n\tfontSize_style: {\n\t    element:        'span',\n\t    styles:         { 'font-size': '#(size)' },\n\t    overrides:      [ { element :'font', attributes: { 'size': null } } ]\n\t}\n}\n\nCKEDITOR.on(\"instanceLoaded\", function(cke) {\n\tcke.editor.on(\"contentDom\", function() {\n\t\tcke.editor.on(\"key\", function(e) {\n\t\t\tif (e.data.keyCode == 27) {\n\t\t\t\t// escape key cancels\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentCancel\").click();\n\t\t\t\treturn false;\n\t\t\t} else if (e.data.domEvent.$.altKey && e.data.domEvent.$.keyCode == 83) {\n\t\t\t\t// alt+s saves\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentSave\").click();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n\n\t$(\".cke_combo__font a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n\n\t$(\".cke_combo__fontsize a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n});\n\nCKEDITOR.on(\"instanceReady\", function(cke) {\n\t// ensure focus on init\n\tcke.editor.focus();\n\n\tvar s = cke.editor.getSelection(); // getting selection\n\tvar selected_ranges = s.getRanges(); // getting ranges\n\tvar node = selected_ranges[0].startContainer; // selecting the starting node\n\tvar parents = node.getParents(true);\n\n\tnode = parents[parents.length - 2].getFirst();\n\n\tif (!node) return false;\n\n\twhile (true) {\n\t\tvar x = node.getNext();\n\t\tif (x == null) {\n\t\t\tbreak;\n\t\t}\n\t\tnode = x;\n\t}\n\n\ts.selectElement(node);\n\tselected_ranges = s.getRanges();\n\tselected_ranges[0].collapse(false);  //  false collapses the range to the end of the selected node, true before the node.\n\ts.selectRanges(selected_ranges);  // putting the current selection there\n});\n\nCKEDITOR.on(\"dialogDefinition\", function(ev) {\n\tif (ev.data.name == 'link') {\n\t\tev.data.definition.getContents('target').get('linkTargetType')['default'] = '_blank';\n\t}\n});\n","$(\"#admin\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"disabled\")) {\n\t\treturn false;\n\t}\n\n\tif (!$(\"#dialog-admin\").hasClass(\"ui-dialog-content\")) {\n\t\tvar refreshTimer = null;\n\t\tvar $total = null;\n\t\tvar $ajax = null;\n\n\t\tfunction refreshWindow() {\n\t\t\tif ($ajax) $ajax.abort();\n\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\n\n\t\t\t$ajax = $.ajax({\n\t\t\t\turl: \"admin.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: {mode: $(\"#dialog-admin .menu .active\").attr(\"data-window\")},\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.results) {\n\t\t\t\t\tvar rows = data.results;\n\t\t\t\t\tvar ids = [];\n\n\t\t\t\t\tfor (var i = 0, l = rows.length; i < l; i++) {\n\t\t\t\t\t\tvar $row = $(\"#dialog-admin .window .hasFocus tbody tr[data-id='\"+ rows[i].id +\"']\");\n\t\t\t\t\t\tids.push(rows[i].id);\n\n\t\t\t\t\t\tif ($row.length) {\n\t\t\t\t\t\t\tfor (col in rows[i]) {\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$row = $(\"#dialog-admin .window .hasFocus table tr.hidden\").clone();\n\t\t\t\t\t\t\t$row.attr(\"data-id\", rows[i].id);\n\n\t\t\t\t\t\t\tfor (col in rows[i]) {\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$row.removeClass(\"hidden\");\n\n\t\t\t\t\t\t\t$(\"#dialog-admin .window .hasFocus tbody\").append($row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").each(function() {\n\t\t\t\t\t\tif ($.inArray($(this).data(\"id\").toString(), ids) == -1) {\n\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table\").trigger(\"update\", [true]);\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").remove();\n\t\t\t\t}\n\n\t\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\n\t\t\t});\n\n\t\t\tif ($(\"#dialog-admin\").dialog(\"isOpen\") && $(\"#dialog-admin .menu .active\").attr(\"data-refresh\")) {\n\t\t\t\trefreshTimer = setTimeout(refreshWindow, $(\"#dialog-admin .menu .active\").attr(\"data-refresh\"));\n\t\t\t}\n\t\t}\n\n\t\t$(\"#dialog-admin\").dialog({\n\t\t\tautoOpen: true,\n\t\t\tmodal: true,\n\t\t\theight: 350,\n\t\t\twidth: 800,\n\t\t\tbuttons: {\n\t\t\t\tClose: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t// menu toggle\n\t\t\t\t$(\"#dialog-admin\").on(\"click\", \".menu li\", function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$menuItem = $(this);\n\t\t\t\t\tclearTimeout(refreshTimer);\n\n\t\t\t\t\t$(\"#dialog-admin .menu .active\").removeClass(\"active\");\n\t\t\t\t\t$menuItem.addClass(\"active\");\n\t\t\t\t\t$(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\").html(\"\");\n\n\t\t\t\t\t$(\"#dialog-admin .window [data-window]\").removeClass(\"hasFocus\").hide();\n\t\t\t\t\t$(\"#dialog-admin .window [data-window='\"+ $menuItem.data(\"window\") +\"']\").addClass(\"hasFocus\").show();\n\n\t\t\t\t\trefreshWindow();\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-admin [data-sortable='true']\").tablesorter({\n\t\t\t\t\tsortReset: true,\n\t\t\t\t\twidgets: ['saveSort'],\n\t\t\t\t\tsortList: [[0,0]]\n\t\t\t\t});\n\n\t\t\t\t// dialog bottom tray\n\t\t\t\t$($(this)[0].parentElement).find(\".ui-dialog-buttonpane\").append(\"<div class='ui-dialog-traypane'></div>\");\n\t\t\t\t$total = $(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\");\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$menuItem = $(\"#dialog-admin .menu li.active\");\n\t\t\t\trefreshWindow();\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tclearTimeout(refreshTimer);\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-admin\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-admin\").dialog(\"open\");\n\t}\n});\n","// Dialog effects\n$(\"#wrapper\").addClass(\"transition\");\n\n$(document).on(\"dialogopen\", \".ui-dialog\", function (event, ui) {\n\t// Add additional full screen overlay for 2nd level dialog\n\tif ($(\".ui-dialog:visible\").length == 2 && $(this).hasClass(\"dialog-modal\"))\n\t\t$(\"body\").append($(\"<div id='overlay' class='overlay' />\").css(\"z-index\", $(this).css(\"z-index\") - 1));\n\telse if ($(\"#overlay\"))\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 1);\n\n\tif (!$(this).hasClass(\"dialog-noeffect\"))\n\t\t$(\"#wrapper\").addClass(\"blur\");\n});\n\n$(document).on(\"dialogclose\", \".ui-dialog\", function (event, ui) {\n\tif (!$(\".ui-dialog\").is(\":visible\"))\n\t\t$(\"#wrapper\").removeClass(\"blur\");\n\n\tif ($(\".ui-dialog:visible\").length == 1)\n\t\t$(\"#overlay\").remove();\n\telse if ($(\"#overlay\"))\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 2);\n\n\t//if ($(\".ui-dialog:visible\").length == 0 && options.buttons.follow && viewingSystemID != tripwire.client.EVE.systemID)\n\t//\twindow.location = \"?system=\"+tripwire.client.EVE.systemName;\n});\n\n// Signature overwrite\n$(document).on(\"click\", \"#overwrite\", function() {\n\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\n\tvar undo = [];\n\n\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\n\tif (signature.type != \"wormhole\") {\n\t\tundo.push(signature);\n\t\tpayload.signatures.remove.push(signature.id);\n\t} else {\n\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\n\t\tpayload.signatures.remove.push(wormhole);\n\t}\n\n\t$(\"#overwrite\").attr(\"disable\", true);\n\n\tvar success = function(data) {\n\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\tValidationTooltips.close();\n\n\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n\t\t\t} else {\n\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n\t\t\t}\n\n\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\n\t\t\tif ($(\"#dialog-signature\").parent().find(\":button:contains('Save')\")) {\n\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click();\n\t\t\t} else {\n\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click();\n\t\t\t}\n\t\t}\n\t}\n\n\tvar always = function() {\n\t\t$(\"#overwrite\").removeAttr(\"disable\");\n\t}\n\n\ttripwire.refresh('refresh', payload, success, always);\n});\n","$(\".options\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"disabled\"))\n\t\treturn false;\n\n\t$(\"#dialog-options\").dialog({\n\t\tautoOpen: false,\n\t\twidth: 450,\n\t\tminHeight: 400,\n\t\tmodal: true,\n\t\tbuttons: {\n\t\t\tSave: function() {\n\t\t\t\t// Options\n\t\t\t\tvar data = {mode: \"set\", options: JSON.stringify(options)};\n\t\t\t\tvar maskChange = false;\n\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\n\n\t\t\t\toptions.chain.typeFormat = $(\"#dialog-options #typeFormat\").val();\n\t\t\t\toptions.chain.classFormat = $(\"#dialog-options #classFormat\").val();\n\t\t\t\t\n\t\t\t\toptions.chain.sigNameLocation = $(\"#dialog-options #chainSigNameLocation\").val();\n\t\t\t\toptions.chain.routingLimit = 1 * $(\"#dialog-options #chainRoutingLimit\").val();\n\t\t\t\toptions.chain.routeSecurity = $(\"#dialog-options #chainRouteSecurity\").val();\n\t\t\t\toptions.chain.routeIgnore.enabled = $(\"#dialog-options #route-ignore-enabled\").prop('checked');\n\t\t\t\toptions.chain.routeIgnore.systems = $(\"#dialog-options #route-ignore\").val().split(\",\").map(x => x.trim());\n\n\t\t\t\toptions.chain.gridlines = JSON.parse($(\"#dialog-options input[name=gridlines]:checked\").val());\n\n\t\t\t\toptions.chain[\"node-reference\"] = $(\"#dialog-options input[name=node-reference]:checked\").val();\n\t\t\t\t\n\t\t\t\toptions.chain.renderer = $(\"#dialog-options #renderer\").val();\n\n\t\t\t\toptions.signatures.editType = $(\"#dialog-options #editType\").val();\n\n\t\t\t\toptions.signatures.pasteLife = $(\"#dialog-options #pasteLife\").val();\n\n\t\t\t\toptions.signatures.copySeparator = $(\"#dialog-options #copySeparator\").val();\n\n\t\t\t\toptions.background = $(\"#dialog-options #background-image\").val();\n\n\t\t\t\toptions.uiscale = $(\"#dialog-options #uiscale-slider\").slider(\"value\");\n\n\t\t\t\tif (options.masks.active != $(\"#dialog-options input[name='mask']:checked\").val()) {\n\t\t\t\t\tmaskChange = true;\n\t\t\t\t}\n\n\t\t\t\toptions.masks.active = $(\"#dialog-options input[name='mask']:checked\").val();\n\n\t\t\t\toptions.apply();\n\t\t\t\toptions.save() // Performs AJAX\n\t\t\t\t\t.done(function() {\n\t\t\t\t\t\tif (maskChange) {\n\t\t\t\t\t\t\t// Reset signatures\n\t\t\t\t\t\t\t$(\"#sigTable span[data-age]\").countdown(\"destroy\");\n\t\t\t\t\t\t\t$(\"#sigTable tbody\").empty()\n\t\t\t\t\t\t\t$(\"#signature-count\").html(0);\n\t\t\t\t\t\t\ttripwire.signatures.list = {};\n\t\t\t\t\t\t\ttripwire.client.signatures = [];\n\n\t\t\t\t\t\t\ttripwire.refresh('change');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", false).removeClass(\"ui-state-disabled\");\n\n\t\t\t\t// toggle mask admin icon\n\t\t\t\t$(\"#dialog-options input[name='mask']:checked\").data(\"admin\") ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t},\n\t\t\tReset: function() {\n\t\t\t\t$(\"#dialog-confirm #msg\").html(\"Settings will be reset to defaults temporarily.<br/><br/><p><em>Save settings to make changes permanent.</em></p>\");\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tReset: function() {\n\t\t\t\t\t\t\toptions.reset();\n\t\t\t\t\t\t\toptions.apply();\n\n\t\t\t\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t},\n\t\t\tClose: function() {\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t}\n\t\t},\n\t\topen: function() {\n\t\t\t// Get user stats data\n\t\t\t$.ajax({\n\t\t\t\turl: \"user_stats.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tfor (i in data.stats) {\n\t\t\t\t\tfor (x in data.stats[i]) {\n\t\t\t\t\t\t$(\"#optionsAccordion #\"+ x).text(data.stats[i][x]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$(\"#optionsAccordion #systems_visited\").text(data.system_visits);\n\t\t\t\t$(\"#optionsAccordion #logins\").text(data.account.logins);\n\t\t\t\t$(\"#optionsAccordion #lastLogin\").text(data.account.lastLogin);\n\t\t\t\t$(\"#optionsAccordion #username\").text(data.username);\n\t\t\t});\n\n\t\t\t// Get masks\n\t\t\t$.ajax({\n\t\t\t\turl: \"masks.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(response) {\n\t\t\t\tif (response && response.masks) {\n\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\n\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\n\n\t\t\t\t\tfor (var x in response.masks) {\n\t\t\t\t\t\tvar mask = response.masks[x];\n\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\n\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\n\n\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\n\n\t\t\t\t\tif (init.admin == \"1\") {\n\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\n\n\t\t\t\t\t// toggle mask admin icon\n\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#dialog-options #editType\").val(options.signatures.editType);\n\t\t\t$(\"#dialog-options #pasteLife\").val(options.signatures.pasteLife);\n\t\t\t$(\"#dialog-options #copySeparator\").val(options.signatures.copySeparator);\n\t\t\t$(\"#dialog-options #typeFormat\").val(options.chain.typeFormat);\n\t\t\t$(\"#dialog-options #chainRoutingLimit\").val(options.chain.routingLimit);\n\t\t\t$(\"#dialog-options #chainSigNameLocation\").val(options.chain.sigNameLocation);\n\t\t\t$(\"#dialog-options #chainRouteSecurity\").val(options.chain.routeSecurity);\n\t\t\t$(\"#dialog-options #route-ignore-enabled\").prop('checked', options.chain.routeIgnore.enabled);\n\t\t\t$(\"#dialog-options #route-ignore\").val(options.chain.routeIgnore.systems.join(','));\n\t\t\t$(\"#dialog-options #renderer\").val(options.chain.renderer);\n\t\t\t$(\"#dialog-options #classFormat\").val(options.chain.classFormat);\n\t\t\t$(\"#dialog-options input[name='node-reference'][value='\"+options.chain[\"node-reference\"]+\"']\").prop(\"checked\", true);\n\t\t\t$(\"#dialog-options input[name='gridlines'][value='\"+options.chain.gridlines+\"']\").prop(\"checked\", true);\n\t\t\t$(\"#dialog-options #background-image\").val(options.background);\n\t\t},\n\t\tcreate: function() {\n\t\t\t$(\"#optionsAccordion\").accordion({heightStyle: \"content\", collapsible: true, active: false});\n\n\t\t\t$(\"#uiscale-slider\").slider({\n\t\t\t\tmin: 0.7,\n\t\t\t\tmax: 1.4,\n\t\t\t\tstep: 0.05,\n\t\t\t\tvalue: options.uiscale || 1.0,\n\t\t\t\tchange: function(e, ui) {\n\t\t\t\t\t$(\"body\").css(\"zoom\", ui.value);\n\t\t\t\t},\n\t\t\t\tslide: function(e, ui) {\n\t\t\t\t\t$(\"label[for='uiscale-slider']\").html(ui.value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"label[for='uiscale-slider']\").html($(\"#uiscale-slider\").slider(\"value\"));\n\n\t\t\t$(\"#dialog-pwChange\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tminHeight: 0,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#pwForm\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#pwForm input[name='password'], #pwForm input[name='confirm']\").val(\"\");\n\t\t\t\t\t$(\"#pwError\").text(\"\").hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#pwChange\").click(function() {\n\t\t\t\t$(\"#dialog-pwChange\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#pwForm\").submit(function(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$(\"#pwError\").text(\"\").hide();\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"options.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(response) {\n\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Password changed\");\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\n\n\t\t\t\t\t\t$(\"#dialog-pwChange\").dialog(\"close\");\n\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t$(\"#pwError\").text(response.error).show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#pwError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$(\"#dialog-usernameChange\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tminHeight: 0,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#usernameForm\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\t$(\"#usernameForm #username\").html($(\"#dialog-options #username\").html());\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#usernameForm [name='username']\").val(\"\");\n\t\t\t\t\t$(\"#usernameError\").text(\"\").hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#usernameChange\").click(function() {\n\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#usernameForm\").submit(function(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$(\"#usernameError\").text(\"\").hide();\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"options.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(response) {\n\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Username changed\");\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\n\n\t\t\t\t\t\t$(\"#dialog-options #username\").html(response.result);\n\n\t\t\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"close\");\n\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t$(\"#usernameError\").text(response.error).show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#usernameError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Mask selections\n\t\t\t$(\"#masks\").on(\"change\", \"input.selector:checked\", function() {\n\t\t\t\tif ($(this).data(\"owner\")) {\n\t\t\t\t\t$(\"#maskControls #edit\").removeAttr(\"disabled\");\n\t\t\t\t\t$(\"#maskControls #delete\").removeAttr(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#maskControls #edit\").attr(\"disabled\", \"disabled\");\n\t\t\t\t\t$(\"#maskControls #delete\").attr(\"disabled\", \"disabled\");\n\t\t\t\t}\n\n\t\t\t\tif ($(this).val() != 0.0 && $(this).val().split(\".\")[1] == 0) {\n\t\t\t\t\t$(\"#dialog-options #leave\").removeAttr(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#dialog-options #leave\").attr(\"disabled\", \"disabled\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Mask join\n\t\t\t$(\"#dialog-joinMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tAdd: function() {\n\t\t\t\t\t\tvar mask = $(\"#dialog-joinMask #results input:checked\");\n\t\t\t\t\t\tvar label = $(\"#dialog-joinMask #results input:checked+label\");\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: {mask: mask.val(), mode: \"join\"},\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\tlabel.css(\"width\", \"\");\n\t\t\t\t\t\t\t\tlabel.find(\".info\").remove();\n\t\t\t\t\t\t\t\tlabel.append('<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>');\n\n\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+response.type+\" input.selector:last\").before(mask).before(label);\n\t\t\t\t\t\t\t\t$(\"#dialog-joinMask\").dialog(\"close\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-joinMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\n\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").show();\n\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").attr(\"disabled\", \"disabled\");\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t\tif (response && response.results && response.results.length) {\n\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.eveIDs)\n\t\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar mask = response.results[x];\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+mask.mask+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"false\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+mask.mask+'\" style=\"width: 100%; margin-left: -5px;\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+mask.label+'</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].category == \"character\" ? results[x].corporation.name +'<br/>' : null)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-joinMask #results\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(function() {\n\t\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").hide();\n\t\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\n\t\t\t\t\t$(\"#dialog-joinMask input[name='name']\").val(\"\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \"input[name='find']+label\", function() {\n\t\t\t\t$(\"#dialog-joinMask input[name='find']\").val($(this).prev().val());\n\t\t\t\t$(\"#dialog-joinMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t// Mask leave\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \".closeIcon\", function() {\n\t\t\t\tvar mask = $(this).closest(\"input.selector+label\").prev();\n\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to remove this mask?\");\n\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tRemove: function() {\n\t\t\t\t\t\t\tvar send = {mode: \"leave\", mask: mask.val()};\n\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\tdata: send,\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t\tmask.next().remove();\n\t\t\t\t\t\t\t\t\tmask.remove();\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t});\n\n\t\t\t// Mask delete\n\t\t\t$(\"#maskControls #delete\").click(function() {\n\t\t\t\tvar mask = $(\"#masks input.selector:checked\");\n\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to delete this mask?\");\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tDelete: function() {\n\t\t\t\t\t\t\tvar send = {mode: \"delete\", mask: mask.val()};\n\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\tdata: send,\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t\tmask.next().remove();\n\t\t\t\t\t\t\t\t\tmask.remove();\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t});\n\n\t\t\t// User Create mask\n\t\t\t$(\"#dialog-createMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tCreate: function() {\n\t\t\t\t\t\t$(\"#dialog-createMask form\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \"#create_add+label\", function() {\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-createMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t// Get masks\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\t\tif (response && response.masks) {\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\n\n\t\t\t\t\t\t\t\t\t\tfor (var x in response.masks) {\n\t\t\t\t\t\t\t\t\t\t\tvar mask = response.masks[x];\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\n\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\n\n\t\t\t\t\t\t\t\t\t\tif (init.admin == \"1\") {\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\n\n\t\t\t\t\t\t\t\t\t\t// toggle mask admin icon\n\t\t\t\t\t\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"close\");\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-createMask select\").selectmenu({width: 100});\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\t$(\"#dialog-createMask input[name='name']\").val(\"\");\n\t\t\t\t\t$(\"#dialog-createMask #accessList :not(.static)\").remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#maskControls #create\").click(function() {\n\t\t\t\t$(\"#dialog-createMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \".maskRemove\", function() {\n\t\t\t\t$(this).closest(\"input.selector+label\").prev().remove();\n\t\t\t\t$(this).closest(\"label\").remove();\n\t\t\t});\n\n\t\t\t$(\"#dialog-editMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#dialog-editMask form\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \".maskRemove\", function() {\n\t\t\t\t\t\t$(this).closest(\"input.selector+label\").prev().attr(\"name\", \"deletes[]\").hide();\n\t\t\t\t\t\t$(this).closest(\"label\").hide();\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \"#edit_add+label\", function() {\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-editMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask\").dialog(\"close\");\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\tvar mask = $(\"#dialog-options input[name='mask']:checked\").val();\n\t\t\t\t\t$(\"#dialog-editMask input[name='mask']\").val(mask);\n\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").hide();\n\t\t\t\t\t$(\"#dialog-editMask #loading\").show();\n\t\t\t\t\t$(\"#dialog-editMask #name\").text($(\"#dialog-options input[name='mask']:checked+label .selector_label\").text());\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\tdata: {mode: \"edit\", mask: mask},\n\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\tif (response && response.results && response.results.length) {\n\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.results)\n\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_1373\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\n\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_2\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").show();\n\t\t\t\t\t\t$(\"#dialog-editMask #loading\").hide();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#dialog-editMask #accessList :not(.static)\").remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#maskControls #edit\").click(function() {\n\t\t\t\t$(\"#dialog-editMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t// EVE search dialog\n\t\t\t$(\"#dialog-EVEsearch\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tAdd: function() {\n\t\t\t\t\t\tif ($(\"#accessList input[value='\"+$(\"#EVESearchResults input\").val()+\"']\").length) {\n\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Already has access\");\n\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$(\"#EVESearchResults .info\").append('<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />');\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"checked\", \"checked\");\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"onclick\", \"return false\");\n\n\t\t\t\t\t\tvar nodes = $(\"#EVESearchResults .maskNode:has(input:checked)\");\n\n\t\t\t\t\t\tif ($(\"#dialog-createMask\").dialog(\"isOpen\"))\n\t\t\t\t\t\t\t$(\"#dialog-createMask #accessList .static:first\").before(nodes);\n\t\t\t\t\t\telse if ($(\"#dialog-editMask\").dialog(\"isOpen\"))\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(nodes);\n\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t},\n\t\t\t\t\tClose: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#EVEsearch\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif ($(\"#EVEsearch input[name='name']\").val() == \"\") {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\n\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").show();\n\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").attr(\"disabled\", \"disabled\");\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\n\n\t\t\t\t\t\ttripwire.esi.search($(\"#EVEsearch input[name='name']\").val(), $(\"#EVEsearch input[name='category']:checked\").val(), $(\"#EVEsearch input[name='exact']\")[0].checked)\n\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\tif (results && (results.character || results.corporation)) {\n\t\t\t\t\t\t\t\t\t// limit results\n\t\t\t\t\t\t\t\t\tresults = $.merge(results.character || [], results.corporation || []);\n\t\t\t\t\t\t\t\t\ttotal = results.length;\n\t\t\t\t\t\t\t\t\tresults = results.slice(0, 10);\n\t\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(results)\n\t\t\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchCount\").html(\"Found: \"+total+\"<br/>Showing: \"+(total<10?total:10));\n\t\t\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_1373\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_2\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"No Results\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#EVEsearch input[name='name']\").val(\"\");\n\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n\t$(\"#dialog-options\").dialog(\"open\");\n});\n","\t\t$(\"#dialog-ping\").dialog({\n\t\t\tautoOpen: false,\n\t\t\theight: \"auto\",\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tSend: function() {\n\t\t\t\t\tvar payload = {systemName: this.systemName, systemText: this.systemText, message: $('#ping-text').val() };\n\t\t\t\t\tconst _this = this;\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: \"ping.php\",\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\tdata: payload,\n\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t}).done(function(data) {\t$(_this).dialog(\"close\"); })\n\t\t\t\t\t.error(function(data) { alert((data && data.error) ? data.error : data); });\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t},\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\tconst wormholeID = $(this).data(\"id\");\n\t\t\t\tconst systemID = $(this).data(\"systemID\");\n\t\t\t\tconst wormhole = tripwire.client.wormholes[wormholeID];\n\t\t\t\tconst fromSignature = wormhole ? tripwire.client.signatures[wormhole.initialID] : { name: null};\n\t\t\t\t\n\t\t\t\tthis.systemName = tripwire.systems[systemID].name;\n\t\t\t\tthis.systemText = this.systemName + (fromSignature.name !== null && fromSignature.name.length ? ' (' + fromSignature.name + ')' : '');\n\t\t\t\t\n\t\t\t\t$(\"#dialog-ping\").dialog(\"option\", \"title\", \"Ping about \"+this.systemText);\n\t\t\t\t$('#ping-text').val('');\n\t\t\t\t$('#ping-text').focus();\n\t\t\t}\n\t\t});","$(\"#signaturesWidget\").on(\"click\", \"#delete-signature\", function(e) {\n\te.preventDefault();\n\n\tif ($(this).closest(\"tr\").attr(\"disabled\")) {\n\t\treturn false;\n\t} else if ($(\"#sigTable tr.selected\").length == 0) {\n\t\treturn false;\n\t} else if ($(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\") && $(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-sigEdit\").parent().effect(\"shake\", 300);\n\t\treturn false;\n\t}\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-deleteSig\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-deleteSig\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tDelete: function() {\n\t\t\t\t\t// Prevent duplicate submitting\n\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"disable\");\n\t\t\t\t\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\n\t\t\t\t\tvar undo = [];\n\n\t\t\t\t\tvar signatures = $.map($(\"#sigTable tr.selected\"), function(n) {\n\t\t\t\t\t\tvar signature = tripwire.client.signatures[$(n).data(\"id\")];\n\t\t\t\t\t\tif (signature.type != \"wormhole\") {\n\t\t\t\t\t\t\tundo.push(signature);\n\t\t\t\t\t\t\treturn signature.id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\n\t\t\t\t\t\t\treturn wormhole;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tpayload.signatures.remove = signatures;\n\n\t\t\t\t\tvar success = function(data) {\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-deleteSig\").dialog(\"close\");\n\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\t\t\t\t\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar always = function(data) {\n\t\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"enable\");\n\t\t\t\t\t}\n\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t//$(\"#sigTable .sigDelete\").removeClass(\"invisible\");\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-deleteSig\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-deleteSig\").dialog(\"open\");\n\t}\n});\n","$(\"#sigTable tbody\").on(\"dblclick\", \"tr\", {mode: \"update\", source:\"sig-row\"}, openSignatureDialog);\n$(\"#edit-signature\").on(\"click\", {mode: \"update\", source:\"edit-sig\"}, openSignatureDialog);\n$(\"#add-signature\").click({mode: \"add\"}, openSignatureDialog);\n\nconst sigDialogVM = {};\nfunction openSignatureDialog(e) {\n\tif(e.preventDefault) { e.preventDefault(); }\t// Allow calls with fake event-like objects too\n\tsigDialogVM.mode = e.data.mode;\n\t\n\tswitch(sigDialogVM.mode) {\n\t\tcase 'update':\n\t\t\tif (e.data.source == \"sig-row\") {\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t$(this).closest(\"tr\").addClass(\"selected\");\n\t\t\t\tsigDialogVM.sigId = $(this).data('id');\n\t\t\t} else if (e.data.source == \"edit-sig\") {\n\t\t\t\tvar elements = $(\"#sigTable tbody tr.selected\");\n\t\t\t\tif (elements.length !== 1) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\tsigDialogVM.sigId = $(elements[0]).data('id');\n\t\t\t\t}\n\t\t\t} else { sigDialogVM.sigId = e.data.signature; }\n\t\t\tbreak;\n\t\tdefault: delete sigDialogVM.sigId;\n\t}\n\t\n\tsigDialogVM.viewingSystemID = ( sigDialogVM.sigId ) ? tripwire.client.signatures[sigDialogVM.sigId].systemID : viewingSystemID;\n\tsigDialogVM.viewingSystem = tripwire.systems[sigDialogVM.viewingSystemID];\n\n\n\t\n\tif (!$(\"#dialog-signature\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-signature\").dialog({\n\t\t\tautoOpen: true,\n\t\t\tresizable: false,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#signaturesWidget\")},\n\t\t\tbuttons: {\n\t\t\t\tSave: function() {\n\t\t\t\t\t$(\"#form-signature\").submit();\n\t\t\t\t},\n\t\t\t\tAdd: function() {\n\t\t\t\t\t$(\"#form-signature\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\tvar aSigWormholes = $.map(tripwire.wormholes, function(item, index) { return index;});\n\t\t\t\taSigWormholes.splice(26, 0, \"K162\");\n\t\t\t\taSigWormholes.push(\"GATE\");\n\t\t\t\taSigWormholes.push(\"SML\");\n\t\t\t\taSigWormholes.push(\"MED\");\n\t\t\t\taSigWormholes.push(\"LRG\");\n\t\t\t\taSigWormholes.push(\"XLG\");\n\n\t\t\t\t$(\"#dialog-signature [name='signatureType'], #dialog-signature [name='signatureLife']\").selectmenu({width: 100});\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife'], #dialog-signature [name='wormholeMass']\").selectmenu({width: 80});\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigType']\").inlinecomplete({source: aSigWormholes, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#dialog-signature #durationPicker\").durationPicker();\n\t\t\t\t$(\"#dialog-signature #durationPicker\").on(\"change\", function() {\n\t\t\t\t\t// prevent negative values\n\t\t\t\t\tif (this.value < 0) {\n\t\t\t\t\t\tthis.value = 0;\n\t\t\t\t\t\t$(this).change();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Ensure first signature ID field only accepts letters\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha'], #dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\n\t\t\t\t\twhile (!/^[a-zA-Z?]*$/g.test(this.value)) {\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Move to the numeric ID after filling out alpha ID\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha']\").on(\"input\", function() {\n\t\t\t\t\tif (this.value.length === 3) {\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric']\").select();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\n\t\t\t\t\tif (this.value.length === 3) {\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID2_Numeric']\").select();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Ensure second signature ID field only accepts numbers\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric'], #dialog-signature [name='signatureID2_Numeric']\").on(\"input\", function() {\n\t\t\t\t\twhile (!/^[0-9?]*$/g.test(this.value)) {\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Select value on click\n\t\t\t\t$(\"#dialog-signature .signatureID, #dialog-signature .wormholeType\").on(\"click\", function() {\n\t\t\t\t\t$(this).select();\n\t\t\t\t});\n\n\t\t\t\t// Auto fill opposite side wormhole w/ K162\n\t\t\t\t$(\"#dialog-signature .wormholeType\").on(\"input, change\", function() {\n\t\t\t\t\tif (this.value.length > 0 && $.inArray(this.value.toUpperCase(), aSigWormholes) != -1 && this.value.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\n\n\t\t\t\t\t\t// Also auto calculate duration\n\t\t\t\t\t\tif (tripwire.wormholes[this.value.toUpperCase()]) {\n\t\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(tripwire.wormholes[this.value.toUpperCase()].life.substring(0, 2) * 60 * 60).change();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.value.toUpperCase() === \"K162\") {\n\t\t\t\t\t\tif ($.inArray($(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase(), aSigWormholes) === -1 || $(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase() === \"K162\") {\n\t\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"????\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.value == \"????\") {\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Toggle between wormhole and regular signatures\n\t\t\t\t$(\"#dialog-signature\").on(\"selectmenuchange\", \"[name='signatureType']\", function() {\n\t\t\t\t\tif (this.value == \"wormhole\") {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideUp(200, function() { $(this).hide(0); });\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideDown(200, function() { $(this).show(200); });\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideDown(200, function() { $(this).show(200); });\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideUp(200, function() { $(this).hide(0); });\n\t\t\t\t\t}\n\n\t\t\t\t\tValidationTooltips.close();\n\t\t\t\t});\n\n\t\t\t\t$(\"#form-signature\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar form = $(this).serializeObject();\n\t\t\t\t\tvar valid = true;\n\t\t\t\t\tValidationTooltips.close();\n\n\t\t\t\t\t// Validate full signature ID fields (blank | 3 characters)\n\t\t\t\t\t$.each($(\"#dialog-signature .signatureID:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.length < 3) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be 3 characters in length!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate full signature ID doesn't already exist in current system\n\t\t\t\t\tif (form.signatureID_Alpha.length === 3 && form.signatureID_Numeric.length === 3 && Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric, true) != false && Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric, true).id != $(\"#dialog-signature\").data(\"signatureid\")) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet effect = {\n\t\t\t\t\t\t\tsignatures: {\n\t\t\t\t\t\t\t\tremove: []\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsystemID: viewingSystemID\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsignatures = []\n\t\t\t\t\t\tcurrentSignature = Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric);\n\t\t\t\t\t\tif (\"wormhole\" != currentSignature.type) signatures.push(currentSignature), effect.signatures.remove.push(currentSignature.id);\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tlet wormhole = $.map(tripwire.client.wormholes, function(wh) {\n\t\t\t\t\t\t\t\tif (wh.initialID == currentSignature.id || wh.secondaryID == currentSignature.id) return wh\n\t\t\t\t\t\t\t})[0];\n\t\t\t\t\t\t\tsignatures.push({\n\t\t\t\t\t\t\t\twormhole: wormhole,\n\t\t\t\t\t\t\t\tsignatures: [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]\n\t\t\t\t\t\t\t}), effect.signatures.remove.push(wormhole)\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttripwire.refresh(\"refresh\", effect, function(i) {\n\t\t\t\t\t\t\tif(i.resultSet && 1 == i.resultSet[0].result){\n\t\t\t\t\t\t\t\tValidationTooltips.close()\n\t\t\t\t\t\t\t\t$(\"#undo\").removeClass(\".disabled\")\n\t\t\t\t\t\t\t\tviewingSystemID in tripwire.signatures.undo ? \n\t\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({\n\t\t\t\t\t\t\t\t\t\taction: \"remove\",\n\t\t\t\t\t\t\t\t\t\tsignatures: signatures\n\t\t\t\t\t\t\t\t\t}) : \n\t\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{\n\t\t\t\t\t\t\t\t\t\taction: \"remove\",\n\t\t\t\t\t\t\t\t\t\tsignatures: signatures\n\t\t\t\t\t\t\t\t\t}];\n\t\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.client.signatures.undo))\n\t\t\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\") ?\n\t\t\t\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click() :\n\t\t\t\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// i.resultSet && 1 == i.resultSet[0].result && (ValidationTooltips.close(), $(\"#undo\").removeClass(\"disabled\"), viewingSystemID in tripwire.signatures.undo ? tripwire.signatures.undo[viewingSystemID].push({\n\t\t\t\t\t\t\t// \taction: \"remove\",\n\t\t\t\t\t\t\t// \tsignatures: signatures\n\t\t\t\t\t\t\t// }) : tripwire.signatures.undo[viewingSystemID] = [{\n\t\t\t\t\t\t\t// \taction: \"remove\",\n\t\t\t\t\t\t\t// \tsignatures: e\n\t\t\t\t\t\t\t// }],\n\t\t\t\t\t\t\t// sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo)), $(\"#dialog-signature\").parent().find(\":button:contains('Save')\") ? $(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click() : $(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click())\n\t\t\t\t\t\t})\n\t\t\t\t\t\t//var existingSignature = Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric);\n\t\t\t\t\t\t//ValidationTooltips.open({target: $(\"#dialog-signature .signatureID:first\")}).setContent(\"Signature ID already exists! <input type='button' autofocus='true' id='overwrite' value='Overwrite' style='margin-bottom: -4px; margin-top: -4px; font-size: 0.8em;' data-id='\"+ existingSignature.id +\"' />\");\n\t\t\t\t\t\t$(\"#overwrite\").focus();\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate wormhole types (blank | wormhole)\n\t\t\t\t\t$.each($(\"#dialog-signature .wormholeType:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && $.inArray(this.value.toUpperCase(), aSigWormholes) == -1 && this.value != \"????\") {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid wormhole type!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate leads to system (blank | system)\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && tripwire.aSigSystems.findIndex((item) => this.value.toLowerCase() === item.toLowerCase()) == -1) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid leads to system!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate leads to isn't the viewing system which causes a inner loop\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.toLowerCase() === sigDialogVM.viewingSystem.name.toLowerCase()) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Wormhole cannot lead to the same system it comes from!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\tvar payload = {};\n\t\t\t\t\tvar undo = [];\n\t\t\t\t\tif (form.signatureType === \"wormhole\") {\n\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\n\t\t\t\t\t\t\t\"name\": form.wormholeName,\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar leadsTo = null;\n\t\t\t\t\t\tif (Object.index(tripwire.systems, \"name\", form.leadsTo, true)) {\n\t\t\t\t\t\t\t// Leads To is a normal EVE system, so use the sytem ID\n\t\t\t\t\t\t\tleadsTo = Object.index(tripwire.systems, \"name\", form.leadsTo, true)\n\t\t\t\t\t\t} else if (tripwire.wormholes[form.wormholeType.toUpperCase()]) {\n\t\t\t\t\t\t\t// Leads To can be determined by the wormhole type, so lets use what we know it leads to\n\t\t\t\t\t\t\tif (tripwire.aSigSystems.findIndex((item) => tripwire.wormholes[form.wormholeType.toUpperCase()].leadsTo.replace(' ', '-').toLowerCase() === item.toLowerCase()) > -1) {\n\t\t\t\t\t\t\t\tleadsTo = tripwire.aSigSystems.findIndex((item) => tripwire.wormholes[form.wormholeType.toUpperCase()].leadsTo.replace(' ', '-').toLowerCase() === item.toLowerCase());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (tripwire.aSigSystems.findIndex((item) => form.leadsTo.toLowerCase() === item.toLowerCase()) !== -1) {\n\t\t\t\t\t\t\t// Leads To is one of the valid types we allow, so use of of those indexes as reference\n\t\t\t\t\t\t\tleadsTo = tripwire.aSigSystems.findIndex((item) => form.leadsTo.toLowerCase() === item.toLowerCase());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar signature2 = {\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID2_Alpha + form.signatureID2_Numeric,\n\t\t\t\t\t\t\t\"systemID\": leadsTo,\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\n\t\t\t\t\t\t\t\"name\": form.wormholeName2,\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar type = null;\n\t\t\t\t\t\tvar parent = null;\n\t\t\t\t\t\tif (form.wormholeType.length > 0 && $.inArray(form.wormholeType.toUpperCase(), aSigWormholes) != -1 && form.wormholeType.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\tparent = \"initial\";\n\t\t\t\t\t\t\ttype = form.wormholeType.toUpperCase();\n\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && $.inArray(form.wormholeType2.toUpperCase(), aSigWormholes) != -1 && form.wormholeType2.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\tparent = \"secondary\";\n\t\t\t\t\t\t\ttype = form.wormholeType2.toUpperCase();\n\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\tparent = \"secondary\";\n\t\t\t\t\t\t\ttype = \"????\";\n\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\tparent = \"initial\";\n\t\t\t\t\t\t\ttype = \"????\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar wormhole = {\n\t\t\t\t\t\t\t\"type\": type,\n\t\t\t\t\t\t\t\"parent\": parent,\n\t\t\t\t\t\t\t\"life\": form.wormholeLife,\n\t\t\t\t\t\t\t\"mass\": form.wormholeMass\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\n\t\t\t\t\t\t\tsignature.id = $(\"#dialog-signature\").data(\"signatureid\");\n\t\t\t\t\t\t\tsignature2.id = $(\"#dialog-signature\").data(\"signature2id\");\n\t\t\t\t\t\t\twormhole.id = $(\"#dialog-signature\").data(\"wormholeid\");\n\n\t\t\t\t\t\t\t// Update the initial and type based on which side of the wormhole we are editing\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\t\tif (form.wormholeType.length > 0 && $.inArray(form.wormholeType.toUpperCase(), aSigWormholes) != -1 && form.wormholeType.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType.toUpperCase();\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && $.inArray(form.wormholeType2.toUpperCase(), aSigWormholes) != -1 && form.wormholeType2.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType2.toUpperCase();\n\t\t\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\n\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\t\t\t//used to be a wormhole\n\t\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\n\t\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\t\"id\": $(\"#dialog-signature\").data(\"signatureid\"),\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [signature]}};\n\n\t\t\t\t\t\t\tif (tripwire.client.signatures[signature.id].type == \"wormhole\") {\n\t\t\t\t\t\t\t\t//used to be a wormhole\n\t\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\t\t\tvar signature2 = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [signature]}};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"disable\");\n\n\t\t\t\t\tvar success = function(data) {\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-signature\").dialog(\"close\");\n\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\n\t\t\t\t\t\t\tif (sigDialogVM.mode == \"add\") {\n\t\t\t\t\t\t\t\tundo = data.results;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (sigDialogVM.viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID].push({action: sigDialogVM.mode, signatures: undo});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID] = [{action: sigDialogVM.mode, signatures: undo}];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar always = function() {\n\t\t\t\t\t\t$(\"#sigEditForm input[type=submit]\").removeAttr(\"disabled\");\n\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"enable\");\n\t\t\t\t\t}\n\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\n\t\t\t\t});\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\n\n\t\t\t\t$(\"#dialog-signature input\").val(\"\");\n\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(\"unknown\").selectmenu(\"refresh\");\n\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(\"stable\").selectmenu(\"refresh\");\n\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(\"stable\").selectmenu(\"refresh\");\n\n\t\t\t\t$(\"#dialog-signature #site\").show();\n\t\t\t\t$(\"#dialog-signature #wormhole\").hide();\n\n\t\t\t\t// Side labels\n\t\t\t\t$(\"#dialog-signature .sideLabel:first\").html(sigDialogVM.viewingSystem.name + \" Side\");\n\t\t\t\t$(\"#dialog-signature .sideLabel:last\").html(\"Other Side\");\n\n\t\t\t\t// Default signature life\n\t\t\t\t$(\"#dialog-signature #durationPicker\").val(options.signatures.pasteLife * 60 * 60).change();\n\n\t\t\t\tvar id = sigDialogVM.sigId;\n\t\t\t\tif (sigDialogVM.mode == \"update\" && id && tripwire.client.signatures[id]) {\n\t\t\t\t\tvar signature = tripwire.client.signatures[id];\n\t\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", id);\n\n\t\t\t\t\t// Change the dialog buttons\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").hide();\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").show();\n\n\t\t\t\t\t// Change the dialog title\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Edit Signature\");\n\n\t\t\t\t\tif (signature.type == \"wormhole\") {\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == id || wormhole.secondaryID == id) return wormhole; })[0];\n\t\t\t\t\t\tvar otherSignature = id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", otherSignature.id);\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", wormhole.id);\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst sigAlpha = signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\";\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(sigAlpha);\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName']\").val(signature.name);\n\t\t\t\t\t\t$(\"#dialog-signature [name='leadsTo']\").val(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : (tripwire.aSigSystems[otherSignature.systemID] ? tripwire.aSigSystems[otherSignature.systemID] : \"\"));\n\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Alpha']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(0, 3) : \"???\");\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Numeric']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName2']\").val(otherSignature.name);\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(wormhole.life).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(wormhole.mass).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\n\t\t\t\t\t\tif (wormhole[wormhole.parent+\"ID\"] == signature.id) {\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType']\").val(wormhole.type).change();\n\t\t\t\t\t\t} else if (wormhole[wormhole.parent+\"ID\"] == otherSignature.id) {\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType2']\").val(wormhole.type).change();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Focus the sig ID, if it isn't set, otherwise the sig name\n\t\t\t\t\t\tif(sigAlpha != '???') { $(\"#dialog-signature input[name='wormholeName']\").select(); }\n\t\t\t\t\t\telse { $(\"#dialog-signature input[name='signatureID_Alpha']\").select(); }\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\");\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureName']\").val(signature.name);\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\n\t\t\t\t\t\t\n\t\t\t\t\t\t// Not a wormhole - always focus the sig ID\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").select();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Hightlight first ID section, if not set, otherwise the name\n\t\t\t\t} else {\n\t\t\t\t\t// Change the dialog buttons\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").show();\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").hide();\n\n\t\t\t\t\t// Change the dialog title\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Add Signature\");\n\n\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(options.signatures.editType || \"unknown\").selectmenu(\"refresh\")\n\t\t\t\t\tif ($(\"#dialog-signature [name='signatureType']\").val() === \"wormhole\") {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").hide();\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-signature\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-signature\").dialog(\"open\");\n\t}\n};\n","const invasions = new _Invasions();\nsystemAnalysis.addMutator(invasions);\n\nfunction _Invasions() {\n\tconst _this = this;\n\tconst pathSymbolMap = {\n\t\tstellar_reconnaissance: '◆',\n\t\t\n\t\ttriglavian_minor_victory: '▽',\n\t\tescalating_liminality: '▽',\n\t\tfinal_liminality: '▼',\n\t\t\n\t\tedencom_minor_victory: '△',\n\t\tredoubt: '△', bulwark: '△',\n\t\tfortress: '▲',\n\t};\n\tconst textMap = {\n\t\tstellar_reconnaissance: 'Stellar Reconnaissance',\n\t\t\n\t\ttriglavian_minor_victory: 'Triglavian Minor Victory',\n\t\tescalating_liminality: 'Escalating Liminality',\n\t\tfinal_liminality: 'Final Liminality',\n\t\t\n\t\tedencom_minor_victory: 'EDENCOM Minor Victory',\n\t\tredoubt: 'Redoubt',\n\t\tbulwark: 'Bulwark',\n\t\tfortress: 'EDENCOM Fortress',\n\t}\n\t\n\tthis.invasions = {};\n\t\n\t/** Update the system */\n\tthis.mutate = function(system, systemID) {\n\t\tconst systemInvasion = this.invasions[systemID];\n\t\tif(systemInvasion) {\n\t\t\tif(systemInvasion.derived_security_status) { system.security = 1 * systemInvasion.derived_security_status; }\n\t\t\tsystem.pathSymbol = pathSymbolMap[systemInvasion.status];\n\t\t\tconst tip = textMap[systemInvasion.status] +\n\t\t\t\t(systemInvasion.derived_security_status ? '<br>Effective security lowered to ' + systemInvasion.derived_security_status : '');\n\t\t\tsystem.systemTypeModifiers.push('<span class=\"invasion ' + systemInvasion.status + '\" data-tooltip=\"' + tip + '\">' + system.pathSymbol + '</span>');\n\t\t}\n\t}\n\t\n\t/** Refresh the invasion data from the public Kybernauts API */\n\tthis.refresh = function() {\n\t\t$.ajax({\n\t\t\turl: 'cached_third_party.php?key=invasions',\n\t\t\ttype: \"GET\",\n\t\t\tdataType: \"JSON\"\n\t\t}).done(function(data, status, xhr) {\t\n\t\t\tif(!_.isEqual(data, _this.invasions)) {\n\t\t\t\tconsole.info('Updating map for invasions update');\n\t\t\t\t_this.invasions = _.keyBy(data, function(x) { return x.system_id; });\n\t\t\t\tchain.redraw();\n\t\t\t\ttripwire.systemChange(viewingSystemID);\n\t\t\t}\n\t\t}).fail(function(xhr, status, error) {\n\t\t\tconsole.warn('Failed to fetch invasion data from kybernaut.space: ' + status, error);\n\t\t});\n\t};\n\t\n\tsetInterval(this.refresh, 3600000);\n\tthis.refresh();\n}"]}